2025-04-11 13:51:06,082 - INFO - Using device: cpu
2025-04-11 13:51:06,082 - DEBUG - Starting the Kafka producer
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name connections-closed
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name connections-created
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name select-time
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name io-time
2025-04-11 13:51:06,083 - DEBUG - Attempting to check version with node bootstrap-0
2025-04-11 13:51:06,083 - DEBUG - Initiating connection to node bootstrap-0 at localhost:9092
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name bytes-sent-received
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name bytes-sent
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name bytes-received
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name request-latency
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name throttle-time
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name node-bootstrap-0.bytes-sent
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name node-bootstrap-0.bytes-received
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name node-bootstrap-0.latency
2025-04-11 13:51:06,083 - DEBUG - Added sensor with name node-bootstrap-0.throttle
2025-04-11 13:51:06,084 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [unspecified None]>: creating new socket
2025-04-11 13:51:06,084 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: setting socket option (6, 1, 1)
2025-04-11 13:51:06,084 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-04-11 13:51:06,084 - DEBUG - Timeouts: user 199.989080, metadata inf, idle connection inf, request inf
2025-04-11 13:51:06,084 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: established TCP connection
2025-04-11 13:51:06,085 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_send> [IPv6 ('::1', 9092, 0, 0)]>: checking broker Api Versions
2025-04-11 13:51:06,085 - DEBUG - Sending request ApiVersionsRequest_v4(client_software_name='kafka-python', client_software_version='2.1.4', _tagged_fields={})
2025-04-11 13:51:06,085 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_send> [IPv6 ('::1', 9092, 0, 0)]>: Request 1 (timeout_ms 1600.0): ApiVersionsRequest_v4(client_software_name='kafka-python', client_software_version='2.1.4', _tagged_fields={})
2025-04-11 13:51:06,085 - DEBUG - Timeouts: user 199.993134, metadata inf, idle connection inf, request 1599.890947
2025-04-11 13:51:06,088 - DEBUG - Received correlation id: 1
2025-04-11 13:51:06,089 - DEBUG - Processing response ApiVersionsResponse_v4
2025-04-11 13:51:06,089 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_recv> [IPv6 ('::1', 9092, 0, 0)]>: Response 1 (3.8208961486816406 ms): ApiVersionsResponse_v0(error_code=35, api_versions=[(api_key=18, min_version=0, max_version=3)])
2025-04-11 13:51:06,089 - DEBUG - Timeouts: user 199.989080, metadata inf, idle connection 539993.000000, request inf
2025-04-11 13:51:06,089 - DEBUG - Sending request ApiVersionsRequest_v3(client_software_name='kafka-python', client_software_version='2.1.4', _tagged_fields={})
2025-04-11 13:51:06,089 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_send> [IPv6 ('::1', 9092, 0, 0)]>: Request 2 (timeout_ms 1600.0): ApiVersionsRequest_v3(client_software_name='kafka-python', client_software_version='2.1.4', _tagged_fields={})
2025-04-11 13:51:06,089 - DEBUG - Timeouts: user 199.985266, metadata inf, idle connection 539993.000000, request 1599.868059
2025-04-11 13:51:06,090 - DEBUG - Received correlation id: 2
2025-04-11 13:51:06,091 - DEBUG - Processing response ApiVersionsResponse_v3
2025-04-11 13:51:06,091 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_recv> [IPv6 ('::1', 9092, 0, 0)]>: Response 2 (1.7600059509277344 ms): ApiVersionsResponse_v3(error_code=0, api_versions=[(api_key=0, min_version=0, max_version=9, _tagged_fields={}), (api_key=1, min_version=0, max_version=13, _tagged_fields={}), (api_key=2, min_version=0, max_version=7, _tagged_fields={}), (api_key=3, min_version=0, max_version=12, _tagged_fields={}), (api_key=4, min_version=0, max_version=7, _tagged_fields={}), (api_key=5, min_version=0, max_version=4, _tagged_fields={}), (api_key=6, min_version=0, max_version=8, _tagged_fields={}), (api_key=7, min_version=0, max_version=3, _tagged_fields={}), (api_key=8, min_version=0, max_version=8, _tagged_fields={}), (api_key=9, min_version=0, max_version=8, _tagged_fields={}), (api_key=10, min_version=0, max_version=4, _tagged_fields={}), (api_key=11, min_version=0, max_version=9, _tagged_fields={}), (api_key=12, min_version=0, max_version=4, _tagged_fields={}), (api_key=13, min_version=0, max_version=5, _tagged_fields={}), (api_key=14, min_version=0, max_version=5, _tagged_fields={}), (api_key=15, min_version=0, max_version=5, _tagged_fields={}), (api_key=16, min_version=0, max_version=4, _tagged_fields={}), (api_key=17, min_version=0, max_version=1, _tagged_fields={}), (api_key=18, min_version=0, max_version=3, _tagged_fields={}), (api_key=19, min_version=0, max_version=7, _tagged_fields={}), (api_key=20, min_version=0, max_version=6, _tagged_fields={}), (api_key=21, min_version=0, max_version=2, _tagged_fields={}), (api_key=22, min_version=0, max_version=4, _tagged_fields={}), (api_key=23, min_version=0, max_version=4, _tagged_fields={}), (api_key=24, min_version=0, max_version=3, _tagged_fields={}), (api_key=25, min_version=0, max_version=3, _tagged_fields={}), (api_key=26, min_version=0, max_version=3, _tagged_fields={}), (api_key=27, min_version=0, max_version=1, _tagged_fields={}), (api_key=28, min_version=0, max_version=3, _tagged_fields={}), (api_key=29, min_version=0, max_version=3, _tagged_fields={}), (api_key=30, min_version=0, max_version=3, _tagged_fields={}), (api_key=31, min_version=0, max_version=3, _tagged_fields={}), (api_key=32, min_version=0, max_version=4, _tagged_fields={}), (api_key=33, min_version=0, max_version=2, _tagged_fields={}), (api_key=34, min_version=0, max_version=2, _tagged_fields={}), (api_key=35, min_version=0, max_version=4, _tagged_fields={}), (api_key=36, min_version=0, max_version=2, _tagged_fields={}), (api_key=37, min_version=0, max_version=3, _tagged_fields={}), (api_key=38, min_version=0, max_version=3, _tagged_fields={}), (api_key=39, min_version=0, max_version=2, _tagged_fields={}), (api_key=40, min_version=0, max_version=2, _tagged_fields={}), (api_key=41, min_version=0, max_version=3, _tagged_fields={}), (api_key=42, min_version=0, max_version=2, _tagged_fields={}), (api_key=43, min_version=0, max_version=2, _tagged_fields={}), (api_key=44, min_version=0, max_version=1, _tagged_fields={}), (api_key=45, min_version=0, max_version=0, _tagged_fields={}), (api_key=46, min_version=0, max_version=0, _tagged_fields={}), (api_key=47, min_version=0, max_version=0, _tagged_fields={}), (api_key=48, min_version=0, max_version=1, _tagged_fields={}), (api_key=49, min_version=0, max_version=1, _tagged_fields={}), (api_key=50, min_version=0, max_version=0, _tagged_fields={}), (api_key=51, min_version=0, max_version=0, _tagged_fields={}), (api_key=56, min_version=0, max_version=2, _tagged_fields={}), (api_key=57, min_version=0, max_version=1, _tagged_fields={}), (api_key=58, min_version=0, max_version=0, _tagged_fields={}), (api_key=60, min_version=0, max_version=0, _tagged_fields={}), (api_key=61, min_version=0, max_version=0, _tagged_fields={}), (api_key=65, min_version=0, max_version=0, _tagged_fields={}), (api_key=66, min_version=0, max_version=0, _tagged_fields={}), (api_key=67, min_version=0, max_version=0, _tagged_fields={})], throttle_time_ms=0, _tagged_fields={1: b'\x00\x00\x00\x00\x00\x00\x00\x00'})
2025-04-11 13:51:06,091 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_recv> [IPv6 ('::1', 9092, 0, 0)]>: Broker version identified as 2.6
2025-04-11 13:51:06,091 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-04-11 13:51:06,091 - DEBUG - Node bootstrap-0 connected
2025-04-11 13:51:06,092 - DEBUG - Added sensor with name bufferpool-wait-time
2025-04-11 13:51:06,092 - DEBUG - Added sensor with name batch-size
2025-04-11 13:51:06,092 - DEBUG - Added sensor with name compression-rate
2025-04-11 13:51:06,092 - DEBUG - Added sensor with name queue-time
2025-04-11 13:51:06,092 - DEBUG - Added sensor with name records-per-request
2025-04-11 13:51:06,092 - DEBUG - Added sensor with name bytes
2025-04-11 13:51:06,092 - DEBUG - Added sensor with name record-retries
2025-04-11 13:51:06,092 - DEBUG - Added sensor with name errors
2025-04-11 13:51:06,092 - DEBUG - Added sensor with name record-size-max
2025-04-11 13:51:06,092 - DEBUG - Starting Kafka producer I/O thread.
2025-04-11 13:51:06,092 - DEBUG - Sending metadata request MetadataRequest_v7(topics=[], allow_auto_topic_creation=True) to node bootstrap-0
2025-04-11 13:51:06,092 - DEBUG - Sending request MetadataRequest_v7(topics=[], allow_auto_topic_creation=True)
2025-04-11 13:51:06,092 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 3 (timeout_ms 30000): MetadataRequest_v7(topics=[], allow_auto_topic_creation=True)
2025-04-11 13:51:06,093 - DEBUG - Timeouts: user 9999999989.646912, metadata 30000.000000, idle connection 539989.000000, request 29999.989033
2025-04-11 13:51:06,092 - DEBUG - Kafka producer started
2025-04-11 13:51:06,093 - DEBUG - Timeouts: user 9999999989.997149, metadata 30000.000000, idle connection 539989.000000, request 29999.812126
2025-04-11 13:51:06,093 - INFO - Kafka producer initialized successfully
2025-04-11 13:51:06,094 - INFO - Database initialized successfully!
2025-04-11 13:51:06,094 - DEBUG - Received correlation id: 3
2025-04-11 13:51:06,094 - DEBUG - Processing response MetadataResponse_v7
2025-04-11 13:51:06,094 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 3 (1.6291141510009766 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='UwFy8R9DQiuRqCcMRoZdWA', controller_id=1, topics=[])
2025-04-11 13:51:06,094 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 0, groups: 0)
2025-04-11 13:51:06,094 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.902100, idle connection 539988.000000, request inf
2025-04-11 13:51:06,421 - INFO - Model and components loaded successfully!
2025-04-11 13:51:08,799 - INFO - Client connected
2025-04-11 13:51:08,808 - DEBUG - History count: 6
2025-04-11 13:51:08,810 - DEBUG - Returning click history with 6 entries
2025-04-11 13:51:08,812 - DEBUG - Received get_recommendations with data: {'sessionClicks': []}
2025-04-11 13:51:08,832 - DEBUG - Emitting recommendations: ['B09DDW6H15', 'B006GA46KI', 'B076HC1X3H', 'B00ETKD54K', 'B00R7YP4HQ', 'B07DKXJVD9', 'B08ZLCK8Y5', 'B00KFKDDZ4', 'B00U6Y2AVM', 'B07PZW6FRM', 'B073VRVDSC', 'B005POOES0', 'B0BFN2P94F', 'B00I0UNCES', 'B082DHCV2S', 'B08BYY94LZ', 'B01HHJ7JV4', 'B01MSP2LIH', 'B007KJ684Q', 'B00IN8HSX8']
2025-04-11 13:51:08,833 - DEBUG - Requesting metadata update for topic metrics_topic
2025-04-11 13:51:08,833 - DEBUG - Initializing connection to node 1 for metadata request
2025-04-11 13:51:08,833 - DEBUG - Initiating connection to node 1 at localhost:9092
2025-04-11 13:51:08,833 - DEBUG - Added sensor with name node-1.bytes-sent
2025-04-11 13:51:08,833 - DEBUG - Added sensor with name node-1.bytes-received
2025-04-11 13:51:08,833 - DEBUG - Added sensor with name node-1.latency
2025-04-11 13:51:08,833 - DEBUG - Added sensor with name node-1.throttle
2025-04-11 13:51:08,834 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connecting> [unspecified None]>: creating new socket
2025-04-11 13:51:08,834 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: setting socket option (6, 1, 1)
2025-04-11 13:51:08,834 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-04-11 13:51:08,834 - DEBUG - Timeouts: user 9999999988.647938, metadata inf, idle connection 537248.000000, request inf
2025-04-11 13:51:08,834 - DEBUG - Timeouts: user 9999999989.991188, metadata inf, idle connection 537248.000000, request inf
2025-04-11 13:51:08,834 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: established TCP connection
2025-04-11 13:51:08,834 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <checking_api_versions_send> [IPv6 ('::1', 9092, 0, 0)]>: checking broker Api Versions
2025-04-11 13:51:08,835 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <checking_api_versions_send> [IPv6 ('::1', 9092, 0, 0)]>: Using pre-configured api_version (2, 6) for ApiVersions
2025-04-11 13:51:08,835 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-04-11 13:51:08,835 - DEBUG - Node 1 connected
2025-04-11 13:51:08,835 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-04-11 13:51:08,835 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-11 13:51:08,835 - DEBUG - Sending request MetadataRequest_v7(topics=['metrics_topic'], allow_auto_topic_creation=True)
2025-04-11 13:51:08,835 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 1 (timeout_ms 30000): MetadataRequest_v7(topics=['metrics_topic'], allow_auto_topic_creation=True)
2025-04-11 13:51:08,835 - DEBUG - Timeouts: user 9999999989.777803, metadata 30000.000000, idle connection 537247.000000, request 29999.992132
2025-04-11 13:51:08,835 - DEBUG - Timeouts: user 9999999989.998817, metadata 30000.000000, idle connection 537247.000000, request 29999.905109
2025-04-11 13:51:08,841 - DEBUG - Received correlation id: 1
2025-04-11 13:51:08,841 - DEBUG - Processing response MetadataResponse_v7
2025-04-11 13:51:08,841 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 1 (6.383180618286133 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='UwFy8R9DQiuRqCcMRoZdWA', controller_id=1, topics=[(error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-11 13:51:08,842 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 1, groups: 0)
2025-04-11 13:51:08,842 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.524170, idle connection 537240.000000, request inf
2025-04-11 13:51:08,842 - DEBUG - _wait_on_metadata woke after 0.009594202041625977 secs.
2025-04-11 13:51:08,842 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 0, 'clicks_on_recommended': 0, 'ctr': 0.0, 'timestamp': '2025-04-11T13:51:08.832920'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:08,842 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:08,842 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-11 13:51:08,843 - DEBUG - Flushing accumulated records in producer.
2025-04-11 13:51:08,843 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:08,843 - DEBUG - Added sensor with name topic.metrics_topic.records-per-batch
2025-04-11 13:51:08,843 - DEBUG - Added sensor with name topic.metrics_topic.bytes
2025-04-11 13:51:08,843 - DEBUG - Added sensor with name topic.metrics_topic.compression-rate
2025-04-11 13:51:08,843 - DEBUG - Added sensor with name topic.metrics_topic.record-retries
2025-04-11 13:51:08,843 - DEBUG - Added sensor with name topic.metrics_topic.record-errors
2025-04-11 13:51:08,843 - DEBUG - Nodes with data ready to send: {1}
2025-04-11 13:51:08,843 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02Nf\xa5\xa5\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xe8*\x00\x00\x01\x96#f\xe8*\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-11 13:51:08,843 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02Nf\xa5\xa5\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xe8*\x00\x00\x01\x96#f\xe8*\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:08,843 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02Nf\xa5\xa5\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xe8*\x00\x00\x01\x96#f\xe8*\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:08,843 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 2 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02Nf\xa5\xa5\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xe8*\x00\x00\x01\x96#f\xe8*\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:08,843 - DEBUG - Timeouts: user 0.000000, metadata 299998.217041, idle connection 537239.000000, request 29999.987841
2025-04-11 13:51:08,843 - DEBUG - Timeouts: user 9999999989.998817, metadata 299998.111084, idle connection 537239.000000, request 29999.884844
2025-04-11 13:51:08,849 - DEBUG - Received correlation id: 2
2025-04-11 13:51:08,849 - DEBUG - Processing response ProduceResponse_v7
2025-04-11 13:51:08,849 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 2 (5.745172500610352 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=33, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:08,849 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=33, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:08,849 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 33 log start offset 0.
2025-04-11 13:51:08,849 - DEBUG - Timeouts: user 9999999989.996910, metadata 299992.148193, idle connection 537233.000000, request inf
2025-04-11 13:51:08,850 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 0, 'clicks_on_recommended': 0, 'ctr': 0.0, 'timestamp': '2025-04-11T13:51:08.832920'}
2025-04-11 13:51:08,967 - DEBUG - Returning 50000 books
2025-04-11 13:51:10,106 - INFO - Updated book B006GA46KI with hover
2025-04-11 13:51:10,107 - DEBUG - Requesting metadata update for topic user_interactions
2025-04-11 13:51:10,107 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-11 13:51:10,107 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-11 13:51:10,108 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 3 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-11 13:51:10,108 - DEBUG - Timeouts: user 9999999989.275694, metadata 30000.000000, idle connection 535974.000000, request 29999.975204
2025-04-11 13:51:10,108 - DEBUG - Timeouts: user 9999999989.995003, metadata 30000.000000, idle connection 535974.000000, request 29999.641180
2025-04-11 13:51:10,113 - DEBUG - Received correlation id: 3
2025-04-11 13:51:10,113 - DEBUG - Processing response MetadataResponse_v7
2025-04-11 13:51:10,113 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 3 (5.133867263793945 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='UwFy8R9DQiuRqCcMRoZdWA', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-11 13:51:10,113 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-11 13:51:10,113 - DEBUG - _wait_on_metadata woke after 0.00677180290222168 secs.
2025-04-11 13:51:10,114 - DEBUG - Timeouts: user 9999999989.994764, metadata 299999.673340, idle connection 535968.000000, request inf
2025-04-11 13:51:10,114 - DEBUG - Sending (key=None value={'book_id': 'B006GA46KI', 'event_type': 'hover', 'timestamp': '2025-04-11T13:51:10.106929'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:10,114 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:10,114 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-11 13:51:10,114 - DEBUG - Flushing accumulated records in producer.
2025-04-11 13:51:10,115 - DEBUG - Added sensor with name topic.user_interactions.records-per-batch
2025-04-11 13:51:10,115 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:10,115 - DEBUG - Added sensor with name topic.user_interactions.bytes
2025-04-11 13:51:10,115 - DEBUG - Added sensor with name topic.user_interactions.compression-rate
2025-04-11 13:51:10,115 - DEBUG - Added sensor with name topic.user_interactions.record-retries
2025-04-11 13:51:10,115 - DEBUG - Added sensor with name topic.user_interactions.record-errors
2025-04-11 13:51:10,115 - DEBUG - Nodes with data ready to send: {1}
2025-04-11 13:51:10,115 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xf3ha\xed\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xed"\x00\x00\x01\x96#f\xed"\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])}
2025-04-11 13:51:10,115 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xf3ha\xed\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xed"\x00\x00\x01\x96#f\xed"\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:10,115 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xf3ha\xed\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xed"\x00\x00\x01\x96#f\xed"\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:10,116 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 4 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xf3ha\xed\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xed"\x00\x00\x01\x96#f\xed"\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:10,116 - DEBUG - Timeouts: user 0.000000, metadata 299997.645264, idle connection 535966.000000, request 29999.982119
2025-04-11 13:51:10,116 - DEBUG - Timeouts: user 9999999989.997864, metadata 299997.449951, idle connection 535966.000000, request 29999.791145
2025-04-11 13:51:10,125 - DEBUG - Received correlation id: 4
2025-04-11 13:51:10,125 - DEBUG - Processing response ProduceResponse_v7
2025-04-11 13:51:10,125 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 4 (9.531736373901367 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=31, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,125 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=31, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,125 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 31 log start offset 0.
2025-04-11 13:51:10,126 - DEBUG - Timeouts: user 9999999989.995003, metadata 299987.739258, idle connection 535956.000000, request inf
2025-04-11 13:51:10,126 - INFO - Sent to Kafka (interactions): {'book_id': 'B006GA46KI', 'event_type': 'hover', 'timestamp': '2025-04-11T13:51:10.106929'}
2025-04-11 13:51:10,126 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 0, 'clicks_on_recommended': 0, 'ctr': 0.0, 'timestamp': '2025-04-11T13:51:10.126181'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:10,126 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:10,126 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-11 13:51:10,126 - DEBUG - Flushing accumulated records in producer.
2025-04-11 13:51:10,126 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:10,126 - DEBUG - Nodes with data ready to send: {1}
2025-04-11 13:51:10,126 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xe8\xaa3?\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xed.\x00\x00\x01\x96#f\xed.\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-11 13:51:10,126 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xe8\xaa3?\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xed.\x00\x00\x01\x96#f\xed.\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:10,126 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xe8\xaa3?\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xed.\x00\x00\x01\x96#f\xed.\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:10,127 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 5 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xe8\xaa3?\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xed.\x00\x00\x01\x96#f\xed.\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:10,127 - DEBUG - Timeouts: user 0.000000, metadata 299986.627197, idle connection 535955.000000, request 29999.986172
2025-04-11 13:51:10,127 - DEBUG - Timeouts: user 9999999989.998102, metadata 299986.475098, idle connection 535955.000000, request 29999.837160
2025-04-11 13:51:10,131 - DEBUG - Received correlation id: 5
2025-04-11 13:51:10,131 - DEBUG - Processing response ProduceResponse_v7
2025-04-11 13:51:10,131 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 5 (4.204034805297852 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=34, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,131 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=34, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,132 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 34 log start offset 0.
2025-04-11 13:51:10,132 - DEBUG - Timeouts: user 9999999989.996195, metadata 299981.674072, idle connection 535950.000000, request inf
2025-04-11 13:51:10,132 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 0, 'clicks_on_recommended': 0, 'ctr': 0.0, 'timestamp': '2025-04-11T13:51:10.126181'}
2025-04-11 13:51:10,152 - INFO - Updated book B006GA46KI with click
2025-04-11 13:51:10,152 - DEBUG - Sending (key=None value={'book_id': 'B006GA46KI', 'event_type': 'click', 'timestamp': '2025-04-11T13:51:10.152385'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:10,152 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:10,152 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-11 13:51:10,152 - DEBUG - Flushing accumulated records in producer.
2025-04-11 13:51:10,153 - DEBUG - Nodes with data ready to send: {1}
2025-04-11 13:51:10,153 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:10,153 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x06\xd2\x86\x02\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xedH\x00\x00\x01\x96#f\xedH\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])}
2025-04-11 13:51:10,153 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x06\xd2\x86\x02\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xedH\x00\x00\x01\x96#f\xedH\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:10,153 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x06\xd2\x86\x02\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xedH\x00\x00\x01\x96#f\xedH\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:10,153 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 6 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x06\xd2\x86\x02\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xedH\x00\x00\x01\x96#f\xedH\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:10,153 - DEBUG - Timeouts: user 0.000000, metadata 299960.100342, idle connection 535929.000000, request 29999.978065
2025-04-11 13:51:10,153 - DEBUG - Timeouts: user 9999999989.998102, metadata 299959.904053, idle connection 535929.000000, request 29999.788046
2025-04-11 13:51:10,160 - DEBUG - Received correlation id: 6
2025-04-11 13:51:10,160 - DEBUG - Processing response ProduceResponse_v7
2025-04-11 13:51:10,160 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 6 (6.951093673706055 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=32, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,160 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=32, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,160 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 32 log start offset 0.
2025-04-11 13:51:10,161 - DEBUG - Timeouts: user 9999999989.989996, metadata 299952.764160, idle connection 535921.000000, request inf
2025-04-11 13:51:10,161 - INFO - Sent to Kafka (interactions): {'book_id': 'B006GA46KI', 'event_type': 'click', 'timestamp': '2025-04-11T13:51:10.152385'}
2025-04-11 13:51:10,161 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 1, 'clicks_on_recommended': 1, 'ctr': 0.05, 'timestamp': '2025-04-11T13:51:10.161330'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:10,161 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:10,161 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-11 13:51:10,161 - DEBUG - Flushing accumulated records in producer.
2025-04-11 13:51:10,161 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:10,161 - DEBUG - Nodes with data ready to send: {1}
2025-04-11 13:51:10,162 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xf8\x8f;\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xedQ\x00\x00\x01\x96#f\xedQ\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-11 13:51:10,162 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xf8\x8f;\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xedQ\x00\x00\x01\x96#f\xedQ\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:10,162 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xf8\x8f;\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xedQ\x00\x00\x01\x96#f\xedQ\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:10,162 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 7 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xf8\x8f;\xd4\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xedQ\x00\x00\x01\x96#f\xedQ\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:10,162 - DEBUG - Timeouts: user 0.000000, metadata 299951.445068, idle connection 535920.000000, request 29999.983788
2025-04-11 13:51:10,162 - DEBUG - Timeouts: user 9999999989.997387, metadata 299951.252197, idle connection 535920.000000, request 29999.794006
2025-04-11 13:51:10,165 - DEBUG - Received correlation id: 7
2025-04-11 13:51:10,165 - DEBUG - Processing response ProduceResponse_v7
2025-04-11 13:51:10,165 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 7 (3.264904022216797 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=35, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,165 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=35, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,165 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 35 log start offset 0.
2025-04-11 13:51:10,165 - DEBUG - Timeouts: user 9999999989.996910, metadata 299947.875977, idle connection 535917.000000, request inf
2025-04-11 13:51:10,165 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 1, 'clicks_on_recommended': 1, 'ctr': 0.05, 'timestamp': '2025-04-11T13:51:10.161330'}
2025-04-11 13:51:10,167 - DEBUG - Returning click history with 7 entries
2025-04-11 13:51:10,495 - INFO - Updated book B006GA46KI with hover
2025-04-11 13:51:10,496 - DEBUG - Sending (key=None value={'book_id': 'B006GA46KI', 'event_type': 'hover', 'timestamp': '2025-04-11T13:51:10.496480'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:10,496 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:10,496 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-11 13:51:10,496 - DEBUG - Flushing accumulated records in producer.
2025-04-11 13:51:10,497 - DEBUG - Nodes with data ready to send: {1}
2025-04-11 13:51:10,497 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:10,497 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02F\x1e\xc3i\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xee\xa0\x00\x00\x01\x96#f\xee\xa0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])}
2025-04-11 13:51:10,497 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02F\x1e\xc3i\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xee\xa0\x00\x00\x01\x96#f\xee\xa0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:10,497 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02F\x1e\xc3i\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xee\xa0\x00\x00\x01\x96#f\xee\xa0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:10,497 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 8 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02F\x1e\xc3i\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xee\xa0\x00\x00\x01\x96#f\xee\xa0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:10,497 - DEBUG - Timeouts: user 0.000000, metadata 299615.950195, idle connection 535585.000000, request 29999.980927
2025-04-11 13:51:10,498 - DEBUG - Timeouts: user 9999999989.996910, metadata 299615.751465, idle connection 535584.000000, request 29999.785900
2025-04-11 13:51:10,502 - DEBUG - Received correlation id: 8
2025-04-11 13:51:10,503 - DEBUG - Processing response ProduceResponse_v7
2025-04-11 13:51:10,503 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 8 (5.404949188232422 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=33, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,505 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=33, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,505 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 33 log start offset 0.
2025-04-11 13:51:10,505 - DEBUG - Timeouts: user 9999999989.993095, metadata 299608.506348, idle connection 535577.000000, request inf
2025-04-11 13:51:10,505 - INFO - Sent to Kafka (interactions): {'book_id': 'B006GA46KI', 'event_type': 'hover', 'timestamp': '2025-04-11T13:51:10.496480'}
2025-04-11 13:51:10,505 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 1, 'clicks_on_recommended': 1, 'ctr': 0.05, 'timestamp': '2025-04-11T13:51:10.505591'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:10,505 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:10,505 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-11 13:51:10,505 - DEBUG - Flushing accumulated records in producer.
2025-04-11 13:51:10,506 - DEBUG - Nodes with data ready to send: {1}
2025-04-11 13:51:10,506 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xb8\xd8\xa6.\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xee\xa9\x00\x00\x01\x96#f\xee\xa9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-11 13:51:10,506 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xb8\xd8\xa6.\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xee\xa9\x00\x00\x01\x96#f\xee\xa9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:10,506 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:10,506 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xb8\xd8\xa6.\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xee\xa9\x00\x00\x01\x96#f\xee\xa9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:10,507 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 9 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xb8\xd8\xa6.\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xee\xa9\x00\x00\x01\x96#f\xee\xa9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:10,507 - DEBUG - Timeouts: user 0.000000, metadata 299606.620117, idle connection 535575.000000, request 29999.982834
2025-04-11 13:51:10,507 - DEBUG - Timeouts: user 9999999989.997864, metadata 299606.450195, idle connection 535575.000000, request 29999.817848
2025-04-11 13:51:10,513 - DEBUG - Received correlation id: 9
2025-04-11 13:51:10,513 - DEBUG - Processing response ProduceResponse_v7
2025-04-11 13:51:10,513 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 9 (6.342887878417969 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=36, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,513 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=36, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:10,513 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 36 log start offset 0.
2025-04-11 13:51:10,513 - DEBUG - Timeouts: user 9999999989.995956, metadata 299600.001221, idle connection 535569.000000, request inf
2025-04-11 13:51:10,513 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 1, 'clicks_on_recommended': 1, 'ctr': 0.05, 'timestamp': '2025-04-11T13:51:10.505591'}
2025-04-11 13:51:12,206 - INFO - Updated book B006GA46KI with hover
2025-04-11 13:51:12,206 - DEBUG - Sending (key=None value={'book_id': 'B006GA46KI', 'event_type': 'hover', 'timestamp': '2025-04-11T13:51:12.206711'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:12,207 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:12,207 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-11 13:51:12,207 - DEBUG - Flushing accumulated records in producer.
2025-04-11 13:51:12,207 - DEBUG - Nodes with data ready to send: {1}
2025-04-11 13:51:12,207 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xc9\x91\xd2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xf5O\x00\x00\x01\x96#f\xf5O\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])}
2025-04-11 13:51:12,207 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xc9\x91\xd2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xf5O\x00\x00\x01\x96#f\xf5O\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:12,208 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-11 13:51:12,208 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xc9\x91\xd2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xf5O\x00\x00\x01\x96#f\xf5O\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:12,208 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 10 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xc9\x91\xd2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xf5O\x00\x00\x01\x96#f\xf5O\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006GA46KI", "even...')])])
2025-04-11 13:51:12,208 - DEBUG - Timeouts: user 0.000000, metadata 297905.354248, idle connection 533874.000000, request 29999.981880
2025-04-11 13:51:12,208 - DEBUG - Timeouts: user 9999999989.998341, metadata 297905.161865, idle connection 533874.000000, request 29999.794960
2025-04-11 13:51:12,215 - DEBUG - Received correlation id: 10
2025-04-11 13:51:12,215 - DEBUG - Processing response ProduceResponse_v7
2025-04-11 13:51:12,215 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 10 (6.860017776489258 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=34, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:12,215 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=34, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:12,215 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 34 log start offset 0.
2025-04-11 13:51:12,215 - DEBUG - Timeouts: user 9999999989.995718, metadata 297898.203125, idle connection 533867.000000, request inf
2025-04-11 13:51:12,215 - INFO - Sent to Kafka (interactions): {'book_id': 'B006GA46KI', 'event_type': 'hover', 'timestamp': '2025-04-11T13:51:12.206711'}
2025-04-11 13:51:12,215 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 1, 'clicks_on_recommended': 1, 'ctr': 0.05, 'timestamp': '2025-04-11T13:51:12.215835'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:12,215 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:12,216 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-11 13:51:12,216 - DEBUG - Flushing accumulated records in producer.
2025-04-11 13:51:12,216 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-11 13:51:12,216 - DEBUG - Nodes with data ready to send: {1}
2025-04-11 13:51:12,216 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xab3X\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xf5W\x00\x00\x01\x96#f\xf5W\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-11 13:51:12,216 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xab3X\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xf5W\x00\x00\x01\x96#f\xf5W\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:12,216 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xab3X\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xf5W\x00\x00\x01\x96#f\xf5W\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:12,216 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 11 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xab3X\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96#f\xf5W\x00\x00\x01\x96#f\xf5W\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-11 13:51:12,216 - DEBUG - Timeouts: user 0.000000, metadata 297897.145996, idle connection 533866.000000, request 29999.986172
2025-04-11 13:51:12,216 - DEBUG - Timeouts: user 9999999989.998102, metadata 297897.016113, idle connection 533866.000000, request 29999.859095
2025-04-11 13:51:12,220 - DEBUG - Received correlation id: 11
2025-04-11 13:51:12,221 - DEBUG - Processing response ProduceResponse_v7
2025-04-11 13:51:12,221 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 11 (4.488945007324219 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=37, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:12,221 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=37, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-11 13:51:12,221 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 37 log start offset 0.
2025-04-11 13:51:12,221 - DEBUG - Timeouts: user 9999999989.994287, metadata 297892.360352, idle connection 533861.000000, request inf
2025-04-11 13:51:12,221 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 1, 'clicks_on_recommended': 1, 'ctr': 0.05, 'timestamp': '2025-04-11T13:51:12.215835'}
