2025-04-13 13:24:42,008 - INFO - Using device: cpu
2025-04-13 13:24:42,008 - DEBUG - Starting the Kafka producer
2025-04-13 13:24:42,008 - DEBUG - Added sensor with name connections-closed
2025-04-13 13:24:42,008 - DEBUG - Added sensor with name connections-created
2025-04-13 13:24:42,008 - DEBUG - Added sensor with name select-time
2025-04-13 13:24:42,009 - DEBUG - Added sensor with name io-time
2025-04-13 13:24:42,009 - DEBUG - Attempting to check version with node bootstrap-0
2025-04-13 13:24:42,009 - DEBUG - Initiating connection to node bootstrap-0 at localhost:9092
2025-04-13 13:24:42,009 - DEBUG - Added sensor with name bytes-sent-received
2025-04-13 13:24:42,009 - DEBUG - Added sensor with name bytes-sent
2025-04-13 13:24:42,009 - DEBUG - Added sensor with name bytes-received
2025-04-13 13:24:42,009 - DEBUG - Added sensor with name request-latency
2025-04-13 13:24:42,009 - DEBUG - Added sensor with name throttle-time
2025-04-13 13:24:42,009 - DEBUG - Added sensor with name node-bootstrap-0.bytes-sent
2025-04-13 13:24:42,009 - DEBUG - Added sensor with name node-bootstrap-0.bytes-received
2025-04-13 13:24:42,009 - DEBUG - Added sensor with name node-bootstrap-0.latency
2025-04-13 13:24:42,009 - DEBUG - Added sensor with name node-bootstrap-0.throttle
2025-04-13 13:24:42,010 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [unspecified None]>: creating new socket
2025-04-13 13:24:42,011 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: setting socket option (6, 1, 1)
2025-04-13 13:24:42,011 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-04-13 13:24:42,011 - DEBUG - Timeouts: user 199.984074, metadata inf, idle connection inf, request inf
2025-04-13 13:24:42,011 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: established TCP connection
2025-04-13 13:24:42,011 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_send> [IPv6 ('::1', 9092, 0, 0)]>: checking broker Api Versions
2025-04-13 13:24:42,011 - DEBUG - Sending request ApiVersionsRequest_v4(client_software_name='kafka-python', client_software_version='2.1.4', _tagged_fields={})
2025-04-13 13:24:42,011 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_send> [IPv6 ('::1', 9092, 0, 0)]>: Request 1 (timeout_ms 1600.0): ApiVersionsRequest_v4(client_software_name='kafka-python', client_software_version='2.1.4', _tagged_fields={})
2025-04-13 13:24:42,011 - DEBUG - Timeouts: user 199.990034, metadata inf, idle connection inf, request 1599.859953
2025-04-13 13:24:42,018 - DEBUG - Received correlation id: 1
2025-04-13 13:24:42,019 - DEBUG - Processing response ApiVersionsResponse_v4
2025-04-13 13:24:42,019 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_recv> [IPv6 ('::1', 9092, 0, 0)]>: Response 1 (7.330894470214844 ms): ApiVersionsResponse_v0(error_code=35, api_versions=[(api_key=18, min_version=0, max_version=3)])
2025-04-13 13:24:42,019 - DEBUG - Timeouts: user 199.983835, metadata inf, idle connection 539989.000000, request inf
2025-04-13 13:24:42,019 - DEBUG - Sending request ApiVersionsRequest_v3(client_software_name='kafka-python', client_software_version='2.1.4', _tagged_fields={})
2025-04-13 13:24:42,019 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_send> [IPv6 ('::1', 9092, 0, 0)]>: Request 2 (timeout_ms 1600.0): ApiVersionsRequest_v3(client_software_name='kafka-python', client_software_version='2.1.4', _tagged_fields={})
2025-04-13 13:24:42,019 - DEBUG - Timeouts: user 199.990034, metadata inf, idle connection 539988.000000, request 1599.889755
2025-04-13 13:24:42,024 - DEBUG - Received correlation id: 2
2025-04-13 13:24:42,024 - DEBUG - Processing response ApiVersionsResponse_v3
2025-04-13 13:24:42,024 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_recv> [IPv6 ('::1', 9092, 0, 0)]>: Response 2 (5.355119705200195 ms): ApiVersionsResponse_v3(error_code=0, api_versions=[(api_key=0, min_version=0, max_version=9, _tagged_fields={}), (api_key=1, min_version=0, max_version=13, _tagged_fields={}), (api_key=2, min_version=0, max_version=7, _tagged_fields={}), (api_key=3, min_version=0, max_version=12, _tagged_fields={}), (api_key=4, min_version=0, max_version=7, _tagged_fields={}), (api_key=5, min_version=0, max_version=4, _tagged_fields={}), (api_key=6, min_version=0, max_version=8, _tagged_fields={}), (api_key=7, min_version=0, max_version=3, _tagged_fields={}), (api_key=8, min_version=0, max_version=8, _tagged_fields={}), (api_key=9, min_version=0, max_version=8, _tagged_fields={}), (api_key=10, min_version=0, max_version=4, _tagged_fields={}), (api_key=11, min_version=0, max_version=9, _tagged_fields={}), (api_key=12, min_version=0, max_version=4, _tagged_fields={}), (api_key=13, min_version=0, max_version=5, _tagged_fields={}), (api_key=14, min_version=0, max_version=5, _tagged_fields={}), (api_key=15, min_version=0, max_version=5, _tagged_fields={}), (api_key=16, min_version=0, max_version=4, _tagged_fields={}), (api_key=17, min_version=0, max_version=1, _tagged_fields={}), (api_key=18, min_version=0, max_version=3, _tagged_fields={}), (api_key=19, min_version=0, max_version=7, _tagged_fields={}), (api_key=20, min_version=0, max_version=6, _tagged_fields={}), (api_key=21, min_version=0, max_version=2, _tagged_fields={}), (api_key=22, min_version=0, max_version=4, _tagged_fields={}), (api_key=23, min_version=0, max_version=4, _tagged_fields={}), (api_key=24, min_version=0, max_version=3, _tagged_fields={}), (api_key=25, min_version=0, max_version=3, _tagged_fields={}), (api_key=26, min_version=0, max_version=3, _tagged_fields={}), (api_key=27, min_version=0, max_version=1, _tagged_fields={}), (api_key=28, min_version=0, max_version=3, _tagged_fields={}), (api_key=29, min_version=0, max_version=3, _tagged_fields={}), (api_key=30, min_version=0, max_version=3, _tagged_fields={}), (api_key=31, min_version=0, max_version=3, _tagged_fields={}), (api_key=32, min_version=0, max_version=4, _tagged_fields={}), (api_key=33, min_version=0, max_version=2, _tagged_fields={}), (api_key=34, min_version=0, max_version=2, _tagged_fields={}), (api_key=35, min_version=0, max_version=4, _tagged_fields={}), (api_key=36, min_version=0, max_version=2, _tagged_fields={}), (api_key=37, min_version=0, max_version=3, _tagged_fields={}), (api_key=38, min_version=0, max_version=3, _tagged_fields={}), (api_key=39, min_version=0, max_version=2, _tagged_fields={}), (api_key=40, min_version=0, max_version=2, _tagged_fields={}), (api_key=41, min_version=0, max_version=3, _tagged_fields={}), (api_key=42, min_version=0, max_version=2, _tagged_fields={}), (api_key=43, min_version=0, max_version=2, _tagged_fields={}), (api_key=44, min_version=0, max_version=1, _tagged_fields={}), (api_key=45, min_version=0, max_version=0, _tagged_fields={}), (api_key=46, min_version=0, max_version=0, _tagged_fields={}), (api_key=47, min_version=0, max_version=0, _tagged_fields={}), (api_key=48, min_version=0, max_version=1, _tagged_fields={}), (api_key=49, min_version=0, max_version=1, _tagged_fields={}), (api_key=50, min_version=0, max_version=0, _tagged_fields={}), (api_key=51, min_version=0, max_version=0, _tagged_fields={}), (api_key=56, min_version=0, max_version=2, _tagged_fields={}), (api_key=57, min_version=0, max_version=1, _tagged_fields={}), (api_key=58, min_version=0, max_version=0, _tagged_fields={}), (api_key=60, min_version=0, max_version=0, _tagged_fields={}), (api_key=61, min_version=0, max_version=0, _tagged_fields={}), (api_key=65, min_version=0, max_version=0, _tagged_fields={}), (api_key=66, min_version=0, max_version=0, _tagged_fields={}), (api_key=67, min_version=0, max_version=0, _tagged_fields={})], throttle_time_ms=0, _tagged_fields={1: b'\x00\x00\x00\x00\x00\x00\x00\x00'})
2025-04-13 13:24:42,025 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <checking_api_versions_recv> [IPv6 ('::1', 9092, 0, 0)]>: Broker version identified as 2.6
2025-04-13 13:24:42,025 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-04-13 13:24:42,025 - DEBUG - Node bootstrap-0 connected
2025-04-13 13:24:42,025 - DEBUG - Added sensor with name bufferpool-wait-time
2025-04-13 13:24:42,026 - DEBUG - Added sensor with name batch-size
2025-04-13 13:24:42,026 - DEBUG - Added sensor with name compression-rate
2025-04-13 13:24:42,026 - DEBUG - Added sensor with name queue-time
2025-04-13 13:24:42,026 - DEBUG - Added sensor with name records-per-request
2025-04-13 13:24:42,026 - DEBUG - Added sensor with name bytes
2025-04-13 13:24:42,026 - DEBUG - Added sensor with name record-retries
2025-04-13 13:24:42,026 - DEBUG - Added sensor with name errors
2025-04-13 13:24:42,026 - DEBUG - Added sensor with name record-size-max
2025-04-13 13:24:42,026 - DEBUG - Starting Kafka producer I/O thread.
2025-04-13 13:24:42,026 - DEBUG - Kafka producer started
2025-04-13 13:24:42,026 - DEBUG - Sending metadata request MetadataRequest_v7(topics=[], allow_auto_topic_creation=True) to node bootstrap-0
2025-04-13 13:24:42,026 - INFO - Kafka producer initialized successfully
2025-04-13 13:24:42,026 - DEBUG - Sending request MetadataRequest_v7(topics=[], allow_auto_topic_creation=True)
2025-04-13 13:24:42,026 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 3 (timeout_ms 30000): MetadataRequest_v7(topics=[], allow_auto_topic_creation=True)
2025-04-13 13:24:42,026 - DEBUG - Timeouts: user 9999999989.515305, metadata 30000.000000, idle connection 539981.000000, request 29999.985933
2025-04-13 13:24:42,027 - DEBUG - Timeouts: user 9999999989.996910, metadata 30000.000000, idle connection 539981.000000, request 29999.839067
2025-04-13 13:24:42,030 - DEBUG - Received correlation id: 3
2025-04-13 13:24:42,030 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 13:24:42,030 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 3 (3.7009716033935547 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[])
2025-04-13 13:24:42,030 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 0, groups: 0)
2025-04-13 13:24:42,031 - DEBUG - Timeouts: user 9999999989.995956, metadata 299999.777100, idle connection 539977.000000, request inf
2025-04-13 13:24:42,049 - INFO - Database initialized successfully!
2025-04-13 13:24:42,575 - INFO - Model and components loaded successfully!
2025-04-13 13:24:43,565 - INFO - Client connected
2025-04-13 13:24:43,582 - DEBUG - History count: 14
2025-04-13 13:24:43,587 - DEBUG - Returning click history with 14 entries
2025-04-13 13:24:43,588 - DEBUG - Received get_recommendations with data: {'sessionClicks': []}
2025-04-13 13:24:43,613 - DEBUG - Emitting recommendations: ['B01LYYHDNF', 'B017EA6Z5M', 'B0085UCUR8', 'B00BQDCCKG', 'B00J9YJ4ZU', 'B00GNXDGSQ', 'B00N4921J2', 'B00G3I2NBC', 'B09TBPDL75', 'B0BHTWVPRJ', 'B00MLDJW26', 'B09GMPT4YN', 'B00N6PBHC6', 'B0BK2KG1J6', 'B07CGTQCXP', 'B078VF299L', 'B004DNWRY2', 'B00IWTKY16', 'B006AKLFF8', 'B008035FT0']
2025-04-13 13:24:43,614 - DEBUG - Requesting metadata update for topic metrics_topic
2025-04-13 13:24:43,614 - DEBUG - Initializing connection to node 1 for metadata request
2025-04-13 13:24:43,614 - DEBUG - Initiating connection to node 1 at localhost:9092
2025-04-13 13:24:43,614 - DEBUG - Added sensor with name node-1.bytes-sent
2025-04-13 13:24:43,614 - DEBUG - Added sensor with name node-1.bytes-received
2025-04-13 13:24:43,614 - DEBUG - Added sensor with name node-1.latency
2025-04-13 13:24:43,615 - DEBUG - Added sensor with name node-1.throttle
2025-04-13 13:24:43,615 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connecting> [unspecified None]>: creating new socket
2025-04-13 13:24:43,615 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: setting socket option (6, 1, 1)
2025-04-13 13:24:43,616 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-04-13 13:24:43,616 - DEBUG - Timeouts: user 9999999988.399267, metadata inf, idle connection 538392.000000, request inf
2025-04-13 13:24:43,616 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: established TCP connection
2025-04-13 13:24:43,616 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <checking_api_versions_send> [IPv6 ('::1', 9092, 0, 0)]>: checking broker Api Versions
2025-04-13 13:24:43,616 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <checking_api_versions_send> [IPv6 ('::1', 9092, 0, 0)]>: Using pre-configured api_version (2, 6) for ApiVersions
2025-04-13 13:24:43,616 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-04-13 13:24:43,616 - DEBUG - Node 1 connected
2025-04-13 13:24:43,616 - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-04-13 13:24:43,616 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 13:24:43,616 - DEBUG - Sending request MetadataRequest_v7(topics=['metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:24:43,616 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 1 (timeout_ms 30000): MetadataRequest_v7(topics=['metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:24:43,616 - DEBUG - Timeouts: user 9999999989.765882, metadata 30000.000000, idle connection 538391.000000, request 29999.989033
2025-04-13 13:24:43,616 - DEBUG - Timeouts: user 9999999989.997864, metadata 30000.000000, idle connection 538391.000000, request 29999.882221
2025-04-13 13:24:43,625 - DEBUG - Received correlation id: 1
2025-04-13 13:24:43,626 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 13:24:43,626 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 1 (9.194612503051758 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 13:24:43,626 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 1, groups: 0)
2025-04-13 13:24:43,626 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.545166, idle connection 538381.000000, request inf
2025-04-13 13:24:43,626 - DEBUG - _wait_on_metadata woke after 0.012454032897949219 secs.
2025-04-13 13:24:43,626 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 0, 'clicks_on_recommended': 0, 'ctr': 0.0, 'timestamp': '2025-04-13T13:24:43.614168'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:43,626 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:43,627 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:43,627 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:43,627 - DEBUG - Added sensor with name topic.metrics_topic.records-per-batch
2025-04-13 13:24:43,627 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:43,627 - DEBUG - Added sensor with name topic.metrics_topic.bytes
2025-04-13 13:24:43,627 - DEBUG - Added sensor with name topic.metrics_topic.compression-rate
2025-04-13 13:24:43,627 - DEBUG - Added sensor with name topic.metrics_topic.record-retries
2025-04-13 13:24:43,627 - DEBUG - Added sensor with name topic.metrics_topic.record-errors
2025-04-13 13:24:43,627 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:43,627 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xbajSj\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9bo\xea\x00\x00\x01\x96-\x9bo\xea\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:43,627 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xbajSj\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9bo\xea\x00\x00\x01\x96-\x9bo\xea\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:43,628 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xbajSj\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9bo\xea\x00\x00\x01\x96-\x9bo\xea\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:43,628 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 2 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xbajSj\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9bo\xea\x00\x00\x01\x96-\x9bo\xea\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:43,628 - DEBUG - Timeouts: user 0.000000, metadata 299998.049072, idle connection 538380.000000, request 29999.984980
2025-04-13 13:24:43,628 - DEBUG - Timeouts: user 9999999989.998102, metadata 299997.917236, idle connection 538380.000000, request 29999.855995
2025-04-13 13:24:43,632 - DEBUG - Received correlation id: 2
2025-04-13 13:24:43,632 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:43,632 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 2 (4.843950271606445 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=20, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:43,633 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=20, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:43,633 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 20 log start offset 0.
2025-04-13 13:24:43,633 - DEBUG - Timeouts: user 9999999989.996910, metadata 299992.888184, idle connection 538375.000000, request inf
2025-04-13 13:24:43,633 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 0, 'clicks_on_recommended': 0, 'ctr': 0.0, 'timestamp': '2025-04-13T13:24:43.614168'}
2025-04-13 13:24:43,767 - DEBUG - Returning 50000 books
2025-04-13 13:24:44,277 - INFO - Updated book B0085UCUR8 with hover
2025-04-13 13:24:44,278 - DEBUG - Requesting metadata update for topic user_interactions
2025-04-13 13:24:44,278 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 13:24:44,278 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:24:44,278 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 3 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:24:44,278 - DEBUG - Timeouts: user 9999999989.753962, metadata 30000.000000, idle connection 537729.000000, request 29999.985933
2025-04-13 13:24:44,278 - DEBUG - Timeouts: user 9999999989.997864, metadata 30000.000000, idle connection 537729.000000, request 29999.817133
2025-04-13 13:24:44,281 - DEBUG - Received correlation id: 3
2025-04-13 13:24:44,281 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 13:24:44,281 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 3 (3.0350685119628906 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 13:24:44,281 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 13:24:44,282 - DEBUG - Timeouts: user 9999999989.995956, metadata 299999.899902, idle connection 537726.000000, request inf
2025-04-13 13:24:44,282 - DEBUG - _wait_on_metadata woke after 0.0040280818939208984 secs.
2025-04-13 13:24:44,282 - DEBUG - Sending (key=None value={'book_id': 'B0085UCUR8', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:44.278106'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:44,283 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:44,284 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:44,284 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:44,284 - DEBUG - Added sensor with name topic.user_interactions.records-per-batch
2025-04-13 13:24:44,284 - DEBUG - Added sensor with name topic.user_interactions.bytes
2025-04-13 13:24:44,284 - DEBUG - Added sensor with name topic.user_interactions.compression-rate
2025-04-13 13:24:44,284 - DEBUG - Added sensor with name topic.user_interactions.record-retries
2025-04-13 13:24:44,284 - DEBUG - Added sensor with name topic.user_interactions.record-errors
2025-04-13 13:24:44,284 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:44,284 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\n\xcb\xd5\xe9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9br|\x00\x00\x01\x96-\x9br|\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0085UCUR8", "even...')])])}
2025-04-13 13:24:44,284 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:44,284 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\n\xcb\xd5\xe9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9br|\x00\x00\x01\x96-\x9br|\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0085UCUR8", "even...')])])
2025-04-13 13:24:44,285 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\n\xcb\xd5\xe9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9br|\x00\x00\x01\x96-\x9br|\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0085UCUR8", "even...')])])
2025-04-13 13:24:44,285 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 4 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\n\xcb\xd5\xe9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9br|\x00\x00\x01\x96-\x9br|\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0085UCUR8", "even...')])])
2025-04-13 13:24:44,285 - DEBUG - Timeouts: user 0.000000, metadata 299996.677002, idle connection 537723.000000, request 29999.980211
2025-04-13 13:24:44,285 - DEBUG - Timeouts: user 9999999989.998102, metadata 299996.489990, idle connection 537723.000000, request 29999.796152
2025-04-13 13:24:44,294 - DEBUG - Received correlation id: 4
2025-04-13 13:24:44,295 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:44,295 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 4 (9.885787963867188 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=17, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:44,295 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=17, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:44,295 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 17 log start offset 0.
2025-04-13 13:24:44,295 - DEBUG - Timeouts: user 9999999989.994049, metadata 299986.446045, idle connection 537713.000000, request inf
2025-04-13 13:24:44,295 - INFO - Sent to Kafka (interactions): {'book_id': 'B0085UCUR8', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:44.278106'}
2025-04-13 13:24:44,295 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 0, 'clicks_on_recommended': 0, 'ctr': 0.0, 'timestamp': '2025-04-13T13:24:44.295615'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:44,295 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:44,295 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:44,295 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:44,296 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:44,296 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xe1D_\x87\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9br\x87\x00\x00\x01\x96-\x9br\x87\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:44,296 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xe1D_\x87\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9br\x87\x00\x00\x01\x96-\x9br\x87\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:44,296 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xe1D_\x87\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9br\x87\x00\x00\x01\x96-\x9br\x87\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:44,296 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 5 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xe1D_\x87\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9br\x87\x00\x00\x01\x96-\x9br\x87\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:44,296 - DEBUG - Timeouts: user 0.000000, metadata 299985.411133, idle connection 537712.000000, request 29999.984741
2025-04-13 13:24:44,296 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:44,296 - DEBUG - Timeouts: user 9999999989.996910, metadata 299985.141846, idle connection 537711.000000, request 29999.718904
2025-04-13 13:24:44,303 - DEBUG - Received correlation id: 5
2025-04-13 13:24:44,303 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:44,303 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 5 (6.789207458496094 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=21, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:44,303 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=21, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:44,303 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 21 log start offset 0.
2025-04-13 13:24:44,303 - DEBUG - Timeouts: user 9999999989.995241, metadata 299978.306885, idle connection 537704.000000, request inf
2025-04-13 13:24:44,303 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 0, 'clicks_on_recommended': 0, 'ctr': 0.0, 'timestamp': '2025-04-13T13:24:44.295615'}
2025-04-13 13:24:46,732 - INFO - Updated book B00G3I2NBC with hover
2025-04-13 13:24:46,732 - DEBUG - Sending (key=None value={'book_id': 'B00G3I2NBC', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:46.732241'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:46,732 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:46,732 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:46,732 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:46,732 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:46,733 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\xd7\x9cn\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|\x0c\x00\x00\x01\x96-\x9b|\x0c\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])}
2025-04-13 13:24:46,733 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:46,733 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\xd7\x9cn\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|\x0c\x00\x00\x01\x96-\x9b|\x0c\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])
2025-04-13 13:24:46,733 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\xd7\x9cn\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|\x0c\x00\x00\x01\x96-\x9b|\x0c\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])
2025-04-13 13:24:46,733 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 6 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\xd7\x9cn\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|\x0c\x00\x00\x01\x96-\x9b|\x0c\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])
2025-04-13 13:24:46,733 - DEBUG - Timeouts: user 0.000000, metadata 297548.584961, idle connection 535275.000000, request 29999.984026
2025-04-13 13:24:46,733 - DEBUG - Timeouts: user 9999999989.997864, metadata 297548.418945, idle connection 535275.000000, request 29999.821901
2025-04-13 13:24:46,749 - DEBUG - Received correlation id: 6
2025-04-13 13:24:46,750 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:46,750 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 6 (16.91293716430664 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=18, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:46,750 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=18, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:46,751 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 18 log start offset 0.
2025-04-13 13:24:46,751 - DEBUG - Timeouts: user 9999999989.989996, metadata 297530.237793, idle connection 535256.000000, request inf
2025-04-13 13:24:46,752 - INFO - Sent to Kafka (interactions): {'book_id': 'B00G3I2NBC', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:46.732241'}
2025-04-13 13:24:46,752 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 0, 'clicks_on_recommended': 0, 'ctr': 0.0, 'timestamp': '2025-04-13T13:24:46.752562'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:46,752 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:46,753 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:46,753 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:46,753 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:46,754 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:46,754 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xf3L\xfdG\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|!\x00\x00\x01\x96-\x9b|!\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:46,754 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xf3L\xfdG\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|!\x00\x00\x01\x96-\x9b|!\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:46,754 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xf3L\xfdG\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|!\x00\x00\x01\x96-\x9b|!\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:46,754 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 7 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xf3L\xfdG\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|!\x00\x00\x01\x96-\x9b|!\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:46,754 - DEBUG - Timeouts: user 0.000000, metadata 297526.966064, idle connection 535253.000000, request 29999.969006
2025-04-13 13:24:46,755 - DEBUG - Timeouts: user 9999999989.996910, metadata 297526.741943, idle connection 535253.000000, request 29999.756098
2025-04-13 13:24:46,757 - DEBUG - Received correlation id: 7
2025-04-13 13:24:46,757 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:46,757 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 7 (2.8579235076904297 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=22, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:46,757 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=22, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:46,758 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 22 log start offset 0.
2025-04-13 13:24:46,758 - DEBUG - Timeouts: user 9999999989.984035, metadata 297523.387939, idle connection 535249.000000, request inf
2025-04-13 13:24:46,758 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 0, 'clicks_on_recommended': 0, 'ctr': 0.0, 'timestamp': '2025-04-13T13:24:46.752562'}
2025-04-13 13:24:46,810 - INFO - Updated book B00G3I2NBC with click
2025-04-13 13:24:46,811 - DEBUG - Sending (key=None value={'book_id': 'B00G3I2NBC', 'event_type': 'click', 'timestamp': '2025-04-13T13:24:46.811040'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:46,811 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:46,811 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:46,811 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:46,811 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:46,811 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:46,811 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xa3\xed{\xc9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|[\x00\x00\x01\x96-\x9b|[\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])}
2025-04-13 13:24:46,811 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xa3\xed{\xc9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|[\x00\x00\x01\x96-\x9b|[\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])
2025-04-13 13:24:46,812 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xa3\xed{\xc9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|[\x00\x00\x01\x96-\x9b|[\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])
2025-04-13 13:24:46,812 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 8 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xa3\xed{\xc9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|[\x00\x00\x01\x96-\x9b|[\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])
2025-04-13 13:24:46,812 - DEBUG - Timeouts: user 0.000000, metadata 297469.680664, idle connection 535196.000000, request 29999.977827
2025-04-13 13:24:46,812 - DEBUG - Timeouts: user 9999999989.997149, metadata 297469.466797, idle connection 535196.000000, request 29999.768972
2025-04-13 13:24:46,817 - DEBUG - Received correlation id: 8
2025-04-13 13:24:46,817 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:46,817 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 8 (5.466938018798828 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=19, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:46,817 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=19, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:46,818 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 19 log start offset 0.
2025-04-13 13:24:46,818 - DEBUG - Timeouts: user 9999999989.993811, metadata 297463.701904, idle connection 535190.000000, request inf
2025-04-13 13:24:46,818 - INFO - Sent to Kafka (interactions): {'book_id': 'B00G3I2NBC', 'event_type': 'click', 'timestamp': '2025-04-13T13:24:46.811040'}
2025-04-13 13:24:46,818 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 1, 'clicks_on_recommended': 1, 'ctr': 0.05, 'timestamp': '2025-04-13T13:24:46.818530'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:46,818 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:46,818 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:46,818 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:46,818 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:46,819 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:46,819 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\x8f(\xd4]\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|b\x00\x00\x01\x96-\x9b|b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:46,819 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\x8f(\xd4]\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|b\x00\x00\x01\x96-\x9b|b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:46,819 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\x8f(\xd4]\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|b\x00\x00\x01\x96-\x9b|b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:46,819 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 9 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\x8f(\xd4]\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b|b\x00\x00\x01\x96-\x9b|b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:46,819 - DEBUG - Timeouts: user 0.000000, metadata 297462.145020, idle connection 535188.000000, request 29999.976873
2025-04-13 13:24:46,820 - DEBUG - Timeouts: user 9999999989.997387, metadata 297461.935059, idle connection 535188.000000, request 29999.771833
2025-04-13 13:24:46,827 - DEBUG - Received correlation id: 9
2025-04-13 13:24:46,827 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:46,827 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 9 (7.723093032836914 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=23, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:46,827 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=23, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:46,827 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 23 log start offset 0.
2025-04-13 13:24:46,827 - DEBUG - Timeouts: user 9999999989.995241, metadata 297453.985840, idle connection 535180.000000, request inf
2025-04-13 13:24:46,828 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 1, 'clicks_on_recommended': 1, 'ctr': 0.05, 'timestamp': '2025-04-13T13:24:46.818530'}
2025-04-13 13:24:46,830 - DEBUG - Returning click history with 15 entries
2025-04-13 13:24:47,135 - INFO - Updated book B09TBPDL75 with hover
2025-04-13 13:24:47,135 - DEBUG - Sending (key=None value={'book_id': 'B09TBPDL75', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:47.135546'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:47,135 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:47,136 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:47,136 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:47,136 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:47,136 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x9bfHW\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\x9f\x00\x00\x01\x96-\x9b}\x9f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09TBPDL75", "even...')])])}
2025-04-13 13:24:47,136 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:47,137 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x9bfHW\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\x9f\x00\x00\x01\x96-\x9b}\x9f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09TBPDL75", "even...')])])
2025-04-13 13:24:47,137 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x9bfHW\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\x9f\x00\x00\x01\x96-\x9b}\x9f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09TBPDL75", "even...')])])
2025-04-13 13:24:47,137 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 10 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x9bfHW\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\x9f\x00\x00\x01\x96-\x9b}\x9f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09TBPDL75", "even...')])])
2025-04-13 13:24:47,137 - DEBUG - Timeouts: user 0.000000, metadata 297144.562988, idle connection 534871.000000, request 29999.984264
2025-04-13 13:24:47,137 - DEBUG - Timeouts: user 9999999989.997864, metadata 297144.385986, idle connection 534870.000000, request 29999.811172
2025-04-13 13:24:47,149 - DEBUG - Received correlation id: 10
2025-04-13 13:24:47,149 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:47,149 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 10 (12.091875076293945 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=20, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,149 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=20, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,149 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 20 log start offset 0.
2025-04-13 13:24:47,149 - DEBUG - Timeouts: user 9999999989.997149, metadata 297132.204102, idle connection 534858.000000, request inf
2025-04-13 13:24:47,149 - INFO - Sent to Kafka (interactions): {'book_id': 'B09TBPDL75', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:47.135546'}
2025-04-13 13:24:47,149 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 1, 'clicks_on_recommended': 1, 'ctr': 0.05, 'timestamp': '2025-04-13T13:24:47.149851'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:47,149 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:47,150 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:47,150 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:47,150 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:47,150 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:47,150 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02G\xc9\xcf<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xae\x00\x00\x01\x96-\x9b}\xae\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:47,150 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02G\xc9\xcf<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xae\x00\x00\x01\x96-\x9b}\xae\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:47,150 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02G\xc9\xcf<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xae\x00\x00\x01\x96-\x9b}\xae\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:47,150 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 11 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02G\xc9\xcf<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xae\x00\x00\x01\x96-\x9b}\xae\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:47,150 - DEBUG - Timeouts: user 0.000000, metadata 297131.239746, idle connection 534857.000000, request 29999.984980
2025-04-13 13:24:47,150 - DEBUG - Timeouts: user 9999999989.998102, metadata 297131.104004, idle connection 534857.000000, request 29999.851942
2025-04-13 13:24:47,157 - DEBUG - Received correlation id: 11
2025-04-13 13:24:47,157 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:47,157 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 11 (6.97779655456543 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=24, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,157 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=24, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,157 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 24 log start offset 0.
2025-04-13 13:24:47,158 - DEBUG - Timeouts: user 9999999989.995003, metadata 297123.935791, idle connection 534850.000000, request inf
2025-04-13 13:24:47,158 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 1, 'clicks_on_recommended': 1, 'ctr': 0.05, 'timestamp': '2025-04-13T13:24:47.149851'}
2025-04-13 13:24:47,164 - INFO - Updated book B09TBPDL75 with click
2025-04-13 13:24:47,165 - DEBUG - Sending (key=None value={'book_id': 'B09TBPDL75', 'event_type': 'click', 'timestamp': '2025-04-13T13:24:47.165174'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:47,165 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:47,165 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:47,165 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:47,165 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:47,166 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:47,166 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xd8\x19\xdc\xdf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xbd\x00\x00\x01\x96-\x9b}\xbd\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09TBPDL75", "even...')])])}
2025-04-13 13:24:47,166 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xd8\x19\xdc\xdf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xbd\x00\x00\x01\x96-\x9b}\xbd\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09TBPDL75", "even...')])])
2025-04-13 13:24:47,166 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xd8\x19\xdc\xdf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xbd\x00\x00\x01\x96-\x9b}\xbd\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09TBPDL75", "even...')])])
2025-04-13 13:24:47,166 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 12 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xd8\x19\xdc\xdf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xbd\x00\x00\x01\x96-\x9b}\xbd\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09TBPDL75", "even...')])])
2025-04-13 13:24:47,166 - DEBUG - Timeouts: user 0.000000, metadata 297115.322754, idle connection 534841.000000, request 29999.979973
2025-04-13 13:24:47,166 - DEBUG - Timeouts: user 9999999989.997864, metadata 297115.125977, idle connection 534841.000000, request 29999.788046
2025-04-13 13:24:47,172 - DEBUG - Received correlation id: 12
2025-04-13 13:24:47,172 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:47,172 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 12 (5.626916885375977 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=21, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,172 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=21, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,172 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 21 log start offset 0.
2025-04-13 13:24:47,172 - DEBUG - Timeouts: user 9999999989.998341, metadata 297109.465820, idle connection 534836.000000, request inf
2025-04-13 13:24:47,172 - INFO - Sent to Kafka (interactions): {'book_id': 'B09TBPDL75', 'event_type': 'click', 'timestamp': '2025-04-13T13:24:47.165174'}
2025-04-13 13:24:47,172 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 2, 'clicks_on_recommended': 2, 'ctr': 0.1, 'timestamp': '2025-04-13T13:24:47.172602'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:47,172 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:47,172 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:47,172 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:47,172 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:47,173 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02L\x08q\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xc4\x00\x00\x01\x96-\x9b}\xc4\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:47,173 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:47,173 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02L\x08q\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xc4\x00\x00\x01\x96-\x9b}\xc4\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:47,173 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02L\x08q\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xc4\x00\x00\x01\x96-\x9b}\xc4\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:47,173 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 13 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02L\x08q\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b}\xc4\x00\x00\x01\x96-\x9b}\xc4\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:47,173 - DEBUG - Timeouts: user 0.000000, metadata 297108.527832, idle connection 534835.000000, request 29999.989986
2025-04-13 13:24:47,173 - DEBUG - Timeouts: user 9999999989.997864, metadata 297108.416016, idle connection 534835.000000, request 29999.880075
2025-04-13 13:24:47,178 - DEBUG - Received correlation id: 13
2025-04-13 13:24:47,178 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:47,178 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 13 (5.509853363037109 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=25, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,179 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=25, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,179 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 25 log start offset 0.
2025-04-13 13:24:47,179 - DEBUG - Timeouts: user 9999999989.994764, metadata 297102.613037, idle connection 534829.000000, request inf
2025-04-13 13:24:47,179 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 2, 'clicks_on_recommended': 2, 'ctr': 0.1, 'timestamp': '2025-04-13T13:24:47.172602'}
2025-04-13 13:24:47,181 - DEBUG - Returning click history with 16 entries
2025-04-13 13:24:47,433 - INFO - Updated book B00J9YJ4ZU with hover
2025-04-13 13:24:47,433 - DEBUG - Sending (key=None value={'book_id': 'B00J9YJ4ZU', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:47.433590'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:47,433 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:47,433 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:47,434 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:47,434 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:47,434 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:47,434 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x9e_dF\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b~\xc9\x00\x00\x01\x96-\x9b~\xc9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00J9YJ4ZU", "even...')])])}
2025-04-13 13:24:47,434 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x9e_dF\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b~\xc9\x00\x00\x01\x96-\x9b~\xc9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00J9YJ4ZU", "even...')])])
2025-04-13 13:24:47,434 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x9e_dF\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b~\xc9\x00\x00\x01\x96-\x9b~\xc9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00J9YJ4ZU", "even...')])])
2025-04-13 13:24:47,434 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 14 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x9e_dF\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b~\xc9\x00\x00\x01\x96-\x9b~\xc9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00J9YJ4ZU", "even...')])])
2025-04-13 13:24:47,434 - DEBUG - Timeouts: user 0.000000, metadata 296847.146973, idle connection 534573.000000, request 29999.975920
2025-04-13 13:24:47,434 - DEBUG - Timeouts: user 9999999989.998102, metadata 296846.939697, idle connection 534573.000000, request 29999.774933
2025-04-13 13:24:47,440 - DEBUG - Received correlation id: 14
2025-04-13 13:24:47,440 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:47,440 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 14 (5.7621002197265625 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=22, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,440 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=22, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,440 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 22 log start offset 0.
2025-04-13 13:24:47,440 - DEBUG - Timeouts: user 9999999989.994049, metadata 296840.958984, idle connection 534567.000000, request inf
2025-04-13 13:24:47,441 - INFO - Sent to Kafka (interactions): {'book_id': 'B00J9YJ4ZU', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:47.433590'}
2025-04-13 13:24:47,441 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 2, 'clicks_on_recommended': 2, 'ctr': 0.1, 'timestamp': '2025-04-13T13:24:47.441333'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:47,441 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:47,441 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:47,441 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:47,441 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:47,442 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:47,442 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xed\x88\xe0Q\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b~\xd1\x00\x00\x01\x96-\x9b~\xd1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:47,442 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xed\x88\xe0Q\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b~\xd1\x00\x00\x01\x96-\x9b~\xd1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:47,442 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xed\x88\xe0Q\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b~\xd1\x00\x00\x01\x96-\x9b~\xd1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:47,442 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 15 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xed\x88\xe0Q\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b~\xd1\x00\x00\x01\x96-\x9b~\xd1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:47,443 - DEBUG - Timeouts: user 0.000000, metadata 296838.911133, idle connection 534565.000000, request 29999.974728
2025-04-13 13:24:47,443 - DEBUG - Timeouts: user 9999999989.998102, metadata 296838.687012, idle connection 534565.000000, request 29999.757767
2025-04-13 13:24:47,449 - DEBUG - Received correlation id: 15
2025-04-13 13:24:47,449 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:47,449 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 15 (6.435155868530273 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=26, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,449 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=26, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:47,449 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 26 log start offset 0.
2025-04-13 13:24:47,449 - DEBUG - Timeouts: user 9999999989.995956, metadata 296832.147705, idle connection 534558.000000, request inf
2025-04-13 13:24:47,449 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 2, 'clicks_on_recommended': 2, 'ctr': 0.1, 'timestamp': '2025-04-13T13:24:47.441333'}
2025-04-13 13:24:59,126 - INFO - Updated book B00G3I2NBC with hover
2025-04-13 13:24:59,127 - DEBUG - Sending (key=None value={'book_id': 'B00G3I2NBC', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:59.127081'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,127 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,127 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:59,127 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:59,127 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:59,127 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xfb\xbf\xde\xe6\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xacw\x00\x00\x01\x96-\x9b\xacw\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])}
2025-04-13 13:24:59,128 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xfb\xbf\xde\xe6\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xacw\x00\x00\x01\x96-\x9b\xacw\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])
2025-04-13 13:24:59,128 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xfb\xbf\xde\xe6\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xacw\x00\x00\x01\x96-\x9b\xacw\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])
2025-04-13 13:24:59,128 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 16 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xfb\xbf\xde\xe6\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xacw\x00\x00\x01\x96-\x9b\xacw\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00G3I2NBC", "even...')])])
2025-04-13 13:24:59,128 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,128 - DEBUG - Timeouts: user 0.000000, metadata 285153.456055, idle connection 522880.000000, request 29999.978065
2025-04-13 13:24:59,128 - DEBUG - Timeouts: user 9999999989.998102, metadata 285153.179932, idle connection 522879.000000, request 29999.708176
2025-04-13 13:24:59,135 - DEBUG - Received correlation id: 16
2025-04-13 13:24:59,135 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:59,135 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 16 (7.246732711791992 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=23, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,135 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=23, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,135 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 23 log start offset 0.
2025-04-13 13:24:59,136 - DEBUG - Timeouts: user 9999999989.994049, metadata 285145.819824, idle connection 522872.000000, request inf
2025-04-13 13:24:59,136 - INFO - Sent to Kafka (interactions): {'book_id': 'B00G3I2NBC', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:59.127081'}
2025-04-13 13:24:59,136 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 2, 'clicks_on_recommended': 2, 'ctr': 0.1, 'timestamp': '2025-04-13T13:24:59.136425'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,136 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,136 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:59,136 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:59,136 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,137 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:59,137 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x020h\x01-\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xac\x80\x00\x00\x01\x96-\x9b\xac\x80\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:59,137 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x020h\x01-\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xac\x80\x00\x00\x01\x96-\x9b\xac\x80\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,137 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x020h\x01-\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xac\x80\x00\x00\x01\x96-\x9b\xac\x80\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,137 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 17 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x020h\x01-\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xac\x80\x00\x00\x01\x96-\x9b\xac\x80\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,137 - DEBUG - Timeouts: user 0.000000, metadata 285144.416992, idle connection 522871.000000, request 29999.981165
2025-04-13 13:24:59,137 - DEBUG - Timeouts: user 9999999989.997149, metadata 285144.208008, idle connection 522870.000000, request 29999.774933
2025-04-13 13:24:59,144 - DEBUG - Received correlation id: 17
2025-04-13 13:24:59,145 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:59,145 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 17 (7.655858993530273 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=27, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,145 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=27, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,145 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 27 log start offset 0.
2025-04-13 13:24:59,145 - DEBUG - Timeouts: user 9999999989.995003, metadata 285136.335693, idle connection 522862.000000, request inf
2025-04-13 13:24:59,145 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 2, 'clicks_on_recommended': 2, 'ctr': 0.1, 'timestamp': '2025-04-13T13:24:59.136425'}
2025-04-13 13:24:59,520 - INFO - Updated book B00N4921J2 with click
2025-04-13 13:24:59,520 - DEBUG - Sending (key=None value={'book_id': 'B00N4921J2', 'event_type': 'click', 'timestamp': '2025-04-13T13:24:59.520401'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,520 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,520 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:59,520 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:59,521 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:59,521 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,521 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x08\xb5\xcf\xca\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\x00\x00\x00\x01\x96-\x9b\xae\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00N4921J2", "even...')])])}
2025-04-13 13:24:59,521 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x08\xb5\xcf\xca\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\x00\x00\x00\x01\x96-\x9b\xae\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00N4921J2", "even...')])])
2025-04-13 13:24:59,521 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x08\xb5\xcf\xca\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\x00\x00\x00\x01\x96-\x9b\xae\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00N4921J2", "even...')])])
2025-04-13 13:24:59,521 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 18 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x08\xb5\xcf\xca\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\x00\x00\x00\x01\x96-\x9b\xae\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00N4921J2", "even...')])])
2025-04-13 13:24:59,521 - DEBUG - Timeouts: user 0.000000, metadata 284760.415039, idle connection 522487.000000, request 29999.983311
2025-04-13 13:24:59,521 - DEBUG - Timeouts: user 9999999989.997864, metadata 284760.233887, idle connection 522486.000000, request 29999.805927
2025-04-13 13:24:59,531 - DEBUG - Received correlation id: 18
2025-04-13 13:24:59,531 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:59,531 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 18 (10.420799255371094 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=24, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,532 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=24, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,532 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 24 log start offset 0.
2025-04-13 13:24:59,532 - DEBUG - Timeouts: user 9999999989.991903, metadata 284749.152832, idle connection 522475.000000, request inf
2025-04-13 13:24:59,532 - INFO - Sent to Kafka (interactions): {'book_id': 'B00N4921J2', 'event_type': 'click', 'timestamp': '2025-04-13T13:24:59.520401'}
2025-04-13 13:24:59,533 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 3, 'clicks_on_recommended': 3, 'ctr': 0.15, 'timestamp': '2025-04-13T13:24:59.533021'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,533 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,533 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:59,533 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:59,533 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,534 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:59,534 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xe8\xea\xc0:\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\r\x00\x00\x01\x96-\x9b\xae\r\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:59,534 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xe8\xea\xc0:\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\r\x00\x00\x01\x96-\x9b\xae\r\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,534 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xe8\xea\xc0:\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\r\x00\x00\x01\x96-\x9b\xae\r\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,534 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 19 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xe8\xea\xc0:\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\r\x00\x00\x01\x96-\x9b\xae\r\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,535 - DEBUG - Timeouts: user 0.000000, metadata 284746.995850, idle connection 522473.000000, request 29999.982119
2025-04-13 13:24:59,535 - DEBUG - Timeouts: user 9999999989.995956, metadata 284746.545654, idle connection 522473.000000, request 29999.534130
2025-04-13 13:24:59,539 - DEBUG - Received correlation id: 19
2025-04-13 13:24:59,539 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:59,539 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 19 (4.971027374267578 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=28, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,539 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=28, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,540 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 28 log start offset 0.
2025-04-13 13:24:59,540 - DEBUG - Timeouts: user 9999999989.995956, metadata 284741.802002, idle connection 522468.000000, request inf
2025-04-13 13:24:59,540 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 3, 'clicks_on_recommended': 3, 'ctr': 0.15, 'timestamp': '2025-04-13T13:24:59.533021'}
2025-04-13 13:24:59,543 - DEBUG - Returning click history with 17 entries
2025-04-13 13:24:59,546 - INFO - Updated book B00N4921J2 with hover
2025-04-13 13:24:59,547 - DEBUG - Sending (key=None value={'book_id': 'B00N4921J2', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:59.547091'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,547 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,547 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:59,547 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:59,548 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:59,548 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02Ji\xad|\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\x1b\x00\x00\x01\x96-\x9b\xae\x1b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00N4921J2", "even...')])])}
2025-04-13 13:24:59,548 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,548 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02Ji\xad|\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\x1b\x00\x00\x01\x96-\x9b\xae\x1b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00N4921J2", "even...')])])
2025-04-13 13:24:59,548 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02Ji\xad|\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\x1b\x00\x00\x01\x96-\x9b\xae\x1b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00N4921J2", "even...')])])
2025-04-13 13:24:59,548 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 20 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02Ji\xad|\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\x1b\x00\x00\x01\x96-\x9b\xae\x1b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00N4921J2", "even...')])])
2025-04-13 13:24:59,548 - DEBUG - Timeouts: user 0.000000, metadata 284733.150879, idle connection 522459.000000, request 29999.975920
2025-04-13 13:24:59,548 - DEBUG - Timeouts: user 9999999989.998102, metadata 284732.963135, idle connection 522459.000000, request 29999.795914
2025-04-13 13:24:59,551 - DEBUG - Received correlation id: 20
2025-04-13 13:24:59,551 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:59,551 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 20 (2.6731491088867188 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=25, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,551 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=25, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,551 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 25 log start offset 0.
2025-04-13 13:24:59,551 - DEBUG - Timeouts: user 9999999989.997864, metadata 284730.256836, idle connection 522456.000000, request inf
2025-04-13 13:24:59,551 - INFO - Sent to Kafka (interactions): {'book_id': 'B00N4921J2', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:59.547091'}
2025-04-13 13:24:59,551 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 3, 'clicks_on_recommended': 3, 'ctr': 0.15, 'timestamp': '2025-04-13T13:24:59.551875'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,551 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,552 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:59,552 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:59,552 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:59,552 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xd92\xe6\xc7\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae \x00\x00\x01\x96-\x9b\xae \xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:59,552 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,552 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xd92\xe6\xc7\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae \x00\x00\x01\x96-\x9b\xae \xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,552 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xd92\xe6\xc7\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae \x00\x00\x01\x96-\x9b\xae \xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,552 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 21 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xd92\xe6\xc7\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae \x00\x00\x01\x96-\x9b\xae \xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,552 - DEBUG - Timeouts: user 0.000000, metadata 284729.282959, idle connection 522455.000000, request 29999.987841
2025-04-13 13:24:59,552 - DEBUG - Timeouts: user 9999999989.997864, metadata 284729.164062, idle connection 522455.000000, request 29999.871016
2025-04-13 13:24:59,554 - DEBUG - Received correlation id: 21
2025-04-13 13:24:59,554 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:59,554 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 21 (1.953125 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=29, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,554 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=29, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,554 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 29 log start offset 0.
2025-04-13 13:24:59,554 - DEBUG - Timeouts: user 9999999989.996910, metadata 284727.157959, idle connection 522453.000000, request inf
2025-04-13 13:24:59,554 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 3, 'clicks_on_recommended': 3, 'ctr': 0.15, 'timestamp': '2025-04-13T13:24:59.551875'}
2025-04-13 13:24:59,755 - INFO - Updated book B09GMPT4YN with hover
2025-04-13 13:24:59,755 - DEBUG - Sending (key=None value={'book_id': 'B09GMPT4YN', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:59.755243'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,755 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,755 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:59,755 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:59,755 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:59,755 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02?\xeb\xb0)\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\xeb\x00\x00\x01\x96-\x9b\xae\xeb\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09GMPT4YN", "even...')])])}
2025-04-13 13:24:59,755 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02?\xeb\xb0)\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\xeb\x00\x00\x01\x96-\x9b\xae\xeb\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09GMPT4YN", "even...')])])
2025-04-13 13:24:59,756 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,756 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02?\xeb\xb0)\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\xeb\x00\x00\x01\x96-\x9b\xae\xeb\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09GMPT4YN", "even...')])])
2025-04-13 13:24:59,756 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 22 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02?\xeb\xb0)\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\xeb\x00\x00\x01\x96-\x9b\xae\xeb\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09GMPT4YN", "even...')])])
2025-04-13 13:24:59,756 - DEBUG - Timeouts: user 0.000000, metadata 284525.348877, idle connection 522251.000000, request 29999.969959
2025-04-13 13:24:59,756 - DEBUG - Timeouts: user 9999999989.996195, metadata 284525.091064, idle connection 522251.000000, request 29999.719858
2025-04-13 13:24:59,759 - DEBUG - Received correlation id: 22
2025-04-13 13:24:59,759 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:59,759 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 22 (2.768278121948242 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=26, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,759 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=26, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,759 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 26 log start offset 0.
2025-04-13 13:24:59,759 - DEBUG - Timeouts: user 9999999989.995956, metadata 284522.266846, idle connection 522248.000000, request inf
2025-04-13 13:24:59,759 - INFO - Sent to Kafka (interactions): {'book_id': 'B09GMPT4YN', 'event_type': 'hover', 'timestamp': '2025-04-13T13:24:59.755243'}
2025-04-13 13:24:59,760 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 3, 'clicks_on_recommended': 3, 'ctr': 0.15, 'timestamp': '2025-04-13T13:24:59.759944'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,760 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,760 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:59,760 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:59,760 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:59,760 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\x99\xd4\xf6}\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\xf0\x00\x00\x01\x96-\x9b\xae\xf0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:59,760 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,760 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\x99\xd4\xf6}\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\xf0\x00\x00\x01\x96-\x9b\xae\xf0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,761 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\x99\xd4\xf6}\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\xf0\x00\x00\x01\x96-\x9b\xae\xf0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,761 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 23 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\x99\xd4\xf6}\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xae\xf0\x00\x00\x01\x96-\x9b\xae\xf0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,761 - DEBUG - Timeouts: user 0.000000, metadata 284520.495117, idle connection 522247.000000, request 29999.973059
2025-04-13 13:24:59,761 - DEBUG - Timeouts: user 9999999989.997149, metadata 284520.250732, idle connection 522246.000000, request 29999.737024
2025-04-13 13:24:59,763 - DEBUG - Received correlation id: 23
2025-04-13 13:24:59,763 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:59,763 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 23 (2.264261245727539 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=30, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,763 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=30, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,763 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 30 log start offset 0.
2025-04-13 13:24:59,764 - DEBUG - Timeouts: user 9999999989.996195, metadata 284517.934082, idle connection 522244.000000, request inf
2025-04-13 13:24:59,764 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 3, 'clicks_on_recommended': 3, 'ctr': 0.15, 'timestamp': '2025-04-13T13:24:59.759944'}
2025-04-13 13:24:59,776 - INFO - Updated book B09GMPT4YN with click
2025-04-13 13:24:59,777 - DEBUG - Sending (key=None value={'book_id': 'B09GMPT4YN', 'event_type': 'click', 'timestamp': '2025-04-13T13:24:59.776983'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,777 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,777 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:24:59,777 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:59,777 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:24:59,777 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:59,777 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xdbI\x8e\x81\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xaf\x01\x00\x00\x01\x96-\x9b\xaf\x01\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09GMPT4YN", "even...')])])}
2025-04-13 13:24:59,777 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xdbI\x8e\x81\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xaf\x01\x00\x00\x01\x96-\x9b\xaf\x01\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09GMPT4YN", "even...')])])
2025-04-13 13:24:59,778 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xdbI\x8e\x81\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xaf\x01\x00\x00\x01\x96-\x9b\xaf\x01\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09GMPT4YN", "even...')])])
2025-04-13 13:24:59,778 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 24 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xdbI\x8e\x81\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xaf\x01\x00\x00\x01\x96-\x9b\xaf\x01\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09GMPT4YN", "even...')])])
2025-04-13 13:24:59,778 - DEBUG - Timeouts: user 0.000000, metadata 284503.656738, idle connection 522230.000000, request 29999.979973
2025-04-13 13:24:59,778 - DEBUG - Timeouts: user 9999999989.996910, metadata 284503.444824, idle connection 522230.000000, request 29999.771833
2025-04-13 13:24:59,782 - DEBUG - Received correlation id: 24
2025-04-13 13:24:59,782 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:59,782 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 24 (4.665136337280273 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=27, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,783 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=27, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,783 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 27 log start offset 0.
2025-04-13 13:24:59,783 - DEBUG - Timeouts: user 9999999989.997387, metadata 284498.691895, idle connection 522225.000000, request inf
2025-04-13 13:24:59,783 - INFO - Sent to Kafka (interactions): {'book_id': 'B09GMPT4YN', 'event_type': 'click', 'timestamp': '2025-04-13T13:24:59.776983'}
2025-04-13 13:24:59,783 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 4, 'clicks_on_recommended': 4, 'ctr': 0.2, 'timestamp': '2025-04-13T13:24:59.783542'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,783 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,783 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:24:59,783 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:24:59,784 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:24:59,784 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:24:59,784 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xde\xfb2\xc2\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xaf\x07\x00\x00\x01\x96-\x9b\xaf\x07\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:24:59,784 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xde\xfb2\xc2\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xaf\x07\x00\x00\x01\x96-\x9b\xaf\x07\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,784 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xde\xfb2\xc2\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xaf\x07\x00\x00\x01\x96-\x9b\xaf\x07\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,784 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 25 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xde\xfb2\xc2\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xaf\x07\x00\x00\x01\x96-\x9b\xaf\x07\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:24:59,784 - DEBUG - Timeouts: user 0.000000, metadata 284497.316895, idle connection 522223.000000, request 29999.976873
2025-04-13 13:24:59,784 - DEBUG - Timeouts: user 9999999989.998102, metadata 284497.133057, idle connection 522223.000000, request 29999.798059
2025-04-13 13:24:59,787 - DEBUG - Received correlation id: 25
2025-04-13 13:24:59,787 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:24:59,787 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 25 (2.8409957885742188 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=31, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,787 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=31, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:24:59,787 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 31 log start offset 0.
2025-04-13 13:24:59,787 - DEBUG - Timeouts: user 9999999989.997149, metadata 284494.215820, idle connection 522220.000000, request inf
2025-04-13 13:24:59,787 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 4, 'clicks_on_recommended': 4, 'ctr': 0.2, 'timestamp': '2025-04-13T13:24:59.783542'}
2025-04-13 13:24:59,789 - DEBUG - Returning click history with 18 entries
2025-04-13 13:25:00,041 - INFO - Updated book B004DNWRY2 with hover
2025-04-13 13:25:00,042 - DEBUG - Sending (key=None value={'book_id': 'B004DNWRY2', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:00.042273'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,042 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,042 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,043 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,043 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,043 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,043 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02r\x96\xab^\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0\n\x00\x00\x01\x96-\x9b\xb0\n\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B004DNWRY2", "even...')])])}
2025-04-13 13:25:00,043 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02r\x96\xab^\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0\n\x00\x00\x01\x96-\x9b\xb0\n\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B004DNWRY2", "even...')])])
2025-04-13 13:25:00,044 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02r\x96\xab^\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0\n\x00\x00\x01\x96-\x9b\xb0\n\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B004DNWRY2", "even...')])])
2025-04-13 13:25:00,044 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 26 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02r\x96\xab^\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0\n\x00\x00\x01\x96-\x9b\xb0\n\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B004DNWRY2", "even...')])])
2025-04-13 13:25:00,044 - DEBUG - Timeouts: user 0.000000, metadata 284237.594727, idle connection 521964.000000, request 29999.969006
2025-04-13 13:25:00,044 - DEBUG - Timeouts: user 9999999989.997149, metadata 284237.348145, idle connection 521963.000000, request 29999.732018
2025-04-13 13:25:00,055 - DEBUG - Received correlation id: 26
2025-04-13 13:25:00,055 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,055 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 26 (11.268138885498047 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=28, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,055 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=28, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,056 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 28 log start offset 0.
2025-04-13 13:25:00,056 - DEBUG - Timeouts: user 9999999989.991665, metadata 284225.566895, idle connection 521952.000000, request inf
2025-04-13 13:25:00,056 - INFO - Sent to Kafka (interactions): {'book_id': 'B004DNWRY2', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:00.042273'}
2025-04-13 13:25:00,057 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 4, 'clicks_on_recommended': 4, 'ctr': 0.2, 'timestamp': '2025-04-13T13:25:00.057559'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,057 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,058 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,058 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,058 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,058 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\x08U\x89\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0\x1a\x00\x00\x01\x96-\x9b\xb0\x1a\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:25:00,058 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\x08U\x89\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0\x1a\x00\x00\x01\x96-\x9b\xb0\x1a\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,059 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\x08U\x89\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0\x1a\x00\x00\x01\x96-\x9b\xb0\x1a\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,059 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 27 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\x08U\x89\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0\x1a\x00\x00\x01\x96-\x9b\xb0\x1a\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,059 - DEBUG - Timeouts: user 0.000000, metadata 284222.703857, idle connection 521949.000000, request 29999.979019
2025-04-13 13:25:00,059 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,059 - DEBUG - Timeouts: user 9999999989.996910, metadata 284222.388916, idle connection 521948.000000, request 29999.668121
2025-04-13 13:25:00,062 - DEBUG - Received correlation id: 27
2025-04-13 13:25:00,066 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,066 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 27 (7.419824600219727 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=32, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,066 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=32, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,066 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 32 log start offset 0.
2025-04-13 13:25:00,067 - DEBUG - Timeouts: user 9999999989.994764, metadata 284214.903076, idle connection 521941.000000, request inf
2025-04-13 13:25:00,067 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 4, 'clicks_on_recommended': 4, 'ctr': 0.2, 'timestamp': '2025-04-13T13:25:00.057559'}
2025-04-13 13:25:00,069 - DEBUG - Returning click history with 18 entries
2025-04-13 13:25:00,072 - INFO - Updated book B004DNWRY2 with click
2025-04-13 13:25:00,073 - DEBUG - Sending (key=None value={'book_id': 'B004DNWRY2', 'event_type': 'click', 'timestamp': '2025-04-13T13:25:00.073127'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,073 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,073 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,073 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,073 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,074 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,074 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02E\x84\x1b_\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0)\x00\x00\x01\x96-\x9b\xb0)\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B004DNWRY2", "even...')])])}
2025-04-13 13:25:00,074 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02E\x84\x1b_\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0)\x00\x00\x01\x96-\x9b\xb0)\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B004DNWRY2", "even...')])])
2025-04-13 13:25:00,074 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02E\x84\x1b_\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0)\x00\x00\x01\x96-\x9b\xb0)\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B004DNWRY2", "even...')])])
2025-04-13 13:25:00,074 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 28 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02E\x84\x1b_\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb0)\x00\x00\x01\x96-\x9b\xb0)\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B004DNWRY2", "even...')])])
2025-04-13 13:25:00,074 - DEBUG - Timeouts: user 0.000000, metadata 284207.019043, idle connection 521933.000000, request 29999.975920
2025-04-13 13:25:00,075 - DEBUG - Timeouts: user 9999999989.998341, metadata 284206.788086, idle connection 521933.000000, request 29999.750853
2025-04-13 13:25:00,081 - DEBUG - Received correlation id: 28
2025-04-13 13:25:00,081 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,081 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 28 (6.40416145324707 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=29, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,081 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=29, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,081 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 29 log start offset 0.
2025-04-13 13:25:00,081 - DEBUG - Timeouts: user 9999999989.996195, metadata 284200.291992, idle connection 521926.000000, request inf
2025-04-13 13:25:00,081 - INFO - Sent to Kafka (interactions): {'book_id': 'B004DNWRY2', 'event_type': 'click', 'timestamp': '2025-04-13T13:25:00.073127'}
2025-04-13 13:25:00,081 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 5, 'clicks_on_recommended': 5, 'ctr': 0.25, 'timestamp': '2025-04-13T13:25:00.081809'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,081 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,082 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,082 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,082 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,082 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,082 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02T\xfa1\xcb\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb02\x00\x00\x01\x96-\x9b\xb02\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:25:00,082 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02T\xfa1\xcb\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb02\x00\x00\x01\x96-\x9b\xb02\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,082 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02T\xfa1\xcb\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb02\x00\x00\x01\x96-\x9b\xb02\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,082 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 29 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02T\xfa1\xcb\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb02\x00\x00\x01\x96-\x9b\xb02\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,083 - DEBUG - Timeouts: user 0.000000, metadata 284198.909912, idle connection 521925.000000, request 29999.984026
2025-04-13 13:25:00,083 - DEBUG - Timeouts: user 9999999989.998102, metadata 284198.740967, idle connection 521925.000000, request 29999.816895
2025-04-13 13:25:00,088 - DEBUG - Received correlation id: 29
2025-04-13 13:25:00,088 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,088 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 29 (5.244970321655273 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=33, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,088 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=33, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,088 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 33 log start offset 0.
2025-04-13 13:25:00,088 - DEBUG - Timeouts: user 9999999989.996195, metadata 284193.358154, idle connection 521919.000000, request inf
2025-04-13 13:25:00,088 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 5, 'clicks_on_recommended': 5, 'ctr': 0.25, 'timestamp': '2025-04-13T13:25:00.081809'}
2025-04-13 13:25:00,339 - INFO - Updated book B006AKLFF8 with hover
2025-04-13 13:25:00,339 - DEBUG - Sending (key=None value={'book_id': 'B006AKLFF8', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:00.339728'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,339 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,340 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,340 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,340 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,340 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xf1\x19^\xf5\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb14\x00\x00\x01\x96-\x9b\xb14\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006AKLFF8", "even...')])])}
2025-04-13 13:25:00,340 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,340 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xf1\x19^\xf5\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb14\x00\x00\x01\x96-\x9b\xb14\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006AKLFF8", "even...')])])
2025-04-13 13:25:00,341 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xf1\x19^\xf5\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb14\x00\x00\x01\x96-\x9b\xb14\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006AKLFF8", "even...')])])
2025-04-13 13:25:00,341 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 30 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xf1\x19^\xf5\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb14\x00\x00\x01\x96-\x9b\xb14\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006AKLFF8", "even...')])])
2025-04-13 13:25:00,341 - DEBUG - Timeouts: user 0.000000, metadata 283940.649902, idle connection 521667.000000, request 29999.959946
2025-04-13 13:25:00,341 - DEBUG - Timeouts: user 9999999989.997149, metadata 283940.345947, idle connection 521666.000000, request 29999.680042
2025-04-13 13:25:00,344 - DEBUG - Received correlation id: 30
2025-04-13 13:25:00,344 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,344 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 30 (3.412961959838867 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=30, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,344 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=30, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,344 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 30 log start offset 0.
2025-04-13 13:25:00,345 - DEBUG - Timeouts: user 9999999989.995003, metadata 283936.772705, idle connection 521663.000000, request inf
2025-04-13 13:25:00,345 - INFO - Sent to Kafka (interactions): {'book_id': 'B006AKLFF8', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:00.339728'}
2025-04-13 13:25:00,345 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 5, 'clicks_on_recommended': 5, 'ctr': 0.25, 'timestamp': '2025-04-13T13:25:00.345419'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,345 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,345 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,345 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,345 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,345 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,346 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xf0Y\xf4\xfa\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb19\x00\x00\x01\x96-\x9b\xb19\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:25:00,346 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xf0Y\xf4\xfa\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb19\x00\x00\x01\x96-\x9b\xb19\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,346 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xf0Y\xf4\xfa\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb19\x00\x00\x01\x96-\x9b\xb19\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,346 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 31 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xf0Y\xf4\xfa\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb19\x00\x00\x01\x96-\x9b\xb19\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,346 - DEBUG - Timeouts: user 0.000000, metadata 283935.535889, idle connection 521662.000000, request 29999.981880
2025-04-13 13:25:00,346 - DEBUG - Timeouts: user 9999999989.997149, metadata 283935.374023, idle connection 521661.000000, request 29999.822855
2025-04-13 13:25:00,350 - DEBUG - Received correlation id: 31
2025-04-13 13:25:00,350 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,350 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 31 (3.7450790405273438 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=34, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,350 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=34, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,350 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 34 log start offset 0.
2025-04-13 13:25:00,350 - DEBUG - Timeouts: user 9999999989.995241, metadata 283931.437988, idle connection 521658.000000, request inf
2025-04-13 13:25:00,350 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 5, 'clicks_on_recommended': 5, 'ctr': 0.25, 'timestamp': '2025-04-13T13:25:00.345419'}
2025-04-13 13:25:00,412 - INFO - Updated book B006AKLFF8 with click
2025-04-13 13:25:00,412 - DEBUG - Sending (key=None value={'book_id': 'B006AKLFF8', 'event_type': 'click', 'timestamp': '2025-04-13T13:25:00.412432'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,412 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,412 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,412 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,412 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,413 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,413 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xccM\x06\x9a\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb1|\x00\x00\x01\x96-\x9b\xb1|\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006AKLFF8", "even...')])])}
2025-04-13 13:25:00,413 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xccM\x06\x9a\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb1|\x00\x00\x01\x96-\x9b\xb1|\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006AKLFF8", "even...')])])
2025-04-13 13:25:00,413 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xccM\x06\x9a\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb1|\x00\x00\x01\x96-\x9b\xb1|\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006AKLFF8", "even...')])])
2025-04-13 13:25:00,413 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 32 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xccM\x06\x9a\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb1|\x00\x00\x01\x96-\x9b\xb1|\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B006AKLFF8", "even...')])])
2025-04-13 13:25:00,413 - DEBUG - Timeouts: user 0.000000, metadata 283867.985840, idle connection 521594.000000, request 29999.972820
2025-04-13 13:25:00,414 - DEBUG - Timeouts: user 9999999989.995718, metadata 283867.750732, idle connection 521594.000000, request 29999.744892
2025-04-13 13:25:00,419 - DEBUG - Received correlation id: 32
2025-04-13 13:25:00,419 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,419 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 32 (5.949974060058594 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=31, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,420 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=31, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,420 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 31 log start offset 0.
2025-04-13 13:25:00,420 - DEBUG - Timeouts: user 9999999989.995003, metadata 283861.534912, idle connection 521588.000000, request inf
2025-04-13 13:25:00,420 - INFO - Sent to Kafka (interactions): {'book_id': 'B006AKLFF8', 'event_type': 'click', 'timestamp': '2025-04-13T13:25:00.412432'}
2025-04-13 13:25:00,420 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 6, 'clicks_on_recommended': 6, 'ctr': 0.3, 'timestamp': '2025-04-13T13:25:00.420620'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,420 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,420 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,420 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,421 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,421 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,421 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xf0\xa1\x04\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb1\x84\x00\x00\x01\x96-\x9b\xb1\x84\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:25:00,421 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xf0\xa1\x04\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb1\x84\x00\x00\x01\x96-\x9b\xb1\x84\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,421 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xf0\xa1\x04\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb1\x84\x00\x00\x01\x96-\x9b\xb1\x84\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,421 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 33 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xf0\xa1\x04\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb1\x84\x00\x00\x01\x96-\x9b\xb1\x84\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,422 - DEBUG - Timeouts: user 0.000000, metadata 283859.914062, idle connection 521586.000000, request 29999.974012
2025-04-13 13:25:00,422 - DEBUG - Timeouts: user 9999999989.996910, metadata 283859.648926, idle connection 521586.000000, request 29999.717951
2025-04-13 13:25:00,430 - DEBUG - Received correlation id: 33
2025-04-13 13:25:00,430 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,430 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 33 (8.551836013793945 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=35, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,430 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=35, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,430 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 35 log start offset 0.
2025-04-13 13:25:00,430 - DEBUG - Timeouts: user 9999999989.995003, metadata 283850.986816, idle connection 521577.000000, request inf
2025-04-13 13:25:00,431 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 6, 'clicks_on_recommended': 6, 'ctr': 0.3, 'timestamp': '2025-04-13T13:25:00.420620'}
2025-04-13 13:25:00,432 - DEBUG - Returning click history with 20 entries
2025-04-13 13:25:00,678 - INFO - Updated book B0BK2KG1J6 with hover
2025-04-13 13:25:00,678 - DEBUG - Sending (key=None value={'book_id': 'B0BK2KG1J6', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:00.678650'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,678 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,679 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,679 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,679 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,679 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\xd0\xecV\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x86\x00\x00\x01\x96-\x9b\xb2\x86\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0BK2KG1J6", "even...')])])}
2025-04-13 13:25:00,679 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,679 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\xd0\xecV\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x86\x00\x00\x01\x96-\x9b\xb2\x86\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0BK2KG1J6", "even...')])])
2025-04-13 13:25:00,679 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\xd0\xecV\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x86\x00\x00\x01\x96-\x9b\xb2\x86\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0BK2KG1J6", "even...')])])
2025-04-13 13:25:00,679 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 34 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\xd0\xecV\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x86\x00\x00\x01\x96-\x9b\xb2\x86\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0BK2KG1J6", "even...')])])
2025-04-13 13:25:00,679 - DEBUG - Timeouts: user 0.000000, metadata 283601.989990, idle connection 521328.000000, request 29999.979019
2025-04-13 13:25:00,680 - DEBUG - Timeouts: user 9999999989.997864, metadata 283601.779053, idle connection 521328.000000, request 29999.774933
2025-04-13 13:25:00,686 - DEBUG - Received correlation id: 34
2025-04-13 13:25:00,687 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,687 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 34 (7.26008415222168 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=32, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,687 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=32, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,687 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 32 log start offset 0.
2025-04-13 13:25:00,687 - DEBUG - Timeouts: user 9999999989.995956, metadata 283594.407959, idle connection 521321.000000, request inf
2025-04-13 13:25:00,687 - INFO - Sent to Kafka (interactions): {'book_id': 'B0BK2KG1J6', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:00.678650'}
2025-04-13 13:25:00,687 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 6, 'clicks_on_recommended': 6, 'ctr': 0.3, 'timestamp': '2025-04-13T13:25:00.687805'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,687 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,688 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,688 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,688 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,688 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,688 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02x\xb9T\xcf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x90\x00\x00\x01\x96-\x9b\xb2\x90\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:25:00,688 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02x\xb9T\xcf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x90\x00\x00\x01\x96-\x9b\xb2\x90\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,688 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02x\xb9T\xcf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x90\x00\x00\x01\x96-\x9b\xb2\x90\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,688 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 35 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02x\xb9T\xcf\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x90\x00\x00\x01\x96-\x9b\xb2\x90\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,688 - DEBUG - Timeouts: user 0.000000, metadata 283593.191895, idle connection 521319.000000, request 29999.985933
2025-04-13 13:25:00,688 - DEBUG - Timeouts: user 9999999989.998102, metadata 283593.044922, idle connection 521319.000000, request 29999.841928
2025-04-13 13:25:00,694 - DEBUG - Received correlation id: 35
2025-04-13 13:25:00,695 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,695 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 35 (6.340980529785156 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=36, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,695 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=36, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,695 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 36 log start offset 0.
2025-04-13 13:25:00,695 - DEBUG - Timeouts: user 9999999989.996910, metadata 283586.623779, idle connection 521313.000000, request inf
2025-04-13 13:25:00,695 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 6, 'clicks_on_recommended': 6, 'ctr': 0.3, 'timestamp': '2025-04-13T13:25:00.687805'}
2025-04-13 13:25:00,696 - DEBUG - Returning click history with 20 entries
2025-04-13 13:25:00,698 - INFO - Updated book B0BK2KG1J6 with click
2025-04-13 13:25:00,698 - DEBUG - Sending (key=None value={'book_id': 'B0BK2KG1J6', 'event_type': 'click', 'timestamp': '2025-04-13T13:25:00.698518'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,698 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,698 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,698 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,698 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:00,699 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,699 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02q"\xf5/\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x9a\x00\x00\x01\x96-\x9b\xb2\x9a\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0BK2KG1J6", "even...')])])}
2025-04-13 13:25:00,699 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02q"\xf5/\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x9a\x00\x00\x01\x96-\x9b\xb2\x9a\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0BK2KG1J6", "even...')])])
2025-04-13 13:25:00,699 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02q"\xf5/\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x9a\x00\x00\x01\x96-\x9b\xb2\x9a\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0BK2KG1J6", "even...')])])
2025-04-13 13:25:00,699 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 36 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02q"\xf5/\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x9a\x00\x00\x01\x96-\x9b\xb2\x9a\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0BK2KG1J6", "even...')])])
2025-04-13 13:25:00,699 - DEBUG - Timeouts: user 0.000000, metadata 283582.484863, idle connection 521309.000000, request 29999.986172
2025-04-13 13:25:00,699 - DEBUG - Timeouts: user 9999999989.997864, metadata 283582.348145, idle connection 521308.000000, request 29999.852180
2025-04-13 13:25:00,702 - DEBUG - Received correlation id: 36
2025-04-13 13:25:00,702 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,702 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 36 (3.2219886779785156 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=33, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,702 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=33, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,702 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 33 log start offset 0.
2025-04-13 13:25:00,703 - DEBUG - Timeouts: user 9999999989.997149, metadata 283578.916748, idle connection 521305.000000, request inf
2025-04-13 13:25:00,703 - INFO - Sent to Kafka (interactions): {'book_id': 'B0BK2KG1J6', 'event_type': 'click', 'timestamp': '2025-04-13T13:25:00.698518'}
2025-04-13 13:25:00,703 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.35, 'timestamp': '2025-04-13T13:25:00.703202'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,703 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,703 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:00,703 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:00,703 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:00,703 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02&\x10\xb8\x84\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x9f\x00\x00\x01\x96-\x9b\xb2\x9f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:25:00,703 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:00,703 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02&\x10\xb8\x84\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x9f\x00\x00\x01\x96-\x9b\xb2\x9f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,703 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02&\x10\xb8\x84\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x9f\x00\x00\x01\x96-\x9b\xb2\x9f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,704 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 37 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02&\x10\xb8\x84\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb2\x9f\x00\x00\x01\x96-\x9b\xb2\x9f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:00,704 - DEBUG - Timeouts: user 0.000000, metadata 283577.793945, idle connection 521304.000000, request 29999.985933
2025-04-13 13:25:00,704 - DEBUG - Timeouts: user 9999999989.997864, metadata 283577.639893, idle connection 521304.000000, request 29999.835014
2025-04-13 13:25:00,706 - DEBUG - Received correlation id: 37
2025-04-13 13:25:00,706 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:00,706 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 37 (2.830028533935547 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=37, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,707 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=37, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:00,707 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 37 log start offset 0.
2025-04-13 13:25:00,707 - DEBUG - Timeouts: user 9999999989.996910, metadata 283574.743896, idle connection 521301.000000, request inf
2025-04-13 13:25:00,707 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.35, 'timestamp': '2025-04-13T13:25:00.703202'}
2025-04-13 13:25:01,022 - INFO - Updated book B00J9YJ4ZU with hover
2025-04-13 13:25:01,025 - DEBUG - Sending (key=None value={'book_id': 'B00J9YJ4ZU', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:01.025164'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:01,025 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:01,025 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:01,025 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:01,025 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:01,027 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:01,027 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02qiz<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb3\xe1\x00\x00\x01\x96-\x9b\xb3\xe1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00J9YJ4ZU", "even...')])])}
2025-04-13 13:25:01,028 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02qiz<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb3\xe1\x00\x00\x01\x96-\x9b\xb3\xe1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00J9YJ4ZU", "even...')])])
2025-04-13 13:25:01,028 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02qiz<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb3\xe1\x00\x00\x01\x96-\x9b\xb3\xe1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00J9YJ4ZU", "even...')])])
2025-04-13 13:25:01,029 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 38 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02qiz<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb3\xe1\x00\x00\x01\x96-\x9b\xb3\xe1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00J9YJ4ZU", "even...')])])
2025-04-13 13:25:01,030 - DEBUG - Timeouts: user 0.000000, metadata 283252.712891, idle connection 520979.000000, request 29999.747038
2025-04-13 13:25:01,030 - DEBUG - Timeouts: user 9999999989.997864, metadata 283251.678955, idle connection 520978.000000, request 29998.916864
2025-04-13 13:25:01,046 - DEBUG - Received correlation id: 38
2025-04-13 13:25:01,046 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:01,046 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 38 (17.64512062072754 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=34, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:01,046 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=34, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:01,046 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 34 log start offset 0.
2025-04-13 13:25:01,047 - DEBUG - Timeouts: user 9999999989.996910, metadata 283234.886963, idle connection 520961.000000, request inf
2025-04-13 13:25:01,047 - INFO - Sent to Kafka (interactions): {'book_id': 'B00J9YJ4ZU', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:01.025164'}
2025-04-13 13:25:01,047 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.35, 'timestamp': '2025-04-13T13:25:01.047269'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:01,047 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:01,047 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:01,047 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:01,047 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:01,047 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:01,047 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xfc\xd0\'.\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb3\xf7\x00\x00\x01\x96-\x9b\xb3\xf7\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:25:01,047 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xfc\xd0\'.\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb3\xf7\x00\x00\x01\x96-\x9b\xb3\xf7\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:01,047 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xfc\xd0\'.\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb3\xf7\x00\x00\x01\x96-\x9b\xb3\xf7\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:01,047 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 39 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xfc\xd0\'.\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xb3\xf7\x00\x00\x01\x96-\x9b\xb3\xf7\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:01,047 - DEBUG - Timeouts: user 0.000000, metadata 283233.951904, idle connection 520960.000000, request 29999.987841
2025-04-13 13:25:01,048 - DEBUG - Timeouts: user 9999999989.997864, metadata 283233.835938, idle connection 520960.000000, request 29999.873877
2025-04-13 13:25:01,049 - DEBUG - Received correlation id: 39
2025-04-13 13:25:01,049 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:01,049 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 39 (1.7709732055664062 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=38, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:01,049 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=38, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:01,049 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 38 log start offset 0.
2025-04-13 13:25:01,049 - DEBUG - Timeouts: user 9999999989.996910, metadata 283231.990967, idle connection 520958.000000, request inf
2025-04-13 13:25:01,050 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.35, 'timestamp': '2025-04-13T13:25:01.047269'}
2025-04-13 13:25:04,393 - INFO - Updated book B00IWTKY16 with hover
2025-04-13 13:25:04,393 - DEBUG - Sending (key=None value={'book_id': 'B00IWTKY16', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:04.393362'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:04,393 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:04,393 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:04,393 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:04,394 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:04,394 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:04,394 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02SJ\xe7\xb0\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\t\x00\x00\x01\x96-\x9b\xc1\t\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00IWTKY16", "even...')])])}
2025-04-13 13:25:04,394 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02SJ\xe7\xb0\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\t\x00\x00\x01\x96-\x9b\xc1\t\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00IWTKY16", "even...')])])
2025-04-13 13:25:04,394 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02SJ\xe7\xb0\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\t\x00\x00\x01\x96-\x9b\xc1\t\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00IWTKY16", "even...')])])
2025-04-13 13:25:04,394 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 40 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02SJ\xe7\xb0\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\t\x00\x00\x01\x96-\x9b\xc1\t\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00IWTKY16", "even...')])])
2025-04-13 13:25:04,395 - DEBUG - Timeouts: user 0.000000, metadata 279886.866943, idle connection 517613.000000, request 29999.975920
2025-04-13 13:25:04,395 - DEBUG - Timeouts: user 9999999989.996910, metadata 279886.630859, idle connection 517613.000000, request 29999.747038
2025-04-13 13:25:04,400 - DEBUG - Received correlation id: 40
2025-04-13 13:25:04,400 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:04,400 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 40 (5.5408477783203125 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=35, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:04,400 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=35, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:04,400 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 35 log start offset 0.
2025-04-13 13:25:04,400 - DEBUG - Timeouts: user 9999999989.994764, metadata 279881.025879, idle connection 517607.000000, request inf
2025-04-13 13:25:04,400 - INFO - Sent to Kafka (interactions): {'book_id': 'B00IWTKY16', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:04.393362'}
2025-04-13 13:25:04,401 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.35, 'timestamp': '2025-04-13T13:25:04.401026'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:04,401 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:04,401 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:04,401 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:04,401 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:04,401 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:04,401 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xe3Y?<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\x11\x00\x00\x01\x96-\x9b\xc1\x11\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:25:04,401 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xe3Y?<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\x11\x00\x00\x01\x96-\x9b\xc1\x11\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:04,401 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xe3Y?<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\x11\x00\x00\x01\x96-\x9b\xc1\x11\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:04,401 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 41 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xe3Y?<\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\x11\x00\x00\x01\x96-\x9b\xc1\x11\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:04,401 - DEBUG - Timeouts: user 0.000000, metadata 279880.051758, idle connection 517606.000000, request 29999.981880
2025-04-13 13:25:04,402 - DEBUG - Timeouts: user 9999999989.996910, metadata 279879.838867, idle connection 517606.000000, request 29999.770880
2025-04-13 13:25:04,410 - DEBUG - Received correlation id: 41
2025-04-13 13:25:04,411 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:04,411 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 41 (9.249210357666016 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=39, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:04,411 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=39, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:04,411 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 39 log start offset 0.
2025-04-13 13:25:04,411 - DEBUG - Timeouts: user 9999999989.994764, metadata 279870.377930, idle connection 517596.000000, request inf
2025-04-13 13:25:04,411 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.35, 'timestamp': '2025-04-13T13:25:04.401026'}
2025-04-13 13:25:04,630 - INFO - Updated book B00IWTKY16 with hover
2025-04-13 13:25:04,631 - DEBUG - Sending (key=None value={'book_id': 'B00IWTKY16', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:04.631314'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:04,631 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:04,631 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:04,632 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:04,632 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:04,632 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:04,632 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xff\x01#$\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\xf7\x00\x00\x01\x96-\x9b\xc1\xf7\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00IWTKY16", "even...')])])}
2025-04-13 13:25:04,632 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xff\x01#$\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\xf7\x00\x00\x01\x96-\x9b\xc1\xf7\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00IWTKY16", "even...')])])
2025-04-13 13:25:04,632 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xff\x01#$\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\xf7\x00\x00\x01\x96-\x9b\xc1\xf7\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00IWTKY16", "even...')])])
2025-04-13 13:25:04,632 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 42 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xff\x01#$\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\xf7\x00\x00\x01\x96-\x9b\xc1\xf7\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00IWTKY16", "even...')])])
2025-04-13 13:25:04,633 - DEBUG - Timeouts: user 0.000000, metadata 279648.833008, idle connection 517375.000000, request 29999.979019
2025-04-13 13:25:04,633 - DEBUG - Timeouts: user 9999999989.997864, metadata 279648.614014, idle connection 517375.000000, request 29999.765158
2025-04-13 13:25:04,635 - DEBUG - Received correlation id: 42
2025-04-13 13:25:04,635 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:04,635 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 42 (2.501964569091797 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=36, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:04,635 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=36, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:04,636 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 36 log start offset 0.
2025-04-13 13:25:04,636 - DEBUG - Timeouts: user 9999999989.994287, metadata 279645.508789, idle connection 517372.000000, request inf
2025-04-13 13:25:04,636 - INFO - Sent to Kafka (interactions): {'book_id': 'B00IWTKY16', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:04.631314'}
2025-04-13 13:25:04,636 - DEBUG - Sending (key=None value={'total_recommendations': 20, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.35, 'timestamp': '2025-04-13T13:25:04.636660'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:04,636 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:04,636 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:04,637 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:04,637 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:04,637 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xa8\x03\xbd\x94\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\xfc\x00\x00\x01\x96-\x9b\xc1\xfc\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])}
2025-04-13 13:25:04,637 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:04,637 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xa8\x03\xbd\x94\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\xfc\x00\x00\x01\x96-\x9b\xc1\xfc\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:04,637 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xa8\x03\xbd\x94\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\xfc\x00\x00\x01\x96-\x9b\xc1\xfc\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:04,637 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 43 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x02\xa8\x03\xbd\x94\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc1\xfc\x00\x00\x01\x96-\x9b\xc1\xfc\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x96\x02\x00\x00\x00\x01\x88\x02{"total_recommendations": 20, "...')])])
2025-04-13 13:25:04,637 - DEBUG - Timeouts: user 0.000000, metadata 279644.025146, idle connection 517370.000000, request 29999.977112
2025-04-13 13:25:04,638 - DEBUG - Timeouts: user 9999999989.996910, metadata 279643.764893, idle connection 517370.000000, request 29999.722004
2025-04-13 13:25:04,645 - DEBUG - Received correlation id: 43
2025-04-13 13:25:04,645 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:04,645 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 43 (7.63702392578125 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=40, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:04,645 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=40, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:04,645 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 40 log start offset 0.
2025-04-13 13:25:04,645 - DEBUG - Timeouts: user 9999999989.993811, metadata 279635.968994, idle connection 517362.000000, request inf
2025-04-13 13:25:04,646 - INFO - Sent metrics to Kafka: {'total_recommendations': 20, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.35, 'timestamp': '2025-04-13T13:25:04.636660'}
2025-04-13 13:25:04,753 - DEBUG - Received get_recommendations with data: {'sessionClicks': ['B00G3I2NBC', 'B09TBPDL75', 'B00N4921J2', 'B09GMPT4YN', 'B004DNWRY2', 'B006AKLFF8', 'B0BK2KG1J6']}
2025-04-13 13:25:04,844 - DEBUG - Emitting recommendations: ['B0891RPWYL', 'B006X7W11K', 'B0058KR86Q', 'B09Y38DH2B', 'B07FK4F1F8', 'B01CMYBC8K', 'B084RSYCNY', 'B017RLYK1E', 'B0080I52EI', 'B00F8EYG9Y', 'B00I5KINBU', 'B0BR54R11R', 'B00452V4HM', 'B01MRVSY56', 'B00J1QAY8W', 'B07HK16NFV', 'B08PBKQDYH', 'B00LJ23DRK', 'B00B7SS7PO', 'B08D8M6HP8']
2025-04-13 13:25:04,844 - DEBUG - Sending (key=None value={'total_recommendations': 40, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.175, 'timestamp': '2025-04-13T13:25:04.844403'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:04,844 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:04,844 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:04,844 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:04,844 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:04,844 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:04,845 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xd2Ept\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc2\xcc\x00\x00\x01\x96-\x9b\xc2\xcc\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])}
2025-04-13 13:25:04,845 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xd2Ept\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc2\xcc\x00\x00\x01\x96-\x9b\xc2\xcc\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:04,845 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xd2Ept\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc2\xcc\x00\x00\x01\x96-\x9b\xc2\xcc\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:04,845 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 44 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xd2Ept\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xc2\xcc\x00\x00\x01\x96-\x9b\xc2\xcc\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:04,845 - DEBUG - Timeouts: user 0.000000, metadata 279436.571777, idle connection 517163.000000, request 29999.984026
2025-04-13 13:25:04,845 - DEBUG - Timeouts: user 9999999989.997864, metadata 279436.433838, idle connection 517163.000000, request 29999.850273
2025-04-13 13:25:04,848 - DEBUG - Received correlation id: 44
2025-04-13 13:25:04,848 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:04,848 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 44 (3.3791065216064453 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=41, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:04,848 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=41, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:04,848 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 41 log start offset 0.
2025-04-13 13:25:04,848 - DEBUG - Timeouts: user 9999999989.997149, metadata 279432.976807, idle connection 517159.000000, request inf
2025-04-13 13:25:04,849 - INFO - Sent metrics to Kafka: {'total_recommendations': 40, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.175, 'timestamp': '2025-04-13T13:25:04.844403'}
2025-04-13 13:25:04,916 - DEBUG - Returning 50000 books
2025-04-13 13:25:08,084 - INFO - Updated book B0080I52EI with hover
2025-04-13 13:25:08,085 - DEBUG - Sending (key=None value={'book_id': 'B0080I52EI', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:08.085267'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,085 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,085 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:08,085 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:08,086 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:08,086 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,086 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x89\xf4\n\xdc\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcfu\x00\x00\x01\x96-\x9b\xcfu\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])}
2025-04-13 13:25:08,086 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x89\xf4\n\xdc\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcfu\x00\x00\x01\x96-\x9b\xcfu\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])
2025-04-13 13:25:08,086 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x89\xf4\n\xdc\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcfu\x00\x00\x01\x96-\x9b\xcfu\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])
2025-04-13 13:25:08,086 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 45 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x89\xf4\n\xdc\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcfu\x00\x00\x01\x96-\x9b\xcfu\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])
2025-04-13 13:25:08,087 - DEBUG - Timeouts: user 0.000000, metadata 276194.856934, idle connection 513921.000000, request 29999.970913
2025-04-13 13:25:08,087 - DEBUG - Timeouts: user 9999999989.996910, metadata 276194.534668, idle connection 513921.000000, request 29999.659061
2025-04-13 13:25:08,092 - DEBUG - Received correlation id: 45
2025-04-13 13:25:08,092 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:08,092 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 45 (5.367040634155273 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=37, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,092 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=37, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,092 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 37 log start offset 0.
2025-04-13 13:25:08,092 - DEBUG - Timeouts: user 9999999989.996910, metadata 276189.175049, idle connection 513915.000000, request inf
2025-04-13 13:25:08,092 - INFO - Sent to Kafka (interactions): {'book_id': 'B0080I52EI', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:08.085267'}
2025-04-13 13:25:08,092 - DEBUG - Sending (key=None value={'total_recommendations': 40, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.175, 'timestamp': '2025-04-13T13:25:08.092912'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,093 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,093 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:08,093 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:08,093 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:08,093 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xcf\xef$9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf}\x00\x00\x01\x96-\x9b\xcf}\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])}
2025-04-13 13:25:08,093 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xcf\xef$9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf}\x00\x00\x01\x96-\x9b\xcf}\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,093 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xcf\xef$9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf}\x00\x00\x01\x96-\x9b\xcf}\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,094 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 46 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xcf\xef$9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf}\x00\x00\x01\x96-\x9b\xcf}\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,094 - DEBUG - Timeouts: user 0.000000, metadata 276187.772949, idle connection 513914.000000, request 29999.978065
2025-04-13 13:25:08,094 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,094 - DEBUG - Timeouts: user 9999999989.995241, metadata 276187.313721, idle connection 513913.000000, request 29999.520063
2025-04-13 13:25:08,101 - DEBUG - Received correlation id: 46
2025-04-13 13:25:08,101 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:08,101 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 46 (7.173061370849609 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=42, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,101 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=42, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,101 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 42 log start offset 0.
2025-04-13 13:25:08,101 - DEBUG - Timeouts: user 9999999989.996910, metadata 276180.179932, idle connection 513906.000000, request inf
2025-04-13 13:25:08,101 - INFO - Sent metrics to Kafka: {'total_recommendations': 40, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.175, 'timestamp': '2025-04-13T13:25:08.092912'}
2025-04-13 13:25:08,215 - INFO - Updated book B0080I52EI with hover
2025-04-13 13:25:08,216 - DEBUG - Sending (key=None value={'book_id': 'B0080I52EI', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:08.216208'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,216 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,216 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:08,216 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:08,217 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:08,217 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,217 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xa0D\xe9\x89\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf\xf8\x00\x00\x01\x96-\x9b\xcf\xf8\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])}
2025-04-13 13:25:08,217 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xa0D\xe9\x89\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf\xf8\x00\x00\x01\x96-\x9b\xcf\xf8\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])
2025-04-13 13:25:08,217 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xa0D\xe9\x89\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf\xf8\x00\x00\x01\x96-\x9b\xcf\xf8\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])
2025-04-13 13:25:08,217 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 47 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xa0D\xe9\x89\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf\xf8\x00\x00\x01\x96-\x9b\xcf\xf8\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])
2025-04-13 13:25:08,217 - DEBUG - Timeouts: user 0.000000, metadata 276063.981934, idle connection 513790.000000, request 29999.971867
2025-04-13 13:25:08,218 - DEBUG - Timeouts: user 9999999989.995003, metadata 276063.686768, idle connection 513790.000000, request 29999.682903
2025-04-13 13:25:08,220 - DEBUG - Received correlation id: 47
2025-04-13 13:25:08,220 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:08,220 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 47 (2.9680728912353516 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=38, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,221 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=38, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,221 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 38 log start offset 0.
2025-04-13 13:25:08,221 - DEBUG - Timeouts: user 9999999989.994287, metadata 276060.420654, idle connection 513787.000000, request inf
2025-04-13 13:25:08,221 - INFO - Sent to Kafka (interactions): {'book_id': 'B0080I52EI', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:08.216208'}
2025-04-13 13:25:08,221 - DEBUG - Sending (key=None value={'total_recommendations': 40, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.175, 'timestamp': '2025-04-13T13:25:08.221844'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,222 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,222 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:08,222 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:08,222 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:08,222 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,222 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02[(\xcer\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf\xfe\x00\x00\x01\x96-\x9b\xcf\xfe\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])}
2025-04-13 13:25:08,222 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02[(\xcer\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf\xfe\x00\x00\x01\x96-\x9b\xcf\xfe\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,223 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02[(\xcer\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf\xfe\x00\x00\x01\x96-\x9b\xcf\xfe\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,223 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 48 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02[(\xcer\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xcf\xfe\x00\x00\x01\x96-\x9b\xcf\xfe\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,223 - DEBUG - Timeouts: user 0.000000, metadata 276058.715820, idle connection 513785.000000, request 29999.984741
2025-04-13 13:25:08,223 - DEBUG - Timeouts: user 9999999989.997864, metadata 276058.562988, idle connection 513785.000000, request 29999.834776
2025-04-13 13:25:08,225 - DEBUG - Received correlation id: 48
2025-04-13 13:25:08,225 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:08,225 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 48 (2.7472972869873047 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=43, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,226 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=43, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,226 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 43 log start offset 0.
2025-04-13 13:25:08,226 - DEBUG - Timeouts: user 9999999989.995718, metadata 276055.541992, idle connection 513782.000000, request inf
2025-04-13 13:25:08,226 - INFO - Sent metrics to Kafka: {'total_recommendations': 40, 'total_clicks': 7, 'clicks_on_recommended': 7, 'ctr': 0.175, 'timestamp': '2025-04-13T13:25:08.221844'}
2025-04-13 13:25:08,236 - INFO - Updated book B0080I52EI with click
2025-04-13 13:25:08,237 - DEBUG - Sending (key=None value={'book_id': 'B0080I52EI', 'event_type': 'click', 'timestamp': '2025-04-13T13:25:08.236984'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,237 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,237 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:08,237 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:08,237 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:08,237 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,237 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xef$\xbd^\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd0\r\x00\x00\x01\x96-\x9b\xd0\r\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])}
2025-04-13 13:25:08,237 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xef$\xbd^\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd0\r\x00\x00\x01\x96-\x9b\xd0\r\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])
2025-04-13 13:25:08,237 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xef$\xbd^\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd0\r\x00\x00\x01\x96-\x9b\xd0\r\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])
2025-04-13 13:25:08,237 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 49 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xef$\xbd^\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd0\r\x00\x00\x01\x96-\x9b\xd0\r\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B0080I52EI", "even...')])])
2025-04-13 13:25:08,237 - DEBUG - Timeouts: user 0.000000, metadata 276044.057861, idle connection 513770.000000, request 29999.986887
2025-04-13 13:25:08,238 - DEBUG - Timeouts: user 9999999989.999294, metadata 276043.919678, idle connection 513770.000000, request 29999.851942
2025-04-13 13:25:08,242 - DEBUG - Received correlation id: 49
2025-04-13 13:25:08,242 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:08,243 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 49 (5.157232284545898 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=39, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,243 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=39, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,243 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 39 log start offset 0.
2025-04-13 13:25:08,243 - DEBUG - Timeouts: user 9999999989.994287, metadata 276038.480957, idle connection 513765.000000, request inf
2025-04-13 13:25:08,243 - INFO - Sent to Kafka (interactions): {'book_id': 'B0080I52EI', 'event_type': 'click', 'timestamp': '2025-04-13T13:25:08.236984'}
2025-04-13 13:25:08,243 - DEBUG - Sending (key=None value={'total_recommendations': 40, 'total_clicks': 8, 'clicks_on_recommended': 8, 'ctr': 0.2, 'timestamp': '2025-04-13T13:25:08.243617'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,243 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,243 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:08,243 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:08,243 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:08,244 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xb1k\x8c\xa8\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd0\x13\x00\x00\x01\x96-\x9b\xd0\x13\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 40, "...')])])}
2025-04-13 13:25:08,244 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,244 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xb1k\x8c\xa8\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd0\x13\x00\x00\x01\x96-\x9b\xd0\x13\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,244 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xb1k\x8c\xa8\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd0\x13\x00\x00\x01\x96-\x9b\xd0\x13\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,244 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 50 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbd\x00\x00\x00\x00\x02\xb1k\x8c\xa8\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd0\x13\x00\x00\x01\x96-\x9b\xd0\x13\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x94\x02\x00\x00\x00\x01\x86\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,244 - DEBUG - Timeouts: user 0.000000, metadata 276037.480713, idle connection 513764.000000, request 29999.984026
2025-04-13 13:25:08,244 - DEBUG - Timeouts: user 9999999989.998102, metadata 276037.333984, idle connection 513763.000000, request 29999.840021
2025-04-13 13:25:08,247 - DEBUG - Received correlation id: 50
2025-04-13 13:25:08,247 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:08,247 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 50 (3.0968189239501953 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=44, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,247 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=44, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,247 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 44 log start offset 0.
2025-04-13 13:25:08,247 - DEBUG - Timeouts: user 9999999989.997149, metadata 276034.201172, idle connection 513760.000000, request inf
2025-04-13 13:25:08,247 - INFO - Sent metrics to Kafka: {'total_recommendations': 40, 'total_clicks': 8, 'clicks_on_recommended': 8, 'ctr': 0.2, 'timestamp': '2025-04-13T13:25:08.243617'}
2025-04-13 13:25:08,249 - DEBUG - Returning click history with 22 entries
2025-04-13 13:25:08,697 - INFO - Updated book B00452V4HM with click
2025-04-13 13:25:08,698 - DEBUG - Sending (key=None value={'book_id': 'B00452V4HM', 'event_type': 'click', 'timestamp': '2025-04-13T13:25:08.698226'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,698 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,698 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:08,698 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:08,698 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,699 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:08,699 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x04\xbb\xb39\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xda\x00\x00\x01\x96-\x9b\xd1\xda\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00452V4HM", "even...')])])}
2025-04-13 13:25:08,699 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x04\xbb\xb39\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xda\x00\x00\x01\x96-\x9b\xd1\xda\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00452V4HM", "even...')])])
2025-04-13 13:25:08,699 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x04\xbb\xb39\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xda\x00\x00\x01\x96-\x9b\xd1\xda\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00452V4HM", "even...')])])
2025-04-13 13:25:08,699 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 51 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x04\xbb\xb39\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xda\x00\x00\x01\x96-\x9b\xd1\xda\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00452V4HM", "even...')])])
2025-04-13 13:25:08,699 - DEBUG - Timeouts: user 0.000000, metadata 275582.213867, idle connection 513308.000000, request 29999.978065
2025-04-13 13:25:08,699 - DEBUG - Timeouts: user 9999999989.996910, metadata 275582.009033, idle connection 513308.000000, request 29999.779224
2025-04-13 13:25:08,707 - DEBUG - Received correlation id: 51
2025-04-13 13:25:08,708 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:08,708 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 51 (8.845806121826172 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=40, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,708 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=40, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,708 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 40 log start offset 0.
2025-04-13 13:25:08,709 - DEBUG - Timeouts: user 9999999989.995003, metadata 275572.903809, idle connection 513299.000000, request inf
2025-04-13 13:25:08,709 - INFO - Sent to Kafka (interactions): {'book_id': 'B00452V4HM', 'event_type': 'click', 'timestamp': '2025-04-13T13:25:08.698226'}
2025-04-13 13:25:08,709 - DEBUG - Sending (key=None value={'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:25:08.709192'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,709 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,709 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:08,709 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:08,709 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:08,709 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,709 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02S\xc3\x93=\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xe5\x00\x00\x01\x96-\x9b\xd1\xe5\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])}
2025-04-13 13:25:08,709 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02S\xc3\x93=\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xe5\x00\x00\x01\x96-\x9b\xd1\xe5\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,709 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02S\xc3\x93=\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xe5\x00\x00\x01\x96-\x9b\xd1\xe5\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,710 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 52 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02S\xc3\x93=\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xe5\x00\x00\x01\x96-\x9b\xd1\xe5\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,710 - DEBUG - Timeouts: user 0.000000, metadata 275571.774902, idle connection 513298.000000, request 29999.983072
2025-04-13 13:25:08,710 - DEBUG - Timeouts: user 9999999989.995003, metadata 275571.357910, idle connection 513297.000000, request 29999.567032
2025-04-13 13:25:08,715 - DEBUG - Received correlation id: 52
2025-04-13 13:25:08,715 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:08,715 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 52 (5.053997039794922 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=45, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,715 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=45, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,715 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 45 log start offset 0.
2025-04-13 13:25:08,715 - DEBUG - Timeouts: user 9999999989.994764, metadata 275566.428955, idle connection 513293.000000, request inf
2025-04-13 13:25:08,715 - INFO - Sent metrics to Kafka: {'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:25:08.709192'}
2025-04-13 13:25:08,718 - DEBUG - Returning click history with 23 entries
2025-04-13 13:25:08,721 - INFO - Updated book B00452V4HM with hover
2025-04-13 13:25:08,721 - DEBUG - Sending (key=None value={'book_id': 'B00452V4HM', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:08.721421'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,721 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,721 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:08,721 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:08,721 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:08,722 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:08,722 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xc9\x01I\t\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xf1\x00\x00\x01\x96-\x9b\xd1\xf1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00452V4HM", "even...')])])}
2025-04-13 13:25:08,722 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xc9\x01I\t\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xf1\x00\x00\x01\x96-\x9b\xd1\xf1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00452V4HM", "even...')])])
2025-04-13 13:25:08,722 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xc9\x01I\t\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xf1\x00\x00\x01\x96-\x9b\xd1\xf1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00452V4HM", "even...')])])
2025-04-13 13:25:08,722 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 53 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xc9\x01I\t\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xf1\x00\x00\x01\x96-\x9b\xd1\xf1\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B00452V4HM", "even...')])])
2025-04-13 13:25:08,722 - DEBUG - Timeouts: user 0.000000, metadata 275559.224121, idle connection 513285.000000, request 29999.979734
2025-04-13 13:25:08,722 - DEBUG - Timeouts: user 9999999989.997864, metadata 275559.026855, idle connection 513285.000000, request 29999.787092
2025-04-13 13:25:08,728 - DEBUG - Received correlation id: 53
2025-04-13 13:25:08,728 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:08,728 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 53 (6.072998046875 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=41, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,728 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=41, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,728 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 41 log start offset 0.
2025-04-13 13:25:08,729 - DEBUG - Timeouts: user 9999999989.992857, metadata 275552.841797, idle connection 513279.000000, request inf
2025-04-13 13:25:08,729 - INFO - Sent to Kafka (interactions): {'book_id': 'B00452V4HM', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:08.721421'}
2025-04-13 13:25:08,729 - DEBUG - Sending (key=None value={'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:25:08.729303'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,729 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,729 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:08,729 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:08,729 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:08,729 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02f"\xb4\\\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xf9\x00\x00\x01\x96-\x9b\xd1\xf9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])}
2025-04-13 13:25:08,729 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:08,730 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02f"\xb4\\\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xf9\x00\x00\x01\x96-\x9b\xd1\xf9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,730 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02f"\xb4\\\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xf9\x00\x00\x01\x96-\x9b\xd1\xf9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,730 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 54 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02f"\xb4\\\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd1\xf9\x00\x00\x01\x96-\x9b\xd1\xf9\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:08,730 - DEBUG - Timeouts: user 0.000000, metadata 275551.567871, idle connection 513278.000000, request 29999.982119
2025-04-13 13:25:08,730 - DEBUG - Timeouts: user 9999999989.997864, metadata 275551.388916, idle connection 513277.000000, request 29999.807358
2025-04-13 13:25:08,735 - DEBUG - Received correlation id: 54
2025-04-13 13:25:08,736 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:08,736 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 54 (5.70988655090332 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=46, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,736 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=46, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:08,736 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 46 log start offset 0.
2025-04-13 13:25:08,736 - DEBUG - Timeouts: user 9999999989.997149, metadata 275545.594238, idle connection 513272.000000, request inf
2025-04-13 13:25:08,736 - INFO - Sent metrics to Kafka: {'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:25:08.729303'}
2025-04-13 13:25:09,015 - INFO - Updated book B09Y38DH2B with hover
2025-04-13 13:25:09,016 - DEBUG - Sending (key=None value={'book_id': 'B09Y38DH2B', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:09.016194'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:09,016 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:09,016 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:25:09,016 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:09,016 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:09,016 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:25:09,016 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xce<S\xc9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd3\x18\x00\x00\x01\x96-\x9b\xd3\x18\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09Y38DH2B", "even...')])])}
2025-04-13 13:25:09,016 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xce<S\xc9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd3\x18\x00\x00\x01\x96-\x9b\xd3\x18\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09Y38DH2B", "even...')])])
2025-04-13 13:25:09,017 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xce<S\xc9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd3\x18\x00\x00\x01\x96-\x9b\xd3\x18\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09Y38DH2B", "even...')])])
2025-04-13 13:25:09,017 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 55 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\xce<S\xc9\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd3\x18\x00\x00\x01\x96-\x9b\xd3\x18\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B09Y38DH2B", "even...')])])
2025-04-13 13:25:09,017 - DEBUG - Timeouts: user 0.000000, metadata 275264.718994, idle connection 512991.000000, request 29999.983788
2025-04-13 13:25:09,017 - DEBUG - Timeouts: user 9999999989.996910, metadata 275264.526123, idle connection 512991.000000, request 29999.794006
2025-04-13 13:25:09,020 - DEBUG - Received correlation id: 55
2025-04-13 13:25:09,020 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:09,021 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 55 (3.871917724609375 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=42, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:09,021 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=42, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:09,021 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 42 log start offset 0.
2025-04-13 13:25:09,021 - DEBUG - Timeouts: user 9999999989.994287, metadata 275260.358887, idle connection 512986.000000, request inf
2025-04-13 13:25:09,021 - INFO - Sent to Kafka (interactions): {'book_id': 'B09Y38DH2B', 'event_type': 'hover', 'timestamp': '2025-04-13T13:25:09.016194'}
2025-04-13 13:25:09,022 - DEBUG - Sending (key=None value={'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:25:09.021909'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:09,023 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:09,023 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:25:09,023 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:25:09,023 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:25:09,023 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:25:09,023 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xaa\xff.\xce\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd3\x1f\x00\x00\x01\x96-\x9b\xd3\x1f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])}
2025-04-13 13:25:09,024 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xaa\xff.\xce\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd3\x1f\x00\x00\x01\x96-\x9b\xd3\x1f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:09,024 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xaa\xff.\xce\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd3\x1f\x00\x00\x01\x96-\x9b\xd3\x1f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:09,024 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 56 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xaa\xff.\xce\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9b\xd3\x1f\x00\x00\x01\x96-\x9b\xd3\x1f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:25:09,024 - DEBUG - Timeouts: user 0.000000, metadata 275257.700928, idle connection 512984.000000, request 29999.985933
2025-04-13 13:25:09,024 - DEBUG - Timeouts: user 9999999989.998102, metadata 275257.562744, idle connection 512984.000000, request 29999.850988
2025-04-13 13:25:09,032 - DEBUG - Received correlation id: 56
2025-04-13 13:25:09,032 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:25:09,032 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 56 (8.214950561523438 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=47, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:09,032 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=47, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:25:09,032 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 47 log start offset 0.
2025-04-13 13:25:09,032 - DEBUG - Timeouts: user 9999999989.996910, metadata 275249.247070, idle connection 512975.000000, request inf
2025-04-13 13:25:09,032 - INFO - Sent metrics to Kafka: {'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:25:09.021909'}
2025-04-13 13:29:19,875 - INFO - Updated book B01MRVSY56 with hover
2025-04-13 13:29:19,877 - DEBUG - Sending (key=None value={'book_id': 'B01MRVSY56', 'event_type': 'hover', 'timestamp': '2025-04-13T13:29:19.876872'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:29:19,878 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:29:19,878 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:29:19,878 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:29:19,879 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:29:19,879 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:29:19,879 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x1e\x08\xb5?\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x06\x00\x00\x01\x96-\x9f\xa7\x06\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B01MRVSY56", "even...')])])}
2025-04-13 13:29:19,880 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x1e\x08\xb5?\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x06\x00\x00\x01\x96-\x9f\xa7\x06\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B01MRVSY56", "even...')])])
2025-04-13 13:29:19,880 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x1e\x08\xb5?\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x06\x00\x00\x01\x96-\x9f\xa7\x06\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B01MRVSY56", "even...')])])
2025-04-13 13:29:19,880 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 57 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02\x1e\x08\xb5?\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x06\x00\x00\x01\x96-\x9f\xa7\x06\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B01MRVSY56", "even...')])])
2025-04-13 13:29:19,880 - DEBUG - Timeouts: user 0.000000, metadata 24401.319824, idle connection 262127.000000, request 29999.958038
2025-04-13 13:29:19,880 - DEBUG - Timeouts: user 9999999989.998102, metadata 24401.008789, idle connection 262127.000000, request 29999.662161
2025-04-13 13:29:19,890 - DEBUG - Received correlation id: 57
2025-04-13 13:29:19,891 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:29:19,891 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 57 (10.509967803955078 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=43, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:19,891 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=43, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:19,891 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 43 log start offset 0.
2025-04-13 13:29:19,891 - DEBUG - Timeouts: user 9999999989.995956, metadata 24390.312012, idle connection 262116.000000, request inf
2025-04-13 13:29:19,891 - INFO - Sent to Kafka (interactions): {'book_id': 'B01MRVSY56', 'event_type': 'hover', 'timestamp': '2025-04-13T13:29:19.876872'}
2025-04-13 13:29:19,891 - DEBUG - Sending (key=None value={'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:29:19.891771'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:29:19,891 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:29:19,892 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:29:19,892 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:29:19,892 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:29:19,892 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02P"\xa6\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x14\x00\x00\x01\x96-\x9f\xa7\x14\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])}
2025-04-13 13:29:19,892 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02P"\xa6\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x14\x00\x00\x01\x96-\x9f\xa7\x14\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:29:19,892 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02P"\xa6\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x14\x00\x00\x01\x96-\x9f\xa7\x14\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:29:19,892 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:29:19,893 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 58 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02P"\xa6\xcd\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x14\x00\x00\x01\x96-\x9f\xa7\x14\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:29:19,893 - DEBUG - Timeouts: user 0.000000, metadata 24388.732910, idle connection 262115.000000, request 29999.979019
2025-04-13 13:29:19,893 - DEBUG - Timeouts: user 9999999989.998102, metadata 24388.524902, idle connection 262115.000000, request 29999.777079
2025-04-13 13:29:19,897 - DEBUG - Received correlation id: 58
2025-04-13 13:29:19,898 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:29:19,898 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 58 (4.988908767700195 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=48, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:19,898 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=48, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:19,898 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 48 log start offset 0.
2025-04-13 13:29:19,898 - DEBUG - Timeouts: user 9999999989.995956, metadata 24383.452881, idle connection 262110.000000, request inf
2025-04-13 13:29:19,898 - INFO - Sent metrics to Kafka: {'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:29:19.891771'}
2025-04-13 13:29:20,006 - INFO - Updated book B07FK4F1F8 with hover
2025-04-13 13:29:20,007 - DEBUG - Sending (key=None value={'book_id': 'B07FK4F1F8', 'event_type': 'hover', 'timestamp': '2025-04-13T13:29:20.007058'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:29:20,007 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:29:20,007 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:29:20,007 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:29:20,007 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:29:20,007 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\x8e\xd2&\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x87\x00\x00\x01\x96-\x9f\xa7\x87\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B07FK4F1F8", "even...')])])}
2025-04-13 13:29:20,007 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\x8e\xd2&\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x87\x00\x00\x01\x96-\x9f\xa7\x87\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B07FK4F1F8", "even...')])])
2025-04-13 13:29:20,007 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\x8e\xd2&\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x87\x00\x00\x01\x96-\x9f\xa7\x87\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B07FK4F1F8", "even...')])])
2025-04-13 13:29:20,007 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:29:20,008 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 59 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\x8e\xd2&\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x87\x00\x00\x01\x96-\x9f\xa7\x87\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B07FK4F1F8", "even...')])])
2025-04-13 13:29:20,008 - DEBUG - Timeouts: user 0.000000, metadata 24273.750977, idle connection 262000.000000, request 29999.985933
2025-04-13 13:29:20,008 - DEBUG - Timeouts: user 9999999989.997864, metadata 24273.598877, idle connection 262000.000000, request 29999.836922
2025-04-13 13:29:20,010 - DEBUG - Received correlation id: 59
2025-04-13 13:29:20,010 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:29:20,010 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 59 (2.2208690643310547 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=44, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:20,010 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=44, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:20,010 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 44 log start offset 0.
2025-04-13 13:29:20,010 - DEBUG - Timeouts: user 9999999989.997149, metadata 24271.230957, idle connection 261997.000000, request inf
2025-04-13 13:29:20,010 - INFO - Sent to Kafka (interactions): {'book_id': 'B07FK4F1F8', 'event_type': 'hover', 'timestamp': '2025-04-13T13:29:20.007058'}
2025-04-13 13:29:20,010 - DEBUG - Sending (key=None value={'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:29:20.010908'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:29:20,011 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:29:20,011 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:29:20,011 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:29:20,011 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:29:20,011 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xd7\x97\x07{\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x8b\x00\x00\x01\x96-\x9f\xa7\x8b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])}
2025-04-13 13:29:20,011 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:29:20,011 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xd7\x97\x07{\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x8b\x00\x00\x01\x96-\x9f\xa7\x8b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:29:20,011 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xd7\x97\x07{\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x8b\x00\x00\x01\x96-\x9f\xa7\x8b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:29:20,012 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 60 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02\xd7\x97\x07{\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xa7\x8b\x00\x00\x01\x96-\x9f\xa7\x8b\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:29:20,012 - DEBUG - Timeouts: user 0.000000, metadata 24269.839111, idle connection 261996.000000, request 29999.981880
2025-04-13 13:29:20,012 - DEBUG - Timeouts: user 9999999989.997864, metadata 24269.687988, idle connection 261996.000000, request 29999.834776
2025-04-13 13:29:20,014 - DEBUG - Received correlation id: 60
2025-04-13 13:29:20,014 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:29:20,014 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 60 (2.2640228271484375 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=49, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:20,014 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=49, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:20,014 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 49 log start offset 0.
2025-04-13 13:29:20,014 - DEBUG - Timeouts: user 9999999989.993811, metadata 24267.157959, idle connection 261993.000000, request inf
2025-04-13 13:29:20,014 - INFO - Sent metrics to Kafka: {'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:29:20.010908'}
2025-04-13 13:29:21,684 - INFO - Updated book B07FK4F1F8 with hover
2025-04-13 13:29:21,685 - DEBUG - Sending (key=None value={'book_id': 'B07FK4F1F8', 'event_type': 'hover', 'timestamp': '2025-04-13T13:29:21.685550'} headers=[]) to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:29:21,685 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:29:21,686 - DEBUG - Waking up the sender since TopicPartition(topic='user_interactions', partition=0) is either full or getting a new batch
2025-04-13 13:29:21,686 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:29:21,686 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:29:21,686 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\x1b\xcb\x18\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xae\x16\x00\x00\x01\x96-\x9f\xae\x16\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B07FK4F1F8", "even...')])])}
2025-04-13 13:29:21,686 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\x1b\xcb\x18\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xae\x16\x00\x00\x01\x96-\x9f\xae\x16\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B07FK4F1F8", "even...')])])
2025-04-13 13:29:21,686 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\x1b\xcb\x18\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xae\x16\x00\x00\x01\x96-\x9f\xae\x16\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B07FK4F1F8", "even...')])])
2025-04-13 13:29:21,686 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 61 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='user_interactions', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x95\x00\x00\x00\x00\x02v\x1b\xcb\x18\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xae\x16\x00\x00\x01\x96-\x9f\xae\x16\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\xc4\x01\x00\x00\x00\x01\xb6\x01{"book_id": "B07FK4F1F8", "even...')])])
2025-04-13 13:29:21,686 - DEBUG - Waiting on produce to TopicPartition(topic='user_interactions', partition=0)
2025-04-13 13:29:21,686 - DEBUG - Timeouts: user 0.000000, metadata 22595.055664, idle connection 260321.000000, request 29999.979019
2025-04-13 13:29:21,687 - DEBUG - Timeouts: user 9999999989.996910, metadata 22594.770020, idle connection 260321.000000, request 29999.699354
2025-04-13 13:29:21,690 - DEBUG - Received correlation id: 61
2025-04-13 13:29:21,690 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:29:21,690 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 61 (4.086732864379883 ms): ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=45, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:21,691 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='user_interactions', partitions=[(partition=0, error_code=0, offset=45, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:21,691 - DEBUG - Produced messages to topic-partition TopicPartition(topic='user_interactions', partition=0) with base offset 45 log start offset 0.
2025-04-13 13:29:21,691 - DEBUG - Timeouts: user 9999999989.989996, metadata 22590.356934, idle connection 260316.000000, request inf
2025-04-13 13:29:21,693 - INFO - Sent to Kafka (interactions): {'book_id': 'B07FK4F1F8', 'event_type': 'hover', 'timestamp': '2025-04-13T13:29:21.685550'}
2025-04-13 13:29:21,693 - DEBUG - Sending (key=None value={'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:29:21.693284'} headers=[]) to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:29:21,693 - DEBUG - Allocating a new 16384 byte message buffer for TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:29:21,693 - DEBUG - Waking up the sender since TopicPartition(topic='metrics_topic', partition=0) is either full or getting a new batch
2025-04-13 13:29:21,693 - DEBUG - Flushing accumulated records in producer.
2025-04-13 13:29:21,693 - DEBUG - Waiting on produce to TopicPartition(topic='metrics_topic', partition=0)
2025-04-13 13:29:21,694 - DEBUG - Nodes with data ready to send: {1}
2025-04-13 13:29:21,694 - DEBUG - Created 1 produce requests: {1: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02Q\xd2\x17\x13\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xae\x1d\x00\x00\x01\x96-\x9f\xae\x1d\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])}
2025-04-13 13:29:21,694 - DEBUG - Sending Produce Request: ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02Q\xd2\x17\x13\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xae\x1d\x00\x00\x01\x96-\x9f\xae\x1d\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:29:21,694 - DEBUG - Sending request ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02Q\xd2\x17\x13\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xae\x1d\x00\x00\x01\x96-\x9f\xae\x1d\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:29:21,694 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 62 (timeout_ms 30000): ProduceRequest_v7(transactional_id=None, required_acks=1, timeout=30000, topics=[(topic='metrics_topic', partitions=[(partition=0, records=b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x02Q\xd2\x17\x13\x00\x00\x00\x00\x00\x00\x00\x00\x01\x96-\x9f\xae\x1d\x00\x00\x01\x96-\x9f\xae\x1d\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x01\x98\x02\x00\x00\x00\x01\x8a\x02{"total_recommendations": 40, "...')])])
2025-04-13 13:29:21,694 - DEBUG - Timeouts: user 0.000000, metadata 22587.410889, idle connection 260314.000000, request 29999.987364
2025-04-13 13:29:21,694 - DEBUG - Timeouts: user 9999999989.998817, metadata 22587.291992, idle connection 260313.000000, request 29999.870300
2025-04-13 13:29:21,696 - DEBUG - Received correlation id: 62
2025-04-13 13:29:21,696 - DEBUG - Processing response ProduceResponse_v7
2025-04-13 13:29:21,696 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 62 (2.249002456665039 ms): ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=50, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:21,696 - DEBUG - Parsing produce response: ProduceResponse_v7(topics=[(topic='metrics_topic', partitions=[(partition=0, error_code=0, offset=50, timestamp=-1, log_start_offset=0)])], throttle_time_ms=0)
2025-04-13 13:29:21,696 - DEBUG - Produced messages to topic-partition TopicPartition(topic='metrics_topic', partition=0) with base offset 50 log start offset 0.
2025-04-13 13:29:21,696 - DEBUG - Timeouts: user 9999999989.997149, metadata 22584.954834, idle connection 260311.000000, request inf
2025-04-13 13:29:21,697 - INFO - Sent metrics to Kafka: {'total_recommendations': 40, 'total_clicks': 9, 'clicks_on_recommended': 9, 'ctr': 0.225, 'timestamp': '2025-04-13T13:29:21.693284'}
2025-04-13 13:29:44,283 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 13:29:44,286 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:29:44,286 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 63 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:29:44,286 - DEBUG - Timeouts: user 9999999986.624002, metadata 30000.000000, idle connection 237721.000000, request 29999.897003
2025-04-13 13:29:44,287 - DEBUG - Timeouts: user 9999999989.994287, metadata 30000.000000, idle connection 237721.000000, request 29999.448061
2025-04-13 13:29:44,299 - DEBUG - Received correlation id: 63
2025-04-13 13:29:44,299 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 13:29:44,299 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 63 (12.532949447631836 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 13:29:44,299 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 13:29:44,299 - DEBUG - Timeouts: user 9999999989.995956, metadata 299999.914795, idle connection 237708.000000, request inf
2025-04-13 13:33:42,012 - DEBUG - Timeouts: user 9999999989.937067, metadata 62287.218750, idle connection 302286.000000, request inf
2025-04-13 13:34:44,305 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 13:34:44,307 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:34:44,307 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 64 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:34:44,308 - DEBUG - Timeouts: user 9999999987.147331, metadata 30000.000000, idle connection 239990.000000, request 29999.884844
2025-04-13 13:34:44,309 - DEBUG - Timeouts: user 9999999989.993095, metadata 30000.000000, idle connection 239989.000000, request 29998.404980
2025-04-13 13:34:44,318 - DEBUG - Received correlation id: 64
2025-04-13 13:34:44,318 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 13:34:44,319 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 64 (11.326074600219727 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 13:34:44,320 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 13:34:44,320 - DEBUG - Timeouts: user 9999999989.991903, metadata 299999.628906, idle connection 239978.000000, request inf
2025-04-13 13:38:44,302 - DEBUG - Timeouts: user 9999999989.932775, metadata 60017.972168, idle connection 300015.000000, request inf
2025-04-13 13:39:44,326 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 13:39:44,329 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:39:44,330 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 65 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:39:44,330 - DEBUG - Timeouts: user 9999999985.058069, metadata 30000.000000, idle connection 239986.000000, request 29999.927044
2025-04-13 13:39:44,331 - DEBUG - Timeouts: user 9999999989.994764, metadata 30000.000000, idle connection 239986.000000, request 29999.364853
2025-04-13 13:39:44,334 - DEBUG - Received correlation id: 65
2025-04-13 13:39:44,334 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 13:39:44,335 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 65 (4.283905029296875 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 13:39:44,335 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 13:39:44,335 - DEBUG - Timeouts: user 9999999989.993811, metadata 299999.854736, idle connection 239981.000000, request inf
2025-04-13 13:43:44,319 - DEBUG - Timeouts: user 9999999989.961863, metadata 60016.021973, idle connection 300014.000000, request inf
2025-04-13 13:44:44,339 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 13:44:44,342 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:44:44,342 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 66 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:44:44,342 - DEBUG - Timeouts: user 9999999987.071753, metadata 30000.000000, idle connection 239991.000000, request 29999.958992
2025-04-13 13:44:44,343 - DEBUG - Timeouts: user 9999999989.998102, metadata 30000.000000, idle connection 239991.000000, request 29999.593973
2025-04-13 13:44:44,348 - DEBUG - Received correlation id: 66
2025-04-13 13:44:44,348 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 13:44:44,348 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 66 (6.288051605224609 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 13:44:44,349 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 13:44:44,349 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.902100, idle connection 239984.000000, request inf
2025-04-13 13:48:44,338 - DEBUG - Timeouts: user 9999999989.910126, metadata 60011.418945, idle connection 300010.000000, request inf
2025-04-13 13:49:44,355 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 13:49:44,356 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:49:44,357 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 67 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:49:44,357 - DEBUG - Timeouts: user 9999999986.866236, metadata 30000.000000, idle connection 239990.000000, request 29999.929905
2025-04-13 13:49:44,358 - DEBUG - Timeouts: user 9999999989.996910, metadata 30000.000000, idle connection 239990.000000, request 29999.372721
2025-04-13 13:49:44,361 - DEBUG - Received correlation id: 67
2025-04-13 13:49:44,361 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 13:49:44,361 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 67 (4.069089889526367 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 13:49:44,361 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 13:49:44,362 - DEBUG - Timeouts: user 9999999989.998102, metadata 299999.932129, idle connection 239986.000000, request inf
2025-04-13 13:53:44,352 - DEBUG - Timeouts: user 9999999989.956856, metadata 60009.328125, idle connection 300008.000000, request inf
2025-04-13 13:54:44,368 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 13:54:44,371 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:54:44,371 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 68 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:54:44,372 - DEBUG - Timeouts: user 9999999985.452890, metadata 30000.000000, idle connection 239989.000000, request 29999.942064
2025-04-13 13:54:44,372 - DEBUG - Timeouts: user 9999999989.996195, metadata 30000.000000, idle connection 239988.000000, request 29999.419212
2025-04-13 13:54:44,390 - DEBUG - Received correlation id: 68
2025-04-13 13:54:44,390 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 13:54:44,391 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 68 (19.381046295166016 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 13:54:44,393 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 13:54:44,393 - DEBUG - Timeouts: user 9999999989.995956, metadata 299999.636963, idle connection 239967.000000, request inf
2025-04-13 13:58:44,364 - DEBUG - Timeouts: user 9999999989.930868, metadata 60029.106934, idle connection 300023.000000, request inf
2025-04-13 13:59:44,398 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 13:59:44,400 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:59:44,401 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 69 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 13:59:44,401 - DEBUG - Timeouts: user 9999999986.786842, metadata 30000.000000, idle connection 239986.000000, request 29999.951124
2025-04-13 13:59:44,402 - DEBUG - Timeouts: user 9999999989.997149, metadata 30000.000000, idle connection 239985.000000, request 29999.463320
2025-04-13 13:59:44,407 - DEBUG - Received correlation id: 69
2025-04-13 13:59:44,407 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 13:59:44,407 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 69 (6.09278678894043 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 13:59:44,410 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 13:59:44,410 - DEBUG - Timeouts: user 9999999989.997149, metadata 299999.854004, idle connection 239977.000000, request inf
2025-04-13 14:03:44,391 - DEBUG - Timeouts: user 9999999989.953041, metadata 60018.770996, idle connection 300015.000000, request inf
2025-04-13 14:04:44,418 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:04:44,421 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:04:44,421 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 70 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:04:44,421 - DEBUG - Timeouts: user 9999999984.223127, metadata 30000.000000, idle connection 239984.000000, request 29999.944925
2025-04-13 14:04:44,422 - DEBUG - Timeouts: user 9999999989.995956, metadata 30000.000000, idle connection 239984.000000, request 29999.453783
2025-04-13 14:04:44,429 - DEBUG - Received correlation id: 70
2025-04-13 14:04:44,429 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:04:44,430 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 70 (8.160114288330078 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:04:44,430 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:04:44,430 - DEBUG - Timeouts: user 9999999989.995718, metadata 299999.886230, idle connection 239976.000000, request inf
2025-04-13 14:08:44,410 - DEBUG - Timeouts: user 9999999989.899874, metadata 60020.754883, idle connection 300019.000000, request inf
2025-04-13 14:09:44,434 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:09:44,436 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:09:44,436 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 71 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:09:44,436 - DEBUG - Timeouts: user 9999999987.286806, metadata 30000.000000, idle connection 239992.000000, request 29999.969959
2025-04-13 14:09:44,437 - DEBUG - Timeouts: user 9999999989.997864, metadata 30000.000000, idle connection 239992.000000, request 29999.642849
2025-04-13 14:09:44,440 - DEBUG - Received correlation id: 71
2025-04-13 14:09:44,440 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:09:44,440 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 71 (3.6020278930664062 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:09:44,440 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:09:44,440 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.924316, idle connection 239988.000000, request inf
2025-04-13 14:13:44,432 - DEBUG - Timeouts: user 9999999989.663124, metadata 60008.371094, idle connection 300007.000000, request inf
2025-04-13 14:14:44,448 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:14:44,452 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:14:44,452 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 72 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:14:44,452 - DEBUG - Timeouts: user 9999999985.099792, metadata 30000.000000, idle connection 239987.000000, request 29999.962807
2025-04-13 14:14:44,453 - DEBUG - Timeouts: user 9999999989.997864, metadata 30000.000000, idle connection 239987.000000, request 29999.609709
2025-04-13 14:14:44,456 - DEBUG - Received correlation id: 72
2025-04-13 14:14:44,456 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:14:44,456 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 72 (4.213094711303711 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:14:44,457 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:14:44,457 - DEBUG - Timeouts: user 9999999989.997864, metadata 299999.937012, idle connection 239982.000000, request inf
2025-04-13 14:18:44,442 - DEBUG - Timeouts: user 9999999989.953756, metadata 60015.000244, idle connection 300014.000000, request inf
2025-04-13 14:19:44,462 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:19:44,464 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:19:44,465 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 73 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:19:44,465 - DEBUG - Timeouts: user 9999999986.185074, metadata 30000.000000, idle connection 239990.000000, request 29999.958038
2025-04-13 14:19:44,465 - DEBUG - Timeouts: user 9999999989.997864, metadata 30000.000000, idle connection 239990.000000, request 29999.628067
2025-04-13 14:19:44,471 - DEBUG - Received correlation id: 73
2025-04-13 14:19:44,474 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:19:44,474 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 73 (9.192943572998047 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:19:44,475 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:19:44,475 - DEBUG - Timeouts: user 9999999989.995956, metadata 299999.899902, idle connection 239981.000000, request inf
2025-04-13 14:23:44,448 - DEBUG - Timeouts: user 9999999989.968061, metadata 60026.585938, idle connection 7.000000, request inf
2025-04-13 14:23:44,459 - DEBUG - Timeouts: user 9999999989.994764, metadata 60016.346924, idle connection 300011.000000, request inf
2025-04-13 14:24:44,474 - DEBUG - Timeouts: user 9999999989.979982, metadata 1.280762, idle connection 239996.000000, request inf
2025-04-13 14:24:44,481 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:24:44,481 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:24:44,482 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 74 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:24:44,482 - DEBUG - Timeouts: user 9999999988.091946, metadata 30000.000000, idle connection 239988.000000, request 29999.929905
2025-04-13 14:24:44,483 - DEBUG - Timeouts: user 9999999989.994287, metadata 30000.000000, idle connection 239987.000000, request 29999.027967
2025-04-13 14:24:44,488 - DEBUG - Received correlation id: 74
2025-04-13 14:24:44,488 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:24:44,489 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 74 (6.536960601806641 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:24:44,489 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:24:44,489 - DEBUG - Timeouts: user 9999999989.991665, metadata 299999.833008, idle connection 239981.000000, request inf
2025-04-13 14:28:44,476 - DEBUG - Timeouts: user 9999999989.929199, metadata 60014.001953, idle connection 300012.000000, request inf
2025-04-13 14:29:44,496 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:29:44,498 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:29:44,498 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 75 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:29:44,498 - DEBUG - Timeouts: user 9999999986.817360, metadata 30000.000000, idle connection 239989.000000, request 29999.966145
2025-04-13 14:29:44,499 - DEBUG - Timeouts: user 9999999989.997864, metadata 30000.000000, idle connection 239989.000000, request 29999.616861
2025-04-13 14:29:44,504 - DEBUG - Received correlation id: 75
2025-04-13 14:29:44,504 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:29:44,504 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 75 (5.530834197998047 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:29:44,505 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:29:44,505 - DEBUG - Timeouts: user 9999999989.995956, metadata 299999.742188, idle connection 239983.000000, request inf
2025-04-13 14:33:44,491 - DEBUG - Timeouts: user 9999999989.933252, metadata 60014.305176, idle connection 300013.000000, request inf
2025-04-13 14:34:44,507 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:34:44,508 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:34:44,509 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 76 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:34:44,509 - DEBUG - Timeouts: user 9999999987.976074, metadata 30000.000000, idle connection 239994.000000, request 29999.968052
2025-04-13 14:34:44,509 - DEBUG - Timeouts: user 9999999989.996910, metadata 30000.000000, idle connection 239994.000000, request 29999.591351
2025-04-13 14:34:44,517 - DEBUG - Received correlation id: 76
2025-04-13 14:34:44,517 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:34:44,517 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 76 (8.19087028503418 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:34:44,517 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:34:44,517 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.902100, idle connection 239986.000000, request inf
2025-04-13 14:38:44,506 - DEBUG - Timeouts: user 9999999989.955902, metadata 60011.946045, idle connection 300011.000000, request inf
2025-04-13 14:39:44,521 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:39:44,523 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:39:44,523 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 77 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:39:44,523 - DEBUG - Timeouts: user 9999999986.684084, metadata 30000.000000, idle connection 239993.000000, request 29999.937057
2025-04-13 14:39:44,524 - DEBUG - Timeouts: user 9999999989.997149, metadata 30000.000000, idle connection 239992.000000, request 29999.270916
2025-04-13 14:39:44,527 - DEBUG - Received correlation id: 77
2025-04-13 14:39:44,527 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:39:44,527 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 77 (3.8750171661376953 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:39:44,529 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:39:44,530 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.695801, idle connection 239986.000000, request inf
2025-04-13 14:43:44,520 - DEBUG - Timeouts: user 9999999989.906073, metadata 60010.200684, idle connection 300007.000000, request inf
2025-04-13 14:44:44,536 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:44:44,538 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:44:44,539 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 78 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:44:44,540 - DEBUG - Timeouts: user 9999999985.361099, metadata 30000.000000, idle connection 239986.000000, request 29999.907017
2025-04-13 14:44:44,542 - DEBUG - Timeouts: user 9999999989.993095, metadata 30000.000000, idle connection 239984.000000, request 29998.026133
2025-04-13 14:44:44,547 - DEBUG - Received correlation id: 78
2025-04-13 14:44:44,547 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:44:44,547 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 78 (7.571935653686523 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:44:44,548 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:44:44,548 - DEBUG - Timeouts: user 9999999989.992857, metadata 299999.783203, idle connection 239978.000000, request inf
2025-04-13 14:48:44,528 - DEBUG - Timeouts: user 9999999989.969730, metadata 60020.485107, idle connection 300018.000000, request inf
2025-04-13 14:49:44,551 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:49:44,553 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:49:44,554 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 79 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:49:44,554 - DEBUG - Timeouts: user 9999999986.618042, metadata 30000.000000, idle connection 239992.000000, request 29999.933958
2025-04-13 14:49:44,554 - DEBUG - Timeouts: user 9999999989.996910, metadata 30000.000000, idle connection 239992.000000, request 29999.479055
2025-04-13 14:49:44,560 - DEBUG - Received correlation id: 79
2025-04-13 14:49:44,560 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:49:44,560 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 79 (5.997896194458008 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:49:44,561 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:49:44,561 - DEBUG - Timeouts: user 9999999989.995003, metadata 299999.833008, idle connection 239985.000000, request inf
2025-04-13 14:53:44,551 - DEBUG - Timeouts: user 9999999989.932060, metadata 60010.169922, idle connection 300008.000000, request inf
2025-04-13 14:54:44,567 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:54:44,567 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:54:44,568 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 80 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:54:44,568 - DEBUG - Timeouts: user 9999999988.183975, metadata 30000.000000, idle connection 239991.000000, request 29999.946833
2025-04-13 14:54:44,569 - DEBUG - Timeouts: user 9999999989.994287, metadata 30000.000000, idle connection 239990.000000, request 29998.997927
2025-04-13 14:54:44,584 - DEBUG - Received correlation id: 80
2025-04-13 14:54:44,584 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:54:44,585 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 80 (16.5860652923584 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:54:44,587 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:54:44,588 - DEBUG - Timeouts: user 9999999989.988804, metadata 299999.235840, idle connection 239971.000000, request inf
2025-04-13 14:58:44,563 - DEBUG - Timeouts: user 9999999989.916086, metadata 60025.083984, idle connection 300020.000000, request inf
2025-04-13 14:59:44,593 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 14:59:44,595 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:59:44,596 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 81 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 14:59:44,596 - DEBUG - Timeouts: user 9999999986.083031, metadata 30000.000000, idle connection 239986.000000, request 29999.920130
2025-04-13 14:59:44,597 - DEBUG - Timeouts: user 9999999989.995718, metadata 30000.000000, idle connection 239985.000000, request 29999.080181
2025-04-13 14:59:44,600 - DEBUG - Received correlation id: 81
2025-04-13 14:59:44,600 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 14:59:44,603 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 81 (6.170034408569336 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 14:59:44,603 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 14:59:44,603 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.867920, idle connection 239979.000000, request inf
2025-04-13 15:03:44,584 - DEBUG - Timeouts: user 9999999989.975929, metadata 60019.650635, idle connection 300016.000000, request inf
2025-04-13 15:04:44,607 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:04:44,611 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:04:44,611 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 82 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:04:44,611 - DEBUG - Timeouts: user 9999999984.337091, metadata 30000.000000, idle connection 239988.000000, request 29999.955177
2025-04-13 15:04:44,612 - DEBUG - Timeouts: user 9999999989.996195, metadata 30000.000000, idle connection 239987.000000, request 29999.421120
2025-04-13 15:04:44,621 - DEBUG - Received correlation id: 82
2025-04-13 15:04:44,621 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:04:44,621 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 82 (9.637832641601562 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:04:44,622 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:04:44,622 - DEBUG - Timeouts: user 9999999989.994764, metadata 299999.895996, idle connection 239978.000000, request inf
2025-04-13 15:08:44,603 - DEBUG - Timeouts: user 9999999989.919901, metadata 60019.190918, idle connection 300018.000000, request inf
2025-04-13 15:09:44,627 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:09:44,631 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:09:44,631 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 83 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:09:44,632 - DEBUG - Timeouts: user 9999999984.751225, metadata 30000.000000, idle connection 239988.000000, request 29999.927044
2025-04-13 15:09:44,633 - DEBUG - Timeouts: user 9999999989.996195, metadata 30000.000000, idle connection 239987.000000, request 29999.277115
2025-04-13 15:09:44,641 - DEBUG - Received correlation id: 83
2025-04-13 15:09:44,641 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:09:44,641 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 83 (9.282827377319336 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:09:44,642 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:09:44,642 - DEBUG - Timeouts: user 9999999989.994049, metadata 299999.850098, idle connection 239978.000000, request inf
2025-04-13 15:13:44,623 - DEBUG - Timeouts: user 9999999989.921808, metadata 60018.728027, idle connection 300017.000000, request inf
2025-04-13 15:14:44,646 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:14:44,648 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:14:44,648 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 84 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:14:44,648 - DEBUG - Timeouts: user 9999999988.338232, metadata 30000.000000, idle connection 239992.000000, request 29999.963284
2025-04-13 15:14:44,648 - DEBUG - Timeouts: user 9999999989.997149, metadata 30000.000000, idle connection 239992.000000, request 29999.544144
2025-04-13 15:14:44,653 - DEBUG - Received correlation id: 84
2025-04-13 15:14:44,653 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:14:44,653 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 84 (5.344867706298828 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:14:44,654 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:14:44,654 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.885986, idle connection 239986.000000, request inf
2025-04-13 15:18:44,646 - DEBUG - Timeouts: user 9999999989.959717, metadata 60011.577881, idle connection 300010.000000, request inf
2025-04-13 15:19:44,662 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:19:44,664 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:19:44,664 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 85 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:19:44,664 - DEBUG - Timeouts: user 9999999987.174034, metadata 30000.000000, idle connection 239988.000000, request 29999.950886
2025-04-13 15:19:44,665 - DEBUG - Timeouts: user 9999999989.994764, metadata 30000.000000, idle connection 239988.000000, request 29999.360085
2025-04-13 15:19:44,668 - DEBUG - Received correlation id: 85
2025-04-13 15:19:44,669 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:19:44,669 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 85 (4.489898681640625 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:19:44,673 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:19:44,673 - DEBUG - Timeouts: user 9999999989.996195, metadata 299999.785889, idle connection 239980.000000, request inf
2025-04-13 15:23:44,654 - DEBUG - Timeouts: user 9999999989.989996, metadata 60018.965820, idle connection 300014.000000, request inf
2025-04-13 15:24:44,676 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:24:44,678 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:24:44,679 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 86 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:24:44,679 - DEBUG - Timeouts: user 9999999987.074375, metadata 30000.000000, idle connection 239989.000000, request 29999.948025
2025-04-13 15:24:44,680 - DEBUG - Timeouts: user 9999999989.993095, metadata 30000.000000, idle connection 239988.000000, request 29999.165058
2025-04-13 15:24:44,691 - DEBUG - Received correlation id: 86
2025-04-13 15:24:44,692 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:24:44,692 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 86 (13.05079460144043 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:24:44,692 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:24:44,692 - DEBUG - Timeouts: user 9999999989.990950, metadata 299999.824951, idle connection 239975.000000, request inf
2025-04-13 15:28:44,630 - DEBUG - Timeouts: user 9999999989.961863, metadata 60062.791992, idle connection 38.000000, request inf
2025-04-13 15:28:44,671 - DEBUG - Timeouts: user 9999999989.992142, metadata 60021.462891, idle connection 300015.000000, request inf
2025-04-13 15:29:44,693 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:29:44,700 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:29:44,700 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 87 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:29:44,700 - DEBUG - Timeouts: user 9999999982.467890, metadata 30000.000000, idle connection 239986.000000, request 29999.951124
2025-04-13 15:29:44,701 - DEBUG - Timeouts: user 9999999989.992857, metadata 30000.000000, idle connection 239985.000000, request 29999.475241
2025-04-13 15:29:44,703 - DEBUG - Received correlation id: 87
2025-04-13 15:29:44,703 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:29:44,703 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 87 (2.798795700073242 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:29:44,703 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:29:44,703 - DEBUG - Timeouts: user 9999999989.997864, metadata 299999.938965, idle connection 239982.000000, request inf
2025-04-13 15:33:44,684 - DEBUG - Timeouts: user 9999999989.976168, metadata 60019.781006, idle connection 2.000000, request inf
2025-04-13 15:33:44,689 - DEBUG - Timeouts: user 9999999989.989996, metadata 60014.862061, idle connection 300014.000000, request inf
2025-04-13 15:34:44,705 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:34:44,705 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:34:44,706 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 88 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:34:44,708 - DEBUG - Timeouts: user 9999999987.848043, metadata 30000.000000, idle connection 239995.000000, request 29999.017239
2025-04-13 15:34:44,709 - DEBUG - Timeouts: user 9999999989.994049, metadata 30000.000000, idle connection 239994.000000, request 29998.100996
2025-04-13 15:34:44,718 - DEBUG - Received correlation id: 88
2025-04-13 15:34:44,718 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:34:44,718 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 88 (11.543989181518555 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:34:44,719 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:34:44,719 - DEBUG - Timeouts: user 9999999989.993811, metadata 299999.829102, idle connection 239984.000000, request inf
2025-04-13 15:38:44,703 - DEBUG - Timeouts: user 9999999989.979029, metadata 60016.031982, idle connection 0.000000, request inf
2025-04-13 15:38:44,705 - DEBUG - Timeouts: user 9999999989.992142, metadata 60013.256104, idle connection 300012.000000, request inf
2025-04-13 15:39:44,720 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:39:44,722 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:39:44,722 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 89 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:39:44,722 - DEBUG - Timeouts: user 9999999987.709999, metadata 30000.000000, idle connection 239995.000000, request 29999.974966
2025-04-13 15:39:44,722 - DEBUG - Timeouts: user 9999999989.994049, metadata 30000.000000, idle connection 239995.000000, request 29999.597788
2025-04-13 15:39:44,734 - DEBUG - Received correlation id: 89
2025-04-13 15:39:44,734 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:39:44,735 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 89 (12.702226638793945 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:39:44,735 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:39:44,736 - DEBUG - Timeouts: user 9999999989.990950, metadata 299999.690186, idle connection 239981.000000, request inf
2025-04-13 15:43:44,716 - DEBUG - Timeouts: user 9999999989.966154, metadata 60019.604980, idle connection 1.000000, request inf
2025-04-13 15:43:44,720 - DEBUG - Timeouts: user 9999999989.996195, metadata 60015.746826, idle connection 300014.000000, request inf
2025-04-13 15:44:44,737 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:44:44,739 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:44:44,740 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 90 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:44:44,740 - DEBUG - Timeouts: user 9999999985.722065, metadata 30000.000000, idle connection 239993.000000, request 29999.911070
2025-04-13 15:44:44,741 - DEBUG - Timeouts: user 9999999989.996910, metadata 30000.000000, idle connection 239992.000000, request 29999.274969
2025-04-13 15:44:44,752 - DEBUG - Received correlation id: 90
2025-04-13 15:44:44,752 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:44:44,752 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 90 (11.918067932128906 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:44:44,753 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:44:44,753 - DEBUG - Timeouts: user 9999999989.993811, metadata 299999.675049, idle connection 239980.000000, request inf
2025-04-13 15:48:44,733 - DEBUG - Timeouts: user 9999999989.938974, metadata 60019.686035, idle connection 0.000000, request inf
2025-04-13 15:48:44,737 - DEBUG - Timeouts: user 9999999989.995003, metadata 60015.224854, idle connection 300014.000000, request inf
2025-04-13 15:49:44,758 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:49:44,761 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:49:44,761 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 91 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:49:44,761 - DEBUG - Timeouts: user 9999999985.712051, metadata 30000.000000, idle connection 239990.000000, request 29999.939203
2025-04-13 15:49:44,762 - DEBUG - Timeouts: user 9999999989.996910, metadata 30000.000000, idle connection 239989.000000, request 29999.430895
2025-04-13 15:49:44,765 - DEBUG - Received correlation id: 91
2025-04-13 15:49:44,765 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:49:44,765 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 91 (4.141092300415039 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:49:44,766 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:49:44,767 - DEBUG - Timeouts: user 9999999989.991903, metadata 299999.760742, idle connection 239985.000000, request inf
2025-04-13 15:53:44,752 - DEBUG - Timeouts: user 9999999989.925385, metadata 60015.068848, idle connection 0.000000, request inf
2025-04-13 15:53:44,755 - DEBUG - Timeouts: user 9999999989.993811, metadata 60011.039062, idle connection 300009.000000, request inf
2025-04-13 15:54:44,767 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:54:44,769 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:54:44,769 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 92 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:54:44,769 - DEBUG - Timeouts: user 9999999987.974167, metadata 30000.000000, idle connection 239995.000000, request 29999.963760
2025-04-13 15:54:44,769 - DEBUG - Timeouts: user 9999999989.996910, metadata 30000.000000, idle connection 239995.000000, request 29999.577761
2025-04-13 15:54:44,779 - DEBUG - Received correlation id: 92
2025-04-13 15:54:44,779 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:54:44,779 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 92 (10.09511947631836 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:54:44,780 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:54:44,780 - DEBUG - Timeouts: user 9999999989.994764, metadata 299999.726807, idle connection 239984.000000, request inf
2025-04-13 15:58:44,803 - DEBUG - Timeouts: user 9999999989.931822, metadata 59976.557861, idle connection 299975.000000, request inf
2025-04-13 15:59:44,786 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 15:59:44,789 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:59:44,789 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 93 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 15:59:44,790 - DEBUG - Timeouts: user 9999999985.963106, metadata 30000.000000, idle connection 239989.000000, request 29999.938250
2025-04-13 15:59:44,791 - DEBUG - Timeouts: user 9999999989.994764, metadata 30000.000000, idle connection 239987.000000, request 29998.860121
2025-04-13 15:59:44,793 - DEBUG - Received correlation id: 93
2025-04-13 15:59:44,793 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 15:59:44,794 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 93 (4.030942916870117 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 15:59:44,794 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 15:59:44,794 - DEBUG - Timeouts: user 9999999989.989996, metadata 299999.842041, idle connection 239984.000000, request inf
2025-04-13 16:03:44,780 - DEBUG - Timeouts: user 9999999989.974022, metadata 60014.518066, idle connection 300013.000000, request inf
2025-04-13 16:04:44,799 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:04:44,801 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:04:44,802 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 94 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:04:44,802 - DEBUG - Timeouts: user 9999999985.846758, metadata 30000.000000, idle connection 239990.000000, request 29999.848843
2025-04-13 16:04:44,803 - DEBUG - Timeouts: user 9999999989.994287, metadata 30000.000000, idle connection 239989.000000, request 29998.978853
2025-04-13 16:04:44,811 - DEBUG - Received correlation id: 94
2025-04-13 16:04:44,811 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:04:44,811 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 94 (8.759021759033203 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:04:44,812 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:04:44,812 - DEBUG - Timeouts: user 9999999989.995003, metadata 299999.888916, idle connection 239981.000000, request inf
2025-04-13 16:08:44,795 - DEBUG - Timeouts: user 9999999989.917994, metadata 60016.891846, idle connection 300012.000000, request inf
2025-04-13 16:09:44,815 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:09:44,816 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:09:44,817 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 95 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:09:44,817 - DEBUG - Timeouts: user 9999999987.715006, metadata 30000.000000, idle connection 239990.000000, request 29999.950886
2025-04-13 16:09:44,818 - DEBUG - Timeouts: user 9999999989.993095, metadata 30000.000000, idle connection 239989.000000, request 29999.111891
2025-04-13 16:09:44,832 - DEBUG - Received correlation id: 95
2025-04-13 16:09:44,832 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:09:44,833 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 95 (15.45095443725586 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:09:44,833 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:09:44,833 - DEBUG - Timeouts: user 9999999989.994049, metadata 299999.889160, idle connection 239974.000000, request inf
2025-04-13 16:13:44,814 - DEBUG - Timeouts: user 9999999989.938021, metadata 60019.149902, idle connection 300018.000000, request inf
2025-04-13 16:14:44,838 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:14:44,840 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:14:44,841 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 96 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:14:44,841 - DEBUG - Timeouts: user 9999999985.761881, metadata 30000.000000, idle connection 239990.000000, request 29999.907017
2025-04-13 16:14:44,843 - DEBUG - Timeouts: user 9999999989.993095, metadata 30000.000000, idle connection 239989.000000, request 29998.428106
2025-04-13 16:14:44,848 - DEBUG - Received correlation id: 96
2025-04-13 16:14:44,848 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:14:44,849 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 96 (7.230997085571289 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:14:44,850 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:14:44,850 - DEBUG - Timeouts: user 9999999989.992857, metadata 299999.466064, idle connection 239982.000000, request inf
2025-04-13 16:18:44,834 - DEBUG - Timeouts: user 9999999989.954948, metadata 60015.461914, idle connection 300013.000000, request inf
2025-04-13 16:19:44,857 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:19:44,861 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:19:44,861 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 97 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:19:44,861 - DEBUG - Timeouts: user 9999999984.348059, metadata 30000.000000, idle connection 239985.000000, request 29999.854088
2025-04-13 16:19:44,862 - DEBUG - Timeouts: user 9999999989.993095, metadata 30000.000000, idle connection 239984.000000, request 29998.881102
2025-04-13 16:19:44,879 - DEBUG - Received correlation id: 97
2025-04-13 16:19:44,879 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:19:44,879 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 97 (17.653942108154297 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:19:44,879 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:19:44,880 - DEBUG - Timeouts: user 9999999989.994049, metadata 299999.878906, idle connection 239967.000000, request inf
2025-04-13 16:23:44,849 - DEBUG - Timeouts: user 9999999989.953041, metadata 60030.565674, idle connection 300029.000000, request inf
2025-04-13 16:24:44,885 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:24:44,888 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:24:44,889 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 98 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:24:44,889 - DEBUG - Timeouts: user 9999999985.182047, metadata 30000.000000, idle connection 239989.000000, request 29999.949217
2025-04-13 16:24:44,889 - DEBUG - Timeouts: user 9999999989.997387, metadata 30000.000000, idle connection 239989.000000, request 29999.589205
2025-04-13 16:24:44,891 - DEBUG - Received correlation id: 98
2025-04-13 16:24:44,891 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:24:44,892 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 98 (2.736806869506836 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:24:44,892 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:24:44,894 - DEBUG - Timeouts: user 9999999989.992142, metadata 299998.491455, idle connection 239984.000000, request inf
2025-04-13 16:28:44,881 - DEBUG - Timeouts: user 9999999989.898205, metadata 60011.463867, idle connection 300009.000000, request inf
2025-04-13 16:29:44,899 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:29:44,902 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:29:44,903 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 99 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:29:44,903 - DEBUG - Timeouts: user 9999999985.161066, metadata 30000.000000, idle connection 239988.000000, request 29999.945879
2025-04-13 16:29:44,903 - DEBUG - Timeouts: user 9999999989.997149, metadata 30000.000000, idle connection 239987.000000, request 29999.597073
2025-04-13 16:29:44,913 - DEBUG - Received correlation id: 99
2025-04-13 16:29:44,913 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:29:44,913 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 99 (10.485172271728516 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:29:44,914 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:29:44,914 - DEBUG - Timeouts: user 9999999989.995003, metadata 299999.878906, idle connection 239976.000000, request inf
2025-04-13 16:33:44,892 - DEBUG - Timeouts: user 9999999989.959955, metadata 60022.041260, idle connection 300020.000000, request inf
2025-04-13 16:34:44,918 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:34:44,919 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:34:44,919 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 100 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:34:44,919 - DEBUG - Timeouts: user 9999999988.582134, metadata 30000.000000, idle connection 239993.000000, request 29999.971151
2025-04-13 16:34:44,919 - DEBUG - Timeouts: user 9999999989.995956, metadata 30000.000000, idle connection 239993.000000, request 29999.552011
2025-04-13 16:34:44,922 - DEBUG - Received correlation id: 100
2025-04-13 16:34:44,922 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:34:44,922 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 100 (3.328561782836914 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:34:44,923 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:34:44,923 - DEBUG - Timeouts: user 9999999989.990950, metadata 299999.655029, idle connection 239989.000000, request inf
2025-04-13 16:38:44,916 - DEBUG - Timeouts: user 9999999989.982128, metadata 60006.791992, idle connection 300005.000000, request inf
2025-04-13 16:39:44,926 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:39:44,927 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:39:44,928 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 101 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:39:44,928 - DEBUG - Timeouts: user 9999999988.252163, metadata 30000.000000, idle connection 239993.000000, request 29999.958038
2025-04-13 16:39:44,928 - DEBUG - Timeouts: user 9999999989.994049, metadata 30000.000000, idle connection 239993.000000, request 29999.386072
2025-04-13 16:39:44,933 - DEBUG - Received correlation id: 101
2025-04-13 16:39:44,933 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:39:44,933 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 101 (5.227804183959961 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:39:44,934 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:39:44,934 - DEBUG - Timeouts: user 9999999989.992857, metadata 299999.854004, idle connection 239988.000000, request inf
2025-04-13 16:43:44,923 - DEBUG - Timeouts: user 9999999989.977837, metadata 60010.971924, idle connection 300008.000000, request inf
2025-04-13 16:44:44,937 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:44:44,938 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:44:44,938 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 102 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:44:44,938 - DEBUG - Timeouts: user 9999999987.594843, metadata 30000.000000, idle connection 239993.000000, request 29999.942064
2025-04-13 16:44:44,939 - DEBUG - Timeouts: user 9999999989.994049, metadata 30000.000000, idle connection 239992.000000, request 29999.285936
2025-04-13 16:44:44,943 - DEBUG - Received correlation id: 102
2025-04-13 16:44:44,944 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:44:44,944 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 102 (5.896091461181641 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:44:44,947 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:44:44,948 - DEBUG - Timeouts: user 9999999989.995956, metadata 299997.945068, idle connection 239983.000000, request inf
2025-04-13 16:48:44,934 - DEBUG - Timeouts: user 9999999989.933968, metadata 60012.190430, idle connection 300009.000000, request inf
2025-04-13 16:49:44,954 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:49:44,956 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:49:44,956 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 103 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:49:44,957 - DEBUG - Timeouts: user 9999999983.587980, metadata 30000.000000, idle connection 239985.000000, request 29999.930143
2025-04-13 16:49:44,958 - DEBUG - Timeouts: user 9999999989.992619, metadata 30000.000000, idle connection 239984.000000, request 29999.212027
2025-04-13 16:49:44,961 - DEBUG - Received correlation id: 103
2025-04-13 16:49:44,961 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:49:44,961 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 103 (4.146814346313477 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:49:44,962 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:49:44,962 - DEBUG - Timeouts: user 9999999989.997864, metadata 299999.902832, idle connection 239981.000000, request inf
2025-04-13 16:53:44,946 - DEBUG - Timeouts: user 9999999989.904881, metadata 60016.356934, idle connection 300015.000000, request inf
2025-04-13 16:54:44,967 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:54:44,968 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:54:44,969 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 104 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:54:44,970 - DEBUG - Timeouts: user 9999999987.205029, metadata 30000.000000, idle connection 239991.000000, request 29999.929190
2025-04-13 16:54:44,971 - DEBUG - Timeouts: user 9999999989.990950, metadata 30000.000000, idle connection 239989.000000, request 29998.656988
2025-04-13 16:54:44,979 - DEBUG - Received correlation id: 104
2025-04-13 16:54:44,979 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:54:44,979 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 104 (9.368896484375 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:54:44,979 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:54:44,979 - DEBUG - Timeouts: user 9999999989.996195, metadata 299999.920166, idle connection 239981.000000, request inf
2025-04-13 16:58:44,962 - DEBUG - Timeouts: user 9999999989.984274, metadata 60017.858154, idle connection 300016.000000, request inf
2025-04-13 16:59:44,982 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 16:59:44,982 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:59:44,982 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 105 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 16:59:44,982 - DEBUG - Timeouts: user 9999999989.235163, metadata 30000.000000, idle connection 239996.000000, request 29999.986172
2025-04-13 16:59:44,982 - DEBUG - Timeouts: user 9999999989.996910, metadata 30000.000000, idle connection 239995.000000, request 29999.783039
2025-04-13 16:59:44,988 - DEBUG - Received correlation id: 105
2025-04-13 16:59:44,988 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 16:59:44,989 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 105 (6.331920623779297 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 16:59:44,989 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 16:59:44,989 - DEBUG - Timeouts: user 9999999989.995003, metadata 299999.771973, idle connection 239988.000000, request inf
2025-04-13 17:03:44,979 - DEBUG - Timeouts: user 9999999989.976883, metadata 60010.566895, idle connection 300009.000000, request inf
2025-04-13 17:04:44,996 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:04:44,997 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:04:44,999 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 106 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:04:45,000 - DEBUG - Timeouts: user 9999999986.779690, metadata 30000.000000, idle connection 239988.000000, request 29999.969959
2025-04-13 17:04:45,001 - DEBUG - Timeouts: user 9999999989.992142, metadata 30000.000000, idle connection 239987.000000, request 29998.677969
2025-04-13 17:04:45,003 - DEBUG - Received correlation id: 106
2025-04-13 17:04:45,003 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:04:45,003 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 106 (3.325939178466797 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:04:45,003 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:04:45,003 - DEBUG - Timeouts: user 9999999989.994764, metadata 299999.904785, idle connection 239985.000000, request inf
2025-04-13 17:08:44,973 - DEBUG - Timeouts: user 9999999989.914179, metadata 60030.754883, idle connection 15.000000, request inf
2025-04-13 17:08:44,993 - DEBUG - Timeouts: user 9999999989.993095, metadata 60010.560791, idle connection 300009.000000, request inf
2025-04-13 17:09:45,005 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:09:45,011 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:09:45,012 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 107 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:09:45,012 - DEBUG - Timeouts: user 9999999981.855869, metadata 30000.000000, idle connection 239990.000000, request 29999.900103
2025-04-13 17:09:45,013 - DEBUG - Timeouts: user 9999999989.996195, metadata 30000.000000, idle connection 239989.000000, request 29999.386072
2025-04-13 17:09:45,019 - DEBUG - Received correlation id: 107
2025-04-13 17:09:45,019 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:09:45,020 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 107 (7.284879684448242 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:09:45,021 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:09:45,021 - DEBUG - Timeouts: user 9999999989.991665, metadata 299999.768799, idle connection 239981.000000, request inf
2025-04-13 17:13:45,002 - DEBUG - Timeouts: user 9999999989.976883, metadata 60018.540039, idle connection 0.000000, request inf
2025-04-13 17:13:45,005 - DEBUG - Timeouts: user 9999999989.996195, metadata 60015.754883, idle connection 300013.000000, request inf
2025-04-13 17:14:45,022 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:14:45,023 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:14:45,023 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 108 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:14:45,023 - DEBUG - Timeouts: user 9999999989.086151, metadata 30000.000000, idle connection 239995.000000, request 29999.976158
2025-04-13 17:14:45,024 - DEBUG - Timeouts: user 9999999989.995003, metadata 30000.000000, idle connection 239995.000000, request 29999.499083
2025-04-13 17:14:45,025 - DEBUG - Received correlation id: 108
2025-04-13 17:14:45,025 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:14:45,025 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 108 (2.2630691528320312 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:14:45,026 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:14:45,026 - DEBUG - Timeouts: user 9999999989.995003, metadata 299999.882080, idle connection 239992.000000, request inf
2025-04-13 17:18:45,018 - DEBUG - Timeouts: user 9999999989.994287, metadata 60008.017090, idle connection 0.000000, request inf
2025-04-13 17:18:45,019 - DEBUG - Timeouts: user 9999999989.996910, metadata 60006.849121, idle connection 300005.000000, request inf
2025-04-13 17:19:45,029 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:19:45,032 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:19:45,032 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 109 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:19:45,033 - DEBUG - Timeouts: user 9999999985.118866, metadata 30000.000000, idle connection 239992.000000, request 29999.933958
2025-04-13 17:19:45,033 - DEBUG - Timeouts: user 9999999989.995003, metadata 30000.000000, idle connection 239991.000000, request 29999.163866
2025-04-13 17:19:45,039 - DEBUG - Received correlation id: 109
2025-04-13 17:19:45,040 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:19:45,040 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 109 (7.160186767578125 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:19:45,040 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:19:45,040 - DEBUG - Timeouts: user 9999999989.995956, metadata 299999.890137, idle connection 239984.000000, request inf
2025-04-13 17:23:45,025 - DEBUG - Timeouts: user 9999999989.969015, metadata 60015.502930, idle connection 0.000000, request inf
2025-04-13 17:23:45,027 - DEBUG - Timeouts: user 9999999989.995003, metadata 60012.781738, idle connection 300011.000000, request inf
2025-04-13 17:24:45,043 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:24:45,044 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:24:45,044 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 110 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:24:45,044 - DEBUG - Timeouts: user 9999999988.903999, metadata 30000.000000, idle connection 239994.000000, request 29999.928951
2025-04-13 17:24:45,045 - DEBUG - Timeouts: user 9999999989.992857, metadata 30000.000000, idle connection 239993.000000, request 29999.149084
2025-04-13 17:24:45,046 - DEBUG - Received correlation id: 110
2025-04-13 17:24:45,046 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:24:45,047 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 110 (2.2430419921875 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:24:45,047 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:24:45,047 - DEBUG - Timeouts: user 9999999989.975929, metadata 299999.805908, idle connection 239991.000000, request inf
2025-04-13 17:28:45,041 - DEBUG - Timeouts: user 9999999989.980936, metadata 60006.143066, idle connection 300005.000000, request inf
2025-04-13 17:29:45,049 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:29:45,051 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:29:45,051 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 111 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:29:45,051 - DEBUG - Timeouts: user 9999999987.404108, metadata 30000.000000, idle connection 239994.000000, request 29999.870062
2025-04-13 17:29:45,052 - DEBUG - Timeouts: user 9999999989.994287, metadata 30000.000000, idle connection 239993.000000, request 29999.087095
2025-04-13 17:29:45,066 - DEBUG - Received correlation id: 111
2025-04-13 17:29:45,066 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:29:45,066 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 111 (15.126943588256836 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:29:45,067 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:29:45,067 - DEBUG - Timeouts: user 9999999989.993095, metadata 299999.880127, idle connection 239979.000000, request inf
2025-04-13 17:33:45,046 - DEBUG - Timeouts: user 9999999989.979982, metadata 60020.548340, idle connection 0.000000, request inf
2025-04-13 17:33:45,052 - DEBUG - Timeouts: user 9999999989.954948, metadata 60014.745117, idle connection 300013.000000, request inf
2025-04-13 17:34:45,069 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:34:45,070 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:34:45,070 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 112 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:34:45,070 - DEBUG - Timeouts: user 9999999988.600016, metadata 30000.000000, idle connection 239995.000000, request 29999.972105
2025-04-13 17:34:45,071 - DEBUG - Timeouts: user 9999999989.993811, metadata 30000.000000, idle connection 239994.000000, request 29999.524117
2025-04-13 17:34:45,072 - DEBUG - Received correlation id: 112
2025-04-13 17:34:45,072 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:34:45,073 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 112 (2.079010009765625 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:34:45,073 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:34:45,073 - DEBUG - Timeouts: user 9999999989.993095, metadata 299999.661377, idle connection 239992.000000, request inf
2025-04-13 17:38:45,065 - DEBUG - Timeouts: user 9999999989.990950, metadata 60008.056396, idle connection 0.000000, request inf
2025-04-13 17:38:45,067 - DEBUG - Timeouts: user 9999999989.995956, metadata 60006.533203, idle connection 300005.000000, request inf
2025-04-13 17:39:45,075 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:39:45,076 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:39:45,077 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 113 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:39:45,077 - DEBUG - Timeouts: user 9999999988.132954, metadata 30000.000000, idle connection 239994.000000, request 29999.958038
2025-04-13 17:39:45,078 - DEBUG - Timeouts: user 9999999989.994764, metadata 30000.000000, idle connection 239994.000000, request 29999.418020
2025-04-13 17:39:45,080 - DEBUG - Received correlation id: 113
2025-04-13 17:39:45,081 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:39:45,081 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 113 (3.843069076538086 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:39:45,081 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:39:45,081 - DEBUG - Timeouts: user 9999999989.995003, metadata 299999.868896, idle connection 239990.000000, request inf
2025-04-13 17:43:45,142 - DEBUG - Timeouts: user 9999999989.960194, metadata 59943.154785, idle connection 299938.000000, request inf
2025-04-13 17:44:45,090 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:44:45,090 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:44:45,090 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 114 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:44:45,091 - DEBUG - Timeouts: user 9999999989.066124, metadata 30000.000000, idle connection 239989.000000, request 29999.977827
2025-04-13 17:44:45,091 - DEBUG - Timeouts: user 9999999989.996195, metadata 30000.000000, idle connection 239989.000000, request 29999.650002
2025-04-13 17:44:45,093 - DEBUG - Received correlation id: 114
2025-04-13 17:44:45,093 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:44:45,093 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 114 (2.8638839721679688 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:44:45,094 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:44:45,094 - DEBUG - Timeouts: user 9999999989.993811, metadata 299999.857422, idle connection 239986.000000, request inf
2025-04-13 17:48:45,086 - DEBUG - Timeouts: user 9999999989.977121, metadata 60008.010498, idle connection 300006.000000, request inf
2025-04-13 17:49:45,104 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:49:45,105 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:49:45,106 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 115 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:49:45,106 - DEBUG - Timeouts: user 9999999987.992287, metadata 30000.000000, idle connection 239986.000000, request 29999.953747
2025-04-13 17:49:45,107 - DEBUG - Timeouts: user 9999999989.993095, metadata 30000.000000, idle connection 239986.000000, request 29999.228001
2025-04-13 17:49:45,116 - DEBUG - Received correlation id: 115
2025-04-13 17:49:45,116 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:49:45,116 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 115 (10.595083236694336 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:49:45,117 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:49:45,117 - DEBUG - Timeouts: user 9999999989.989996, metadata 299999.785156, idle connection 239975.000000, request inf
2025-04-13 17:53:45,099 - DEBUG - Timeouts: user 9999999989.879847, metadata 60018.242920, idle connection 300016.000000, request inf
2025-04-13 17:54:45,120 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:54:45,121 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:54:45,121 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 116 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:54:45,121 - DEBUG - Timeouts: user 9999999988.721848, metadata 30000.000000, idle connection 239994.000000, request 29999.965191
2025-04-13 17:54:45,122 - DEBUG - Timeouts: user 9999999989.994287, metadata 30000.000000, idle connection 239993.000000, request 29999.274969
2025-04-13 17:54:45,123 - DEBUG - Received correlation id: 116
2025-04-13 17:54:45,123 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:54:45,123 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 116 (1.9447803497314453 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:54:45,124 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:54:45,124 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.815918, idle connection 239991.000000, request inf
2025-04-13 17:58:45,119 - DEBUG - Timeouts: user 9999999989.990950, metadata 60005.232178, idle connection 300004.000000, request inf
2025-04-13 17:59:45,127 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 17:59:45,128 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:59:45,128 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 117 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 17:59:45,128 - DEBUG - Timeouts: user 9999999987.976074, metadata 30000.000000, idle connection 239994.000000, request 29999.962807
2025-04-13 17:59:45,132 - DEBUG - Timeouts: user 9999999989.993095, metadata 30000.000000, idle connection 239990.000000, request 29996.374846
2025-04-13 17:59:45,138 - DEBUG - Received correlation id: 117
2025-04-13 17:59:45,138 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 17:59:45,139 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 117 (10.471343994140625 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 17:59:45,140 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 17:59:45,140 - DEBUG - Timeouts: user 9999999989.993095, metadata 299999.877197, idle connection 239982.000000, request inf
2025-04-13 18:03:45,128 - DEBUG - Timeouts: user 9999999989.968061, metadata 60011.911133, idle connection 300009.000000, request inf
2025-04-13 18:04:45,149 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 18:04:45,150 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:04:45,150 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 118 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:04:45,150 - DEBUG - Timeouts: user 9999999988.538027, metadata 30000.000000, idle connection 239986.000000, request 29999.713182
2025-04-13 18:04:45,151 - DEBUG - Timeouts: user 9999999989.991903, metadata 30000.000000, idle connection 239986.000000, request 29999.114275
2025-04-13 18:04:45,152 - DEBUG - Received correlation id: 118
2025-04-13 18:04:45,152 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 18:04:45,152 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 118 (2.1638870239257812 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 18:04:45,153 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 18:04:45,153 - DEBUG - Timeouts: user 9999999989.994049, metadata 299999.716064, idle connection 239984.000000, request inf
2025-04-13 18:08:45,145 - DEBUG - Timeouts: user 9999999989.923954, metadata 60007.873047, idle connection 300006.000000, request inf
2025-04-13 18:09:45,159 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 18:09:45,161 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:09:45,161 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 119 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:09:45,161 - DEBUG - Timeouts: user 9999999987.648964, metadata 30000.000000, idle connection 239990.000000, request 29999.963999
2025-04-13 18:09:45,162 - DEBUG - Timeouts: user 9999999989.995241, metadata 30000.000000, idle connection 239990.000000, request 29999.569893
2025-04-13 18:09:45,169 - DEBUG - Received correlation id: 119
2025-04-13 18:09:45,170 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 18:09:45,170 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 119 (8.63790512084961 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 18:09:45,170 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 18:09:45,171 - DEBUG - Timeouts: user 9999999989.992857, metadata 299999.843018, idle connection 239981.000000, request inf
2025-04-13 18:13:45,156 - DEBUG - Timeouts: user 9999999989.992142, metadata 60014.837158, idle connection 300013.000000, request inf
2025-04-13 18:14:45,176 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 18:14:45,178 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:14:45,178 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 120 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:14:45,178 - DEBUG - Timeouts: user 9999999987.270117, metadata 30000.000000, idle connection 239991.000000, request 29999.957085
2025-04-13 18:14:45,179 - DEBUG - Timeouts: user 9999999989.996910, metadata 30000.000000, idle connection 239990.000000, request 29999.618053
2025-04-13 18:14:45,183 - DEBUG - Received correlation id: 120
2025-04-13 18:14:45,183 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 18:14:45,183 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 120 (4.830837249755859 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 18:14:45,186 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 18:14:45,187 - DEBUG - Timeouts: user 9999999989.995956, metadata 299999.627930, idle connection 239982.000000, request inf
2025-04-13 18:18:45,150 - DEBUG - Timeouts: user 9999999989.936113, metadata 60036.238037, idle connection 19.000000, request inf
2025-04-13 18:18:45,172 - DEBUG - Timeouts: user 9999999989.992142, metadata 60014.263916, idle connection 300010.000000, request inf
2025-04-13 18:19:45,188 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 18:19:45,190 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:19:45,190 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 121 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:19:45,191 - DEBUG - Timeouts: user 9999999987.033844, metadata 30000.000000, idle connection 239991.000000, request 29999.944925
2025-04-13 18:19:45,191 - DEBUG - Timeouts: user 9999999989.996195, metadata 30000.000000, idle connection 239991.000000, request 29999.419928
2025-04-13 18:19:45,198 - DEBUG - Received correlation id: 121
2025-04-13 18:19:45,198 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 18:19:45,199 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 121 (8.130073547363281 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 18:19:45,199 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 18:19:45,199 - DEBUG - Timeouts: user 9999999989.996910, metadata 299999.912842, idle connection 239983.000000, request inf
2025-04-13 18:23:45,187 - DEBUG - Timeouts: user 9999999989.926100, metadata 60012.786865, idle connection 300011.000000, request inf
2025-04-13 18:24:45,206 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 18:24:45,208 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:24:45,209 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 122 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:24:45,209 - DEBUG - Timeouts: user 9999999985.846043, metadata 30000.000000, idle connection 239988.000000, request 29999.961853
2025-04-13 18:24:45,210 - DEBUG - Timeouts: user 9999999989.997149, metadata 30000.000000, idle connection 239988.000000, request 29999.505758
2025-04-13 18:24:45,213 - DEBUG - Received correlation id: 122
2025-04-13 18:24:45,213 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 18:24:45,214 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 122 (4.444122314453125 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 18:24:45,214 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 18:24:45,214 - DEBUG - Timeouts: user 9999999989.997864, metadata 299999.873047, idle connection 239983.000000, request inf
2025-04-13 18:28:45,201 - DEBUG - Timeouts: user 9999999989.934921, metadata 60012.957031, idle connection 300012.000000, request inf
2025-04-13 18:29:45,223 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 18:29:45,224 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:29:45,225 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 123 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:29:45,225 - DEBUG - Timeouts: user 9999999987.151146, metadata 30000.000000, idle connection 239987.000000, request 29999.967098
2025-04-13 18:29:45,226 - DEBUG - Timeouts: user 9999999989.995956, metadata 30000.000000, idle connection 239986.000000, request 29998.796701
2025-04-13 18:29:45,256 - DEBUG - Received correlation id: 123
2025-04-13 18:29:45,256 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 18:29:45,260 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 123 (34.800052642822266 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 18:29:45,261 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 18:29:45,261 - DEBUG - Timeouts: user 9999999989.994287, metadata 299999.880615, idle connection 239952.000000, request inf
2025-04-13 18:33:45,219 - DEBUG - Timeouts: user 9999999989.955902, metadata 60042.321777, idle connection 300036.000000, request inf
2025-04-13 18:34:45,267 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 18:34:45,269 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:34:45,269 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 124 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:34:45,269 - DEBUG - Timeouts: user 9999999987.552881, metadata 30000.000000, idle connection 239986.000000, request 29999.961853
2025-04-13 18:34:45,269 - DEBUG - Timeouts: user 9999999989.998102, metadata 30000.000000, idle connection 239985.000000, request 29999.625921
2025-04-13 18:34:45,275 - DEBUG - Received correlation id: 124
2025-04-13 18:34:45,275 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 18:34:45,275 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 124 (5.925178527832031 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 18:34:45,276 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 18:34:45,276 - DEBUG - Timeouts: user 9999999989.997149, metadata 299999.900146, idle connection 239979.000000, request inf
2025-04-13 18:38:45,260 - DEBUG - Timeouts: user 9999999989.953995, metadata 60016.049072, idle connection 300014.000000, request inf
2025-04-13 18:39:45,284 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 18:39:45,287 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:39:45,288 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 125 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:39:45,288 - DEBUG - Timeouts: user 9999999984.911203, metadata 30000.000000, idle connection 239986.000000, request 29999.964952
2025-04-13 18:39:45,288 - DEBUG - Timeouts: user 9999999989.997149, metadata 30000.000000, idle connection 239986.000000, request 29999.614954
2025-04-13 18:39:45,296 - DEBUG - Received correlation id: 125
2025-04-13 18:39:45,296 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 18:39:45,296 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 125 (8.357048034667969 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 18:39:45,297 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 18:39:45,297 - DEBUG - Timeouts: user 9999999989.997149, metadata 299999.895996, idle connection 239977.000000, request inf
2025-04-13 18:43:45,287 - DEBUG - Timeouts: user 9999999989.930868, metadata 60010.378662, idle connection 300008.000000, request inf
2025-04-13 18:44:45,304 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 18:44:45,307 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:44:45,307 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 126 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:44:45,307 - DEBUG - Timeouts: user 9999999986.110926, metadata 30000.000000, idle connection 239987.000000, request 29999.968052
2025-04-13 18:44:45,308 - DEBUG - Timeouts: user 9999999989.998102, metadata 30000.000000, idle connection 239987.000000, request 29999.611855
2025-04-13 18:44:45,328 - DEBUG - Received correlation id: 126
2025-04-13 18:44:45,329 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 18:44:45,330 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 126 (22.52507209777832 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 18:44:45,333 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 18:44:45,334 - DEBUG - Timeouts: user 9999999989.995241, metadata 299999.250000, idle connection 239961.000000, request inf
2025-04-13 18:48:45,301 - DEBUG - Timeouts: user 9999999989.710808, metadata 60032.424072, idle connection 300026.000000, request inf
2025-04-13 18:49:45,352 - DEBUG - Sending metadata request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True) to node 1
2025-04-13 18:49:45,366 - DEBUG - Sending request MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:49:45,367 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Request 127 (timeout_ms 30000): MetadataRequest_v7(topics=['user_interactions', 'metrics_topic'], allow_auto_topic_creation=True)
2025-04-13 18:49:45,367 - DEBUG - Timeouts: user 9999999964.476109, metadata 30000.000000, idle connection 239960.000000, request 29999.964952
2025-04-13 18:49:45,368 - DEBUG - Timeouts: user 9999999989.996910, metadata 30000.000000, idle connection 239959.000000, request 29999.117851
2025-04-13 18:49:45,413 - DEBUG - Received correlation id: 127
2025-04-13 18:49:45,416 - DEBUG - Processing response MetadataResponse_v7
2025-04-13 18:49:45,419 - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Response 127 (51.45430564880371 ms): MetadataResponse_v7(throttle_time_ms=0, brokers=[(node_id=1, host='localhost', port=9092, rack=None)], cluster_id='NyOswnS-SRy7kOP3zdNzNg', controller_id=1, topics=[(error_code=0, topic='user_interactions', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])]), (error_code=0, topic='metrics_topic', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, leader_epoch=0, replicas=[1], isr=[1], offline_replicas=[])])])
2025-04-13 18:49:45,420 - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 2, groups: 0)
2025-04-13 18:49:45,420 - DEBUG - Timeouts: user 9999999989.994049, metadata 299999.461182, idle connection 239906.000000, request inf
