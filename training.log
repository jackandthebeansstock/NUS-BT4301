2025-04-02 19:09:16,624 - INFO - Using device: cpu
2025-04-02 19:09:16,704 - INFO - Kafka producer initialized successfully
2025-04-02 19:09:16,704 - INFO - Script started
2025-04-02 19:09:16,704 - INFO - Starting main function
2025-04-02 19:09:16,704 - INFO - Initializing KindleDataset
2025-04-02 19:09:27,409 - INFO - Loaded customer_df: (10000, 11), product_df: (50000, 11)
2025-04-02 19:09:31,262 - INFO - Dataset initialized: 9562 books, 68 categories, mode=train
2025-04-02 19:09:31,263 - INFO - Initializing KindleDataset
2025-04-02 19:09:41,194 - INFO - Loaded customer_df: (10000, 11), product_df: (50000, 11)
2025-04-02 19:09:45,068 - INFO - Dataset initialized: 9562 books, 68 categories, mode=eval
2025-04-02 19:09:45,068 - INFO - Datasets loaded
2025-04-02 19:09:45,068 - INFO - Starting train_model with device cpu
2025-04-02 19:09:45,069 - INFO - Initializing BERT4Rec model
2025-04-02 19:09:45,092 - INFO - DataLoader created with 28 batches
2025-04-02 19:09:45,907 - INFO - MLflow tracking URI set
2025-04-02 19:09:46,339 - INFO - MLflow run started with ID: 88b2d26869a843d6af1a708c36cf2266
2025-04-02 19:09:46,466 - INFO - Starting epoch 1
2025-04-02 19:09:48,481 - INFO - Batch 10/28 loss = 9.3173
2025-04-02 19:09:50,396 - INFO - Batch 20/28 loss = 9.3280
2025-04-02 19:09:51,761 - INFO - Epoch 1 completed, avg loss = 9.372134106499809
2025-04-02 19:09:51,761 - INFO - Starting epoch 2
2025-04-02 19:09:53,630 - INFO - Batch 10/28 loss = 9.3353
2025-04-02 19:09:55,505 - INFO - Batch 20/28 loss = 9.0856
2025-04-02 19:09:56,892 - INFO - Epoch 2 completed, avg loss = 9.320611579077584
2025-04-02 19:09:56,905 - INFO - Artifacts saved locally
2025-04-02 19:10:00,157 - INFO - Model and artifacts logged to MLflow
2025-04-02 19:10:00,158 - INFO - Saved run ID 88b2d26869a843d6af1a708c36cf2266 to latest_run_id.txt
2025-04-02 19:10:00,167 - INFO - Starting evaluation
2025-04-02 19:10:00,167 - INFO - Starting evaluation
2025-04-02 19:10:01,932 - INFO - Evaluation completed: Hit Rate=0.003125, NDCG=0.0016587598619450792
2025-04-02 19:10:01,932 - INFO - Starting prediction
2025-04-02 19:10:01,936 - INFO - Prediction completed: ['B001DA321K', 'B007967GVY', 'B005G7SUL8', 'B000FC2MAO', 'B009MQWA1K']
2025-04-02 19:10:01,970 - INFO - Sent sample interaction to Kafka: {'book_id': 'B00DVQ53OI', 'event_type': 'click', 'timestamp': '2025-04-02T19:10:01.937192'}
2025-04-02 19:10:01,971 - INFO - Script completed successfully
2025-04-02 19:10:01,971 - INFO - Script completed
